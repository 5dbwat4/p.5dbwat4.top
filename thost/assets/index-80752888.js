import{f as M}from"./flatten-30e3eebb.js";import{w as z,g as v}from"./light-3c431b54.js";import{o as y,a as c,c as V,g as j}from"./Scrollbar-5b7370f2.js";import{s as H,F as Z,C as U,v as $,b3 as J,i as P,J as x,T as X,aZ as A,a2 as _,az as G,_ as K}from"./index-c2ed52a5.js";import{u as Q}from"./use-false-until-truthy-96bf4c79.js";function W(e,t="default",n=void 0){const o=e[t];if(!o)return z("getFirstSlotVNode",`slot[${t}] is empty`),null;const i=M(o(n));return i.length===1?i[0]:(z("getFirstSlotVNode",`slot[${t}] should have exactly one child`),null)}const Y=v("n-modal-body"),ee=v("n-modal"),te=v("n-drawer-body"),ne=v("n-popover-body");function I(e,t,n="default"){const o=t[n];if(o===void 0)throw new Error(`[vueuc/${e}]: slot[${n}] is empty.`);return o()}function E(e,t=!0,n=[]){return e.forEach(o=>{if(o!==null){if(typeof o!="object"){(typeof o=="string"||typeof o=="number")&&n.push(H(String(o)));return}if(Array.isArray(o)){E(o,t,n);return}if(o.type===Z){if(o.children===null)return;Array.isArray(o.children)&&E(o.children,t,n)}else o.type!==U&&n.push(o)}}),n}function oe(e,t,n="default"){const o=t[n];if(o===void 0)throw new Error(`[vueuc/${e}]: slot[${n}] is empty.`);const i=E(o());if(i.length===1)return i[0];throw new Error(`[vueuc/${e}]: slot[${n}] should have exactly one child.`)}const u="@@coContext",re={mounted(e,{value:t,modifiers:n}){e[u]={handler:void 0},typeof t=="function"&&(e[u].handler=t,y("clickoutside",e,t,{capture:n.capture}))},updated(e,{value:t,modifiers:n}){const o=e[u];typeof t=="function"?o.handler?o.handler!==t&&(c("clickoutside",e,o.handler,{capture:n.capture}),o.handler=t,y("clickoutside",e,t,{capture:n.capture})):(e[u].handler=t,y("clickoutside",e,t,{capture:n.capture})):o.handler&&(c("clickoutside",e,o.handler,{capture:n.capture}),o.handler=void 0)},unmounted(e,{modifiers:t}){const{handler:n}=e[u];n&&c("clickoutside",e,n,{capture:t.capture}),e[u].handler=void 0}},se=re;function ie(e,t){console.error(`[vdirs/${e}]: ${t}`)}class le{constructor(){this.elementZIndex=new Map,this.nextZIndex=2e3}get elementCount(){return this.elementZIndex.size}ensureZIndex(t,n){const{elementZIndex:o}=this;if(n!==void 0){t.style.zIndex=`${n}`,o.delete(t);return}const{nextZIndex:i}=this;o.has(t)&&o.get(t)+1===this.nextZIndex||(t.style.zIndex=`${i}`,o.set(t,i),this.nextZIndex=i+1,this.squashState())}unregister(t,n){const{elementZIndex:o}=this;o.has(t)?o.delete(t):n===void 0&&ie("z-index-manager/unregister-element","Element not found when unregistering."),this.squashState()}squashState(){const{elementCount:t}=this;t||(this.nextZIndex=2e3),this.nextZIndex-t>2500&&this.rearrange()}rearrange(){const t=Array.from(this.elementZIndex.entries());t.sort((n,o)=>n[1]-o[1]),this.nextZIndex=2e3,t.forEach(n=>{const o=n[0],i=this.nextZIndex++;`${i}`!==o.style.zIndex&&(o.style.zIndex=`${i}`)})}}const S=new le,d="@@ziContext",ae={mounted(e,t){const{value:n={}}=t,{zIndex:o,enabled:i}=n;e[d]={enabled:!!i,initialized:!1},i&&(S.ensureZIndex(e,o),e[d].initialized=!0)},updated(e,t){const{value:n={}}=t,{zIndex:o,enabled:i}=n,l=e[d].enabled;i&&!l&&(S.ensureZIndex(e,o),e[d].initialized=!0),e[d].enabled=!!i},unmounted(e,t){if(!e[d].initialized)return;const{value:n={}}=t,{zIndex:o}=n;S.unregister(e,o)}},ue=ae;function N(e){return typeof e=="string"?document.querySelector(e):e()}const de=$({name:"LazyTeleport",props:{to:{type:[String,Object],default:void 0},disabled:Boolean,show:{type:Boolean,required:!0}},setup(e){return{showTeleport:Q(J(e,"show")),mergedTo:P(()=>{const{to:t}=e;return t??"body"})}},render(){return this.showTeleport?this.disabled?I("lazy-teleport",this.$slots):x(X,{disabled:this.disabled,to:this.mergedTo},I("lazy-teleport",this.$slots)):null}});function k(e){return e instanceof HTMLElement}function B(e){for(let t=0;t<e.childNodes.length;t++){const n=e.childNodes[t];if(k(n)&&(C(n)||B(n)))return!0}return!1}function L(e){for(let t=e.childNodes.length-1;t>=0;t--){const n=e.childNodes[t];if(k(n)&&(C(n)||L(n)))return!0}return!1}function C(e){if(!ce(e))return!1;try{e.focus({preventScroll:!0})}catch{}return document.activeElement===e}function ce(e){if(e.tabIndex>0||e.tabIndex===0&&e.getAttribute("tabIndex")!==null)return!0;if(e.getAttribute("disabled"))return!1;switch(e.nodeName){case"A":return!!e.href&&e.rel!=="ignore";case"INPUT":return e.type!=="hidden"&&e.type!=="file";case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}}let f=[];const fe=$({name:"FocusTrap",props:{disabled:Boolean,active:Boolean,autoFocus:{type:Boolean,default:!0},onEsc:Function,initialFocusTo:String,finalFocusTo:String,returnFocusOnDeactivated:{type:Boolean,default:!0}},setup(e){const t=V(),n=A(null),o=A(null);let i=!1,l=!1;const T=typeof document>"u"?null:document.activeElement;function h(){return f[f.length-1]===t}function b(s){var r;s.code==="Escape"&&h()&&((r=e.onEsc)===null||r===void 0||r.call(e,s))}_(()=>{G(()=>e.active,s=>{s?(q(),y("keydown",document,b)):(c("keydown",document,b),i&&w())},{immediate:!0})}),K(()=>{c("keydown",document,b),i&&w()});function F(s){if(!l&&h()){const r=g();if(r===null||r.contains(j(s)))return;a("first")}}function g(){const s=n.value;if(s===null)return null;let r=s;for(;r=r.nextSibling,!(r===null||r instanceof Element&&r.tagName==="DIV"););return r}function q(){var s;if(!e.disabled){if(f.push(t),e.autoFocus){const{initialFocusTo:r}=e;r===void 0?a("first"):(s=N(r))===null||s===void 0||s.focus({preventScroll:!0})}i=!0,document.addEventListener("focus",F,!0)}}function w(){var s;if(e.disabled||(document.removeEventListener("focus",F,!0),f=f.filter(p=>p!==t),h()))return;const{finalFocusTo:r}=e;r!==void 0?(s=N(r))===null||s===void 0||s.focus({preventScroll:!0}):e.returnFocusOnDeactivated&&T instanceof HTMLElement&&(l=!0,T.focus({preventScroll:!0}),l=!1)}function a(s){if(h()&&e.active){const r=n.value,p=o.value;if(r!==null&&p!==null){const m=g();if(m==null||m===p){l=!0,r.focus({preventScroll:!0}),l=!1;return}l=!0;const D=s==="first"?B(m):L(m);l=!1,D||(l=!0,r.focus({preventScroll:!0}),l=!1)}}}function R(s){if(l)return;const r=g();r!==null&&(s.relatedTarget!==null&&r.contains(s.relatedTarget)?a("last"):a("first"))}function O(s){l||(s.relatedTarget!==null&&s.relatedTarget===n.value?a("last"):a("first"))}return{focusableStartRef:n,focusableEndRef:o,focusableStyle:"position: absolute; height: 0; width: 0;",handleStartFocus:R,handleEndFocus:O}},render(){const{default:e}=this.$slots;if(e===void 0)return null;if(this.disabled)return e();const{active:t,focusableStyle:n}=this;return x(Z,null,[x("div",{"aria-hidden":"true",tabindex:t?"0":"-1",ref:"focusableStartRef",style:n,onFocus:this.handleStartFocus}),e(),x("div",{"aria-hidden":"true",style:n,ref:"focusableEndRef",tabindex:t?"0":"-1",onFocus:this.handleEndFocus})])}});export{fe as F,de as L,Y as a,I as b,se as c,te as d,oe as e,W as g,ee as m,ne as p,ue as z};
