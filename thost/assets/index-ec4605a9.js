import{A as k}from"./APIHelper-697d5a21.js";import{aZ as m,a8 as i,l as y,j as g,aE as u,t as s,b7 as n,s as o,k as _,m as v,F as N,ae as H,bd as C}from"./runtime-core.esm-bundler-42be6625.js";import{N as S}from"./Input-25fff9b3.js";import{b as p}from"./Button-cc4d8cf9.js";import{N as h}from"./Card-6456efb4.js";import"./light-061b806c.js";import"./format-length-c9d165c6.js";import"./Icon-9bae1ecc.js";import"./Warning-342b5d14.js";import"./Close-7ee9b945.js";import"./Scrollbar-56892bdd.js";import"./runtime-dom.esm-bundler-4c01a608.js";import"./keysOf-5d5107c5.js";import"./resolve-slot-612957d7.js";import"./use-locale-a958ab8c.js";import"./index-975a2d8f.js";import"./use-merged-state-cb002afc.js";import"./use-memo-8d560c6d.js";import"./light-a899ddec.js";import"./call-7e0089d6.js";import"./FadeInExpandTransition-8360c680.js";const I=["innerHTML"],V=["innerHTML"],$={key:0},j=["src"],O=["innerHTML"],R=v("div",null,null,-1),re={__name:"index",setup(D){const w=m(""),r=m(1),a=m([]),c=m(""),b=m({}),x=m({}),T=t=>{if(t.key=="Enter"){let l=window.getSelection().toString();a.value.push(l)}},A=()=>{r.value=2,document.addEventListener("keypress",T)},E=async()=>{r.value=31,a.value,a.value=a.value.map(t=>({met:t,list:[],tdp:{}}));for(let t=0;t<a.value.length;t++)await k.get("/api/xkw-helper/qsearch/"+c.value+"/"+a.value[t].met.slice(0,40)).then(l=>{a.value[t].list=l.data.list,a.value[t].index=0,a.value[t].tdp=a.value[t].list[a.value[t].index],l.data.list.forEach((e,d)=>{d<6&&M(c.value,e.id)})})},f=m(0),L=async()=>{r.value=32,a.value,a.value=a.value.map(t=>({met:t,list:[],tdp:{}}));for(let t=0;t<a.value.length;t++)a.value[t].display=!1;a.value[0].display=!0},M=async(t,l)=>{await k.get("/api/qapi/is_collected/"+t+"/"+l).then(e=>{b.value[l]=JSON.stringify(e)})},U=async t=>{x.value[t]=!0,await k.get("/api/xkw-helper/get_pure_question/"+c.value+"/"+t).then(async l=>{const e=l.data,d={bankid:c.value,qid:t,q:e.body,a:"<answerparser>unsaved|u</answerparser>",extra:JSON.stringify({from:e.paperSources[0]?e.paperSources[0].name:"",knowledgepoint:e.knowledgeInfo.split("ï¼Œ"),info:[e.type.name,e.diff.name+"("+e.diff.value+")"]}),timestamp:new Date().getTime()};k.post("/api/add",d).then(F=>{x.value[t]=!1})})},B=()=>{k.post("/api/regen-attach/state-update/contentupd",a.value.map(t=>encodeURIComponent(t.met.replaceAll(`\r
`," ").replaceAll(/[ \t]/g," ").slice(0,100)))).then(t=>{location.href=k.host+"/api/regen-attach/router/begin"})};return(t,l)=>(i(),y(N,null,[r.value==1?(i(),g(n(h),{key:0},{default:u(()=>[s(n(S),{value:w.value,"onUpdate:value":l[0]||(l[0]=e=>w.value=e),type:"textarea"},null,8,["value"]),s(n(S),{value:c.value,"onUpdate:value":l[1]||(l[1]=e=>c.value=e)},null,8,["value"]),s(n(p),{onClick:A},{default:u(()=>[o("RUN")]),_:1})]),_:1})):_("",!0),r.value==2?(i(),g(n(h),{key:1},{default:u(()=>[v("div",{innerHTML:a.value.join("<br/>")},null,8,I),v("div",{innerHTML:w.value.replaceAll(`
`,"<br/>")},null,8,V),s(n(p),{onClick:E},{default:u(()=>[o("RUN")]),_:1}),s(n(p),{onClick:L},{default:u(()=>[o("RUN using ifr")]),_:1})]),_:1})):_("",!0),r.value==32?(i(),g(n(h),{key:2},{default:u(()=>[s(n(p),{onClick:B},{default:u(()=>[o("GOTO zujuan.xkw.com")]),_:1})]),_:1})):_("",!0),r.value==32?(i(),g(n(h),{key:3},{default:u(()=>[(i(!0),y(N,null,H(a.value,e=>(i(),y("div",{key:e.key},[e.display?(i(),y("div",$,[v("p",null,C(e.met),1),v("iframe",{src:"https://zujuan.xkw.com/quessearch/?keyword="+e.met},null,8,j),s(n(p),{onClick:l[2]||(l[2]=d=>{a.value[f.value].display=!1,f.value++,a.value[f.value].display=!0})},{default:u(()=>[o("< next")]),_:1}),s(n(p),{onClick:l[3]||(l[3]=d=>{a.value[f.value].display=!1,f.value--,a.value[f.value].display=!0})},{default:u(()=>[o("prev >")]),_:1})])):_("",!0)]))),128))]),_:1})):_("",!0),r.value==31?(i(),g(n(h),{key:4},{default:u(()=>[(i(!0),y(N,null,H(a.value,e=>(i(),y("div",{key:e.met},[v("p",null,C(e.met),1),v("div",{innerHTML:e.tdp.body},null,8,O),v("p",null,"QID:"+C(e.tdp.id)+" || "+C(b.value[e.tdp.id]),1),s(n(p),{onClick:d=>U(e.tdp.id),loading:x.value[e.tdp.id]},{default:u(()=>[o("SAVE")]),_:2},1032,["onClick","loading"]),s(n(p),{onClick:d=>e.tdp=e.list[--e.index]},{default:u(()=>[o("< CHANGE")]),_:2},1032,["onClick"]),s(n(p),{onClick:d=>e.tdp=e.list[++e.index]},{default:u(()=>[o("CHANGE >")]),_:2},1032,["onClick"])]))),128))]),_:1})):_("",!0),R],64))}};export{re as default};
