import{useRoute as j,useRouter as D}from"./vue-router-85f8dd9e.js";import{n as z}from"./toScreenDisplay-dc7ab8c8.js";import{q as O}from"./define_basic_qtypes-5cc5565b.js";import{A as I}from"./APIHelper-89899791.js";import{b2 as m,ab as l,m as o,u,aH as p,bc as n,F as N,t as i,bi as v,n as c,ah as U,bh as k,l as r}from"./index-6b27469d.js";import{N as d}from"./Button-a421b774.js";import{N as B}from"./Spin-dbb425d2.js";import"./light-cb8e5d18.js";import"./format-length-c9d165c6.js";import"./Icon-0741e3aa.js";import"./Warning-ad995842.js";import"./Close-df27b242.js";import"./Scrollbar-6ef5ad24.js";import"./runtime-dom.esm-bundler-4f377a37.js";import"./keysOf-5d5107c5.js";import"./Loading-a27cceda.js";import"./use-is-mounted-e356ec1d.js";import"./use-memo-7138c88c.js";import"./FadeInExpandTransition-65435983.js";import"./use-compitable-182c3d4e.js";const J={style:{width:"18.76cm","line-height":"normal"},id:"oonom"},Q={class:"noprint"},K={class:"labi-container"},V={key:0,style:{"font-size":"6.5pt","font-family":"Cambria , \u4EFF\u5B8B",margin:"0px"}},W={key:1,style:{"text-align":"center","font-family":"Cambria , \u4EFF\u5B8B",margin:"0px"}},X={style:{"font-size":"10pt"}},Y={style:{"font-size":"6.5pt"}},Z={style:{"font-family":"'courier new'"}},ee={key:2,style:{"text-align":"center","font-family":"\u9ED1\u4F53",margin:"0px"}},te={style:{"font-size":"10pt"}},ae=["onClick","data_type"],le={key:0,style:{"font-size":"6.5pt",margin:"0px","font-family":"Cambria , \u4EFF\u5B8B"}},oe={style:{"font-family":"'courier new'"}},ie={style:{"font-family":"'courier new'"}},ne={key:0},re={key:1},se=["innerHTML"],pe={key:2},ue=["innerHTML"],ce={key:3},me=["innerHTML"],ve={key:5},de=["src"],fe={key:6},ye=["src"],_e={__name:"preexport",setup(ge){const S=j(),$=D(),s=m({q:!0,a:!1,p:!1}),b=m(0),g=m(0),L=3,x=3,q=m(""),C=m(!0),T=m(-1),f=m({});I.post("/api/group/get",{id:S.params.id}).then(a=>{T.value=0,a.entry.split(",").forEach(e=>{f.value[e]=O}),m(!1),q.value=a.title,Promise.all(a.entry.split(",").map(e=>new Promise((t,y)=>{I.get("/api/qapi/get/"+e).then(_=>{f.value[e]=_,T.value++,t()})}))).then(()=>{C.value=!1,console.log("hdd",C.value)})});const h=a=>JSON.parse(a),A=a=>Object.entries(a).map(e=>e[1]),M=m(a=>{}),E=a=>{f.value[a]._extb_height=(f.value[a]._extb_height||0)+50,console.log(f.value[a]._extb_height)},w=m(1),F=()=>{localStorage.setItem("___thost___html_export",document.getElementById("corehtml").outerHTML),$.push("/grouping/preexport-2/"+S.params.id)},H=m("Cambria , \u5B8B\u4F53"),G=()=>{H.value="Times New Roman , \u5B8B\u4F53!important"},P=()=>{document.querySelectorAll("table[name=optionsTable]").forEach(e=>{if(e.querySelectorAll("td").length==4){console.log("oo",e);let t=[],y=1;e.querySelectorAll("td").forEach(_=>{t.push(_.outerHTML)}),e.addEventListener("click",()=>{console.log("click");const{ctn:_,next_lns:R}=a(t,y);e.innerHTML=_,y=R})}});function a(e,t){if(t==1)return{ctn:"<tbody><tr>"+e.join("")+"</tr></tbody>",next_lns:2};if(t==2)return{ctn:`<tbody><tr>${e[0]}${e[1]}</tr><tr>${e[2]}${e[3]}</tr></tbody>`,next_lns:4};if(t==4)return{ctn:"<tbody><tr>"+e.join("</tr><tr>")+"</tr></tbody>",next_lns:1}}};return(a,e)=>(l(),o(N,null,[u(n(d),{class:"noprint",onClick:e[0]||(e[0]=t=>s.value.q=!s.value.q)},{default:p(()=>[i("Q")]),_:1}),u(n(d),{class:"noprint",onClick:e[1]||(e[1]=t=>s.value.a=!s.value.a)},{default:p(()=>[i("A")]),_:1}),u(n(d),{class:"noprint",onClick:e[2]||(e[2]=t=>s.value.p=!s.value.p)},{default:p(()=>[i("P")]),_:1}),u(n(d),{class:"noprint",onClick:e[3]||(e[3]=t=>M.value=E)},{default:p(()=>[i("\u5355\u51FB\u9898\u9762\u65F6\u589E\u52A0\u7A7A\u683C")]),_:1}),u(n(d),{class:"noprint",onClick:G},{default:p(()=>[i("\u5B57\u4F53\u8F6C\u4E3ATimes")]),_:1}),u(n(d),{class:"noprint",onClick:e[4]||(e[4]=t=>w.value==2?w.value=1:w.value=2)},{default:p(()=>[i("\u6539\u53D8\u5217\u6570 ")]),_:1}),u(n(d),{class:"noprint",onClick:e[5]||(e[5]=t=>{M.value=()=>{},P()})},{default:p(()=>[i("\u4FEE\u6B63opttable")]),_:1}),u(n(d),{class:"noprint",onClick:e[6]||(e[6]=t=>a.Noptions_ret2=!0)},{default:p(()=>[i("Retheme 2")]),_:1}),u(n(d),{class:"noprint",onClick:e[7]||(e[7]=t=>b.value++)},{default:p(()=>[i("Title format")]),_:1}),u(n(d),{class:"noprint",onClick:e[8]||(e[8]=t=>g.value++)},{default:p(()=>[i("Info format")]),_:1}),u(n(d),{class:"noprint",onClick:e[9]||(e[9]=t=>F())},{default:p(()=>[i("\u8FDB\u5165\u4E0D\u5305\u542Bfixed content\u7684\u4FEE\u6B63\u9875\u9762")]),_:1}),u(n(B),{show:C.value},{description:p(()=>[i(" \u72B6\u6001\uFF1A"+v(T.value==-1?"\u6B63\u5728\u83B7\u53D6Group\u6570\u636E":"\u5DF2\u52A0\u8F7D\u4E86"+T.value+"\u6761"),1)]),default:p(()=>[c("div",J,[c("div",Q,[c("div",K,[(l(),o(N,null,U([1,2,3,4,5,6,7],t=>c("div",{class:"labi-block",key:t,style:{height:"1045px"}},"Page # "+v(t),1)),64))])]),C.value?r("",!0):(l(),o("div",{key:0,id:"corehtml",style:k({width:"18.76cm",columns:w.value,"line-height":"normal"})},[b.value%L==0?(l(),o("p",V," Generated by thost | Group UUID: "+v(a.$route.params.id)+" | Title: "+v(q.value),1)):r("",!0),b.value%L==1?(l(),o("div",W,[c("p",X,v(q.value),1),c("p",Y,[i("Generated by thost | UUID: "),c("span",Z,v(a.$route.params.id),1)])])):r("",!0),b.value%L==2?(l(),o("div",ee,[c("p",te,v(q.value),1)])):r("",!0),(l(!0),o(N,null,U(A(f.value),(t,y)=>(l(),o("div",{key:t.id,onClick:_=>M.value(t.id),data_type:h(t.extra).info[0],class:"___core_block"},[g.value%x==0?(l(),o("p",le,[i(" UUID:"),c("span",oe,v(t.id),1),i(" | qid:"),c("span",ie,v(t.qid),1),i(),s.value.q?(l(),o("span",ne,"| Info: "+v(h(t.extra).info)+" | Origin: "+v(h(t.extra).from),1)):r("",!0)])):r("",!0),g.value%x==0?(l(),o("div",re,[s.value.q?(l(),o("div",{key:0,innerHTML:n(z)(t.q,{ret2:a.Noptions_ret2}),style:k({fontSize:"9.5pt",fontFamily:H.value})},null,12,se)):r("",!0)])):r("",!0),g.value%x==1?(l(),o("div",pe,[s.value.q?(l(),o("div",{key:0,innerHTML:"<strong>"+(y+1)+".</strong> ("+h(t.extra).info[0]+","+h(t.extra).info[1]+") "+n(z)(t.q,{ret2:a.Noptions_ret2}),style:k({fontSize:"9.5pt",fontFamily:H.value})},null,12,ue)):r("",!0)])):r("",!0),g.value%x==2?(l(),o("div",ce,[s.value.q?(l(),o("div",{key:0,innerHTML:"<strong>"+(y+1)+".</strong> "+n(z)(t.q,{ret2:a.Noptions_ret2}),style:k({fontSize:"9.5pt",fontFamily:H.value})},null,12,me)):r("",!0)])):r("",!0),s.value.q?(l(),o("div",{key:4,style:k({display:"block",height:(t._extb_height||0)+"px"})},null,4)):r("",!0),s.value.a?(l(),o("div",ve,[c("img",{src:"/oss-storage/"+t.a.replace("<answerparser>","").replace("</answerparser>","").split("|")[0]+".png"},null,8,de)])):r("",!0),s.value.p?(l(),o("div",fe,[c("img",{src:"/oss-storage/"+t.a.replace("<answerparser>","").replace("</answerparser>","").split("|")[1]+".png"},null,8,ye)])):r("",!0)],8,ae))),128))],4))])]),_:1},8,["show"])],64))}};export{_e as default};
