{"version":3,"file":"ftc-16312c90.js","sources":["../../src/views/zujuanink-v3/views/ftc/twrapper.vue","../../src/views/zujuanink-v3/views/ftc/nomorlize_q.js","../../src/views/zujuanink-v3/views/ftc/generateTemplate.js","../../src/views/zujuanink-v3/views/ftc/ftc.vue"],"sourcesContent":["<template>\r\n<div>\r\n    <n-p>{{ $attrs.qcontent.note }}</n-p>\r\n    <div v-if=\"LoadingTFinished\"><t-core :qcontent=\"TContent\"/></div>\r\n    <div v-else><t-null :qid=\"$attrs.qcontent.qid\"/></div>\r\n    <n-p>Insights: {{ $attrs.qcontent.insights }}</n-p>\r\n</div>\r\n</template>\r\n<script setup>\r\nimport { ref, shallowRef, useAttrs } from \"vue\";\r\nimport TCore from \"../../questionBlock/ild.vue\"\r\nimport TNull from \"../../questionBlock/null.vue\"\r\nimport { NSpin,NP } from \"naive-ui\";\r\nimport { API } from \"../../../../shared/APIHelper\";\r\n\r\n\r\nconst attrs=useAttrs()\r\nconsole.log(attrs);\r\n// const STrigger=shallowRef(h(TNull))\r\nconst LoadingTFinished=ref(false),\r\nTContent=ref({})\r\n\r\n\r\n\r\nAPI.get(\"/zujuan-ink-be-core/data/getq/\"+attrs.qcontent.quid).then(o=>{\r\n    TContent.value=o\r\n    LoadingTFinished.value=true\r\n})\r\n</script>","\r\nimport { API } from \"../../../../shared/APIHelper\"\r\n\r\n\r\nfunction normalizeq(q,Nopt){\r\n    const ool=document.createElement(\"div\")\r\n    q=q.replaceAll(\"【题文】\",\"\")\r\n    ool.innerHTML=q\r\n\r\n    ool.querySelectorAll(\"img\").forEach(v=>{\r\n        if(v.src.includes(\"/formula/\")){\r\n            v.src=v.src.replace(\".png\",\".svg\")\r\n            v.style.width=(v.width*.8)+\"px\"\r\n            v.src=v.src.replace(\"https://staticzujuan.xkw.com/quesimg/Upload/formula/\",API.host+\"/api/xkw-helper/route-formula-svg/\").replace(\".svg\",\"\")\r\n        }\r\n        if(v.src.includes(\"/dksih/\")){\r\n            let tmp=/\\?resizew=(\\d*)/.exec(v.src)\r\n            if(tmp&&tmp.length!=0){\r\n                v.style.width=tmp[1]+\"px\"\r\n                v.src=v.src.replace(/\\?resizew=(\\d*)/,\"\")\r\n                v.setAttribute(\"width\",tmp[1])\r\n                v.setAttribute(\"height\",\"\")\r\n            }\r\n        }\r\n    })\r\n\r\n\r\n    ool.querySelectorAll(\"p\").forEach(v=>{\r\n        if(!v.style.fontFamily){\r\n            v.style.fontFamily=\"'Times New Romans' , 宋体\"\r\n        }\r\n        if(!v.style.fontSize){\r\n            v.style.fontSize=\"9.5pt\"\r\n        }\r\n\r\n        // v.style.lineHeight=\"12pt\"\r\n        v.style.margin=\"0px\"\r\n    })\r\n\r\n\r\n    ool.querySelectorAll(\"table[name=optionsTable]\").forEach(v=>{\r\n        if(v.querySelectorAll(\"td\").length==4){\r\n            // console.log(\"oo\",v);\r\n            let opts=[],lns=1\r\n            v.querySelectorAll(\"td\").forEach(oo=>{\r\n                opts.push(oo.outerHTML)\r\n            })\r\n            v.addEventListener(\"click\",()=>{\r\n                console.log(\"click\");\r\n                const {ctn,next_lns}=toTable(opts,lns)\r\n                v.innerHTML=ctn\r\n                lns=next_lns\r\n            })\r\n        }\r\n\r\n    })\r\n\r\n    ool.querySelectorAll(\"table[name=optionsTable] td\").forEach(v=>{\r\n        if(!v.style.fontFamily){\r\n            v.style.fontFamily=\"Cambria , 宋体\"\r\n        }\r\n        if(!v.style.fontSize){\r\n            v.style.fontSize=\"9.5pt\"\r\n        }\r\n\r\n        // v.style.lineHeight=\"12pt\"\r\n        v.style.margin=\"0px\"\r\n    })\r\n\r\n\r\n    //18.76/4\r\n\r\n    ool.style.fontFamily=\"Cambria , 宋体\"\r\n\r\n\r\n    // if(Nopt.ret2){\r\n    //     ool.querySelectorAll(\"span\").forEach(v=>{\r\n    //         v.innerHTML=v.innerHTML.replace(/【小题(\\d*)】/,\"$1.\")\r\n    //     })\r\n    //     ool.querySelectorAll(\"bk\").forEach(v=>{\r\n    //         v.innerHTML=\"<u>&nbsp;&nbsp;&nbsp;\"+v.attributes.index.nodeValue+\"&nbsp;&nbsp;&nbsp;</u>\"\r\n            \r\n    //     })\r\n    // }\r\n\r\n    // console.log(ool.innerHTML);\r\n\r\n\r\n    return ool.outerHTML\r\n}\r\n\r\n\r\nfunction toTable(opts,lns){\r\n    if(lns==1){\r\n        return {ctn:\"<tbody><tr>\"+opts.join(\"\")+\"</tr></tbody>\",next_lns:2}\r\n    }\r\n    if(lns==2){\r\n        return {ctn:`<tbody><tr>${opts[0]}${opts[1]}</tr><tr>${opts[2]}${opts[3]}</tr></tbody>`,next_lns:4}\r\n    }\r\n    if(lns==4){\r\n        return {ctn:\"<tbody><tr>\"+opts.join(\"</tr><tr>\")+\"</tr></tbody>\",next_lns:1}\r\n    }\r\n}\r\n\r\nexport{normalizeq}\r\n","import { API } from \"../../../../shared/APIHelper\"\r\nimport { Diffsmap_flattened } from \"../../questionBlock/Diffsmap_flattened\"\r\nimport { Typesmap_flattened } from \"../../questionBlock/Typesmap_flattened\"\r\nimport { normalizeq } from \"./nomorlize_q\"\r\n\r\nasync function generateExpHTMLCode(ics,opts){\r\n    let htmlelem=document.createElement(\"div\")\r\n    let ctncode=\"<div>\"\r\n    for (let i = 0; i < ics.length; i++) {\r\n        await API.get(\"/zujuan-ink-be-core/data/getq/\"+ics[i].quid).then(w=>{\r\n            ctncode+=`\r\n            <div class=\"qqmain\" id=\"qmain-${i}\">\r\n            <p class=\"note\" id=\"q-note-${i}\">${ics[i].note!=\"\"?\"注：\"+ics[i].note:\"\"}</p>\r\n            <div class=\"qblock\" id=\"qblock-${i}\">${opts.numberEachT?(i+1)+\".\":\"\"}(${Diffsmap_flattened[w.diffv]},${Typesmap_flattened[w.typeid]})（${w.title}）${normalizeq(w.body)}</div>\r\n            \r\n            </div>\r\n            `\r\n        }) \r\n    }\r\n    ctncode+=\"</div>\"\r\n    return ctncode\r\n}\r\n\r\n\r\nexport{generateExpHTMLCode}","<template>\r\n   <n-input-group>\r\n    <n-input-group-label>好题本</n-input-group-label>\r\n      <n-button @click=\"enterFaRETMode\" :disabled=\"FailedColl.length==0\">抽查</n-button>\r\n      <n-input-group-label>筛选学科</n-input-group-label>\r\n      <n-cascader\r\n      v-model:value=\"bankid\"\r\n      :options=\"subjectsmap\"\r\n      check-strategy=\"child\"\r\n      :show-path=\"true\"\r\n      @update:value=\"refreshFiCList\"\r\n    />\r\n    <n-input-group-label>共有{{ FailedColl.length }}道错题</n-input-group-label>\r\n    <n-dropdown :options=\"options\">\r\n      <n-button>\r\n      <template #icon>\r\n        <n-icon :component=\"EllipsisVerticalOutline\"></n-icon>\r\n      </template>\r\n    </n-button>\r\n  </n-dropdown>\r\n\r\n    </n-input-group>\r\n<div v-for=\"ii in FailedColl\" class=\"centered\" v-if=\"FailedColl.length>0\"> \r\n    <n-card hoverable>\r\n<t-wrapper :qcontent=\"ii\"/>\r\n</n-card>\r\n</div>\r\n<div v-else>\r\n  <n-empty description=\"找不到。\">\r\n    <template #extra>\r\n      <n-p>原因可能是：</n-p>\r\n      <n-li>你一道题都没做过（还不快去<n-button text @click=\"$router.push('/zujuanink/preparing-room/all')\">做题</n-button>？？？）</n-li>\r\n      <n-li>你解决了所有错题（祝贺你！所以还不快去<n-button text @click=\"$router.push('/zujuanink/preparing-room/all')\">做更多题</n-button>？？？）</n-li>\r\n    </template>\r\n  </n-empty>\r\n</div>\r\n</template>\r\n<script setup>\r\nimport { ref, onMounted ,h} from \"vue\";\r\nimport { API } from \"../../../../shared/APIHelper\";\r\n\r\nimport questionBlock from \"../../questionBlock/ild.vue\"\r\nimport { NCard,NButton,NModal,NSpin,NImage,NImageGroup,NSpace,\r\nNInput,NInputGroup,NInputGroupLabel,NCascader,NDropdown,\r\nNEmpty,NP,NLi,NIcon } from \"naive-ui\";\r\nimport subjectsmap from \"../../basicinfo/subjects.json\"\r\nimport {EllipsisVerticalOutline,AddCircleOutline,ExitOutline}from \"@vicons/ionicons5\"\r\nimport { useRouter,useRoute } from \"vue-router\";\r\nimport { router_push } from \"../../utils/router-goto\";\r\nimport TWrapper from \"./twrapper.vue\";\r\nimport {generateExpHTMLCode}from \"./generateTemplate\"\r\nconst router=useRouter(),route=useRoute()\r\n\r\nconst FailedColl=ref([])\r\n\r\nconst renderIcon = (icon) => {\r\n  return () => {\r\n    return h(NIcon, null, {\r\n      default: () => h(icon)\r\n    });\r\n  };\r\n};\r\n\r\nconst exportEXT=ref({\r\n  title:\"testtest\",\r\n  numberEachT:true\r\n})\r\n\r\nconst options=[\r\n        {\r\n          label: \"手动添加错题\",\r\n          key: \"manualAdd\",\r\n          icon: renderIcon(AddCircleOutline),\r\n          props: {\r\n            onClick: () => {\r\n              router_push(router,\"/ftc/manualadd?bankid=\"+bankid.value)\r\n              \r\n            }\r\n          }\r\n        },        {\r\n          label: \"导出错题\",\r\n          key: \"export\",\r\n          icon: renderIcon(ExitOutline),\r\n          props: {\r\n            onClick: async() => {\r\n              window.vhtmlTemplate=await generateExpHTMLCode(FailedColl.value,exportEXT.value)\r\n              router_push(router,\"/ftc/export\")\r\n            }\r\n          }\r\n        }\r\n      ]\r\n\r\n\r\nconst bankid=ref(12)\r\n\r\nif(route.query.bankid){\r\n  bankid.value=parseInt(route.query.bankid)\r\n}\r\n\r\n// API.get(\"/zujuan-ink-be-core/data/list/failedcoll\").then(v=>{\r\n//     FailedColl.value=v\r\n// })\r\n\r\nconst refreshFiCList=()=>{\r\n  API.get(\"/zujuan-ink-be-core/ftc/list/filter/subject/\"+bankid.value).then(v=>{\r\n    FailedColl.value=v\r\n})\r\n}\r\n\r\nrefreshFiCList()\r\n\r\n\r\n\r\nconst showRecords=ref(false),recInfo=ref([]),loadingRecords=ref(true)\r\nconst SeeRecord=(id)=>{\r\n    showRecords.value=true\r\n    API.get(\"/zujuan-ink-be-core/donerec/filter/quuid/all/\"+id).then(v=>{\r\n        recInfo.value=v\r\n        loadingRecords.value=false\r\n    })\r\n}\r\n\r\n\r\nconst enterFaRETMode=()=>{\r\n    window.TList=FailedColl.value\r\n    window.TList.forEach((v,i)=>window.TList[i].quid=window.TList[i].id)\r\n    window.bankid=bankid.value\r\n    window.qcomponent=\"ild\"\r\n    router.push(\"/zujuanink/room\")\r\n}\r\n\r\n\r\nconst RemoveFromColl=(id)=>{\r\n  API.get(\"/zujuan-ink-be-core/data/removeFailedColl/\"+id).then(v=>{\r\n    })\r\n}\r\n</script>\r\n<style scoped>\r\n.centered{\r\n    width: 90%;\r\n    margin: auto auto;\r\n}\r\n</style>"],"names":["attrs","useAttrs","LoadingTFinished","ref","TContent","API","o","normalizeq","q","Nopt","ool","v","tmp","opts","lns","oo","ctn","next_lns","toTable","generateExpHTMLCode","ics","ctncode","i","w","Diffsmap_flattened","Typesmap_flattened","router","useRouter","route","useRoute","FailedColl","renderIcon","icon","h","NIcon","exportEXT","options","AddCircleOutline","router_push","bankid","ExitOutline","refreshFiCList","enterFaRETMode"],"mappings":"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"}