import{useRoute as N,useRouter as P}from"./vue-router-85f8dd9e.js";import{q as S}from"./define_basic_qtypes-5cc5565b.js";import{A as p}from"./APIHelper-89899791.js";import"./sweetalert.min-b990379b.js";import{_ as j}from"./_plugin-vue_export-helper-c27b6911.js";import{b2 as o,ab as v,m as h,u as n,aH as u,bc as r,n as c,bh as A,bi as y,F as E,ah as F,l as b,_ as T,t as s,ae as $,ac as B}from"./index-6b27469d.js";import{N as m}from"./Button-a421b774.js";import{N as J}from"./InputNumber-590d7ede.js";import"./light-cb8e5d18.js";import"./format-length-c9d165c6.js";import"./Icon-0741e3aa.js";import"./Warning-ad995842.js";import"./Close-df27b242.js";import"./Scrollbar-6ef5ad24.js";import"./runtime-dom.esm-bundler-4f377a37.js";import"./keysOf-5d5107c5.js";import"./_commonjsHelpers-de833af9.js";import"./Loading-a27cceda.js";import"./use-is-mounted-e356ec1d.js";import"./use-memo-7138c88c.js";import"./FadeInExpandTransition-65435983.js";import"./use-locale-13d55c5c.js";import"./index-975a2d8f.js";import"./use-merged-state-236ae148.js";import"./Input-c49f615f.js";import"./light-5edeff63.js";import"./Suffix-8898b6d6.js";import"./Add-d9842426.js";const z=w=>($("data-v-0cee61e9"),w=w(),B(),w),K={key:0,style:{width:"18.76cm","line-height":"normal"},id:"oonom"},L=z(()=>c("div",{class:"noprint"},null,-1)),M={id:"corehtml",style:{width:"18.76cm",columns:2,"line-height":"normal"}},Q={style:{"font-size":"9.5pt","font-family":"Cambria, fangsong",margin:"0px"}},V={key:0},W={style:{"font-size":"9.5pt",margin:"0px","font-family":"Cambria, \u4EFF\u5B8B"}},X={style:{"font-family":"'courier new'"}},Y={style:{"font-family":"'courier new'"}},Z={style:{overflow:"hidden",display:"inline-block"}},ee=["src"],le={key:1,style:{margin:"0 0"}},ae={key:2,style:{display:"inline",margin:"5.5pt"}},ie=z(()=>c("div",null,null,-1)),te=3,oe=8,se={__name:"export.a",setup(w){const D=N();P();const C=o(0),R=o(!1);o({q:!0,a:!1,p:!1}),o(!1);const x=o(""),g=o({});p.get("/api/group/get/"+D.params.id).then(a=>{a.entry.split(",").forEach(l=>{g.value[l]=S}),a.entry.split(","),x.value=a.title,Promise.all(a.entry.split(",").map(l=>new Promise((e,i)=>{p.get("/api/data/get/"+l).then(t=>{g.value[l]=t,p.get("/api/xkw-helper/getCachedImg/"+t.bankid+"/"+t.qid+"/400").then(H=>{f.value[t.id]={a:p.host+"/api/xkw-helper/route-pic?purl="+btoa(H.answer.replace("@2","@3").replace("c2","c1")),p:p.host+"/api/xkw-helper/route-pic?purl="+btoa(H.parse.replace("@2","@3").replace("c2","c1"))},console.log(f,t),e()})})}))).then(()=>{R.value=!0})}),o({});const _=a=>Object.entries(a).map(l=>l[1]);o(!1);const f=o({}),k=o({}),d=o({}),q=(a,l)=>{p.post("/ocr-service",{url:f.value[a.id].a,psm:l,lang:"eng+chi_sim"}).then(e=>{k.value[a.id]=e.result})},O=a=>{for(let l=0;l<_(g.value).length;l++){let e=_(g.value)[l];console.log(e),p.post("/ocr-service",{url:f.value[e.id].a,psm:a,lang:"eng+chi_sim"}).then(i=>{k.value[e.id]=i.result})}},G=()=>{const a=[2901,290101,2908,2701,2704,3011,3012,3101,310101,310104,3103,261104],l=[2801,280101,280102,280103,2803,2804,280401,280402,280403,280404,2805,2820,2808,2809,280901,280902,280903,280904,2812,281201,281203,2813,281301,281302];for(let e=0;e<_(g.value).length;e++){let i=_(g.value)[e];console.log(i.type),l.includes(i.type)?p.post("/ocr-service",{url:f.value[i.id].a,psm:te,lang:"eng+chi_sim"}).then(t=>{k.value[i.id]=t.result,d.value[i.id]=!0}):a.includes(i.type)&&p.post("/ocr-service",{url:f.value[i.id].a,psm:oe,lang:"eng+chi_sim"}).then(t=>{k.value[i.id]=t.result,d.value[i.id]=!0})}},U=o(0),I=async()=>{document.querySelectorAll("#oonom .noprint").forEach(a=>{a.style.display="none"}),await T(),U.value=document.querySelector("#oonom").clientHeight};return(a,l)=>(v(),h(E,null,[n(r(m),{onClick:l[0]||(l[0]=e=>C.value+=20),class:"noprint"},{default:u(()=>[s("Height+")]),_:1}),n(r(m),{onClick:l[1]||(l[1]=e=>C.value-=10),class:"noprint"},{default:u(()=>[s("Height-")]),_:1}),n(r(J),{class:"noprint",value:C.value,"onUpdate:value":l[2]||(l[2]=e=>C.value=e),style:{width:"90px"}},null,8,["value"]),n(r(m),{onClick:l[3]||(l[3]=e=>O(8)),class:"noprint"},{default:u(()=>[s("OCR all chars")]),_:1}),n(r(m),{onClick:l[4]||(l[4]=e=>O(3)),class:"noprint"},{default:u(()=>[s("OCR all blocks")]),_:1}),n(r(m),{onClick:l[5]||(l[5]=e=>G()),class:"noprint"},{default:u(()=>[s("OCR all selective")]),_:1}),n(r(m),{onClick:I,class:"noprint"},{default:u(()=>[s("\u663E\u793A\u9876\u7AEF\u9AD8\u5EA6: "+y(U.value)+" px",1)]),_:1}),R.value?(v(),h("div",K,[L,c("div",{style:A({display:"block",height:C.value+"px"})},null,4),c("div",M,[c("p",Q," Generated by thost | Group UUID: "+y(a.$route.params.id)+" | Title: "+y(x.value),1),(v(!0),h(E,null,F(_(g.value),(e,i)=>(v(),h("div",{key:e.id,style:A({display:d.value[e.id]?"inline-block":"block"})},[d.value[e.id]?b("",!0):(v(),h("div",V,[c("p",W,[s(" UUID:"),c("span",X,y(e.id),1),s(" | qid:"),c("span",Y,y(e.qid),1)])])),c("div",Z,[d.value[e.id]?b("",!0):(v(),h("img",{key:0,src:(f.value[e.id]||{a:""}).a},null,8,ee)),n(r(m),{onClick:t=>q(e,8),class:"noprint"},{default:u(()=>[s("OCR chars")]),_:2},1032,["onClick"]),n(r(m),{onClick:t=>q(e,3),class:"noprint"},{default:u(()=>[s("OCR block")]),_:2},1032,["onClick"]),k.value[e.id]&&!d.value[e.id]?(v(),h("p",le,y(k.value[e.id]),1)):b("",!0),n(r(m),{onClick:t=>d.value[e.id]=!0,class:"noprint"},{default:u(()=>[s("Accept OCR Result")]),_:2},1032,["onClick"]),d.value[e.id]?(v(),h("p",ae,y(i+1)+". "+y(k.value[e.id]),1)):b("",!0),ie])],4))),128))])])):b("",!0)],64))}},ne=j(se,[["__scopeId","data-v-0cee61e9"]]);export{ne as default};
