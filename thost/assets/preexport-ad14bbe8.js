import{useRoute as D,useRouter as G}from"./vue-router-66374999.js";import{n as L}from"./nomorlize_q-4ee1d2af.js";import{q as O}from"./define_basic_qtypes-ddf25d69.js";import{A as I}from"./APIHelper-697d5a21.js";import{aZ as m,a8 as o,l as r,t as p,aE as u,s as l,b7 as i,bd as c,m as d,F as z,ae as M,bc as k,k as s}from"./runtime-core.esm-bundler-42be6625.js";import{b as _}from"./Button-cc4d8cf9.js";import{N as R}from"./Spin-38bf3ba1.js";import"./light-061b806c.js";import"./format-length-c9d165c6.js";import"./Icon-9bae1ecc.js";import"./Warning-342b5d14.js";import"./Close-7ee9b945.js";import"./Scrollbar-56892bdd.js";import"./runtime-dom.esm-bundler-4c01a608.js";import"./keysOf-5d5107c5.js";import"./use-memo-8d560c6d.js";import"./resolve-slot-612957d7.js";import"./FadeInExpandTransition-8360c680.js";import"./call-7e0089d6.js";import"./use-compitable-85535777.js";const V={style:{width:"18.76cm","line-height":"normal"},id:"oonom"},J={class:"noprint"},Q={class:"labi-container"},Z={key:0,style:{"font-size":"6.5pt","font-family":"Cambria , 仿宋",margin:"0px"}},K={key:1,style:{"text-align":"center","font-family":"Cambria , 仿宋",margin:"0px"}},W={style:{"font-size":"10pt"}},X={style:{"font-size":"6.5pt"}},Y={style:{"font-family":"'courier new'"}},tt={key:2,style:{"text-align":"center","font-family":"黑体",margin:"0px"}},et={style:{"font-size":"10pt"}},nt=["onClick","data_type"],ot={key:0,style:{"font-size":"6.5pt",margin:"0px","font-family":"Cambria , 仿宋"}},rt={style:{"font-family":"'courier new'"}},lt={style:{"font-family":"'courier new'"}},it={key:0},st={key:1},at=["innerHTML"],ut={key:2},pt=["innerHTML"],dt={key:3},mt=["innerHTML"],ct={key:5},_t=["src"],ft={key:6},vt=["src"],Bt={__name:"preexport",setup(yt){const H=D(),E=G(),a=m({q:!0,a:!1,p:!1}),b=m(0),h=m(0),N=3,x=3,C=m(""),q=m(!0),T=m(-1),f=m({});I.post("/api/group/get",{id:H.params.id}).then(n=>{T.value=0,n.entry.split(",").forEach(t=>{f.value[t]=O}),m(!1),C.value=n.title,Promise.all(n.entry.split(",").map(t=>new Promise((e,v)=>{I.get("/api/qapi/get/"+t).then(y=>{f.value[t]=y,T.value++,e()})}))).then(()=>{q.value=!1,console.log("hdd",q.value)})});const g=n=>JSON.parse(n),F=n=>Object.entries(n).map(t=>t[1]),S=m(n=>{}),A=n=>{f.value[n]._extb_height=(f.value[n]._extb_height||0)+50,console.log(f.value[n]._extb_height)},$=m(1),B=()=>{localStorage.setItem("___thost___html_export",document.getElementById("corehtml").outerHTML),E.push("/grouping/preexport-2/"+H.params.id)},w=m("Cambria , 宋体"),U=()=>{w.value="Times New Roman , 宋体!important"},P=()=>{document.querySelectorAll("table[name=optionsTable]").forEach(t=>{if(t.querySelectorAll("td").length==4){console.log("oo",t);let e=[],v=1;t.querySelectorAll("td").forEach(y=>{e.push(y.outerHTML)}),t.addEventListener("click",()=>{console.log("click");const{ctn:y,next_lns:j}=n(e,v);t.innerHTML=y,v=j})}});function n(t,e){if(e==1)return{ctn:"<tbody><tr>"+t.join("")+"</tr></tbody>",next_lns:2};if(e==2)return{ctn:`<tbody><tr>${t[0]}${t[1]}</tr><tr>${t[2]}${t[3]}</tr></tbody>`,next_lns:4};if(e==4)return{ctn:"<tbody><tr>"+t.join("</tr><tr>")+"</tr></tbody>",next_lns:1}}};return(n,t)=>(o(),r(z,null,[p(i(_),{class:"noprint",onClick:t[0]||(t[0]=e=>a.value.q=!a.value.q)},{default:u(()=>[l("Q")]),_:1}),p(i(_),{class:"noprint",onClick:t[1]||(t[1]=e=>a.value.a=!a.value.a)},{default:u(()=>[l("A")]),_:1}),p(i(_),{class:"noprint",onClick:t[2]||(t[2]=e=>a.value.p=!a.value.p)},{default:u(()=>[l("P")]),_:1}),p(i(_),{class:"noprint",onClick:t[3]||(t[3]=e=>S.value=A)},{default:u(()=>[l("单击题面时增加空格")]),_:1}),p(i(_),{class:"noprint",onClick:U},{default:u(()=>[l("字体转为Times")]),_:1}),p(i(_),{class:"noprint",onClick:t[4]||(t[4]=e=>$.value==2?$.value=1:$.value=2)},{default:u(()=>[l("改变列数 ")]),_:1}),p(i(_),{class:"noprint",onClick:t[5]||(t[5]=e=>{S.value=()=>{},P()})},{default:u(()=>[l("修正opttable")]),_:1}),p(i(_),{class:"noprint",onClick:t[6]||(t[6]=e=>n.Noptions_ret2=!0)},{default:u(()=>[l("Retheme 2")]),_:1}),p(i(_),{class:"noprint",onClick:t[7]||(t[7]=e=>b.value++)},{default:u(()=>[l("Title format")]),_:1}),p(i(_),{class:"noprint",onClick:t[8]||(t[8]=e=>h.value++)},{default:u(()=>[l("Info format")]),_:1}),p(i(_),{class:"noprint",onClick:t[9]||(t[9]=e=>B())},{default:u(()=>[l("进入不包含fixed content的修正页面")]),_:1}),p(i(R),{show:q.value},{description:u(()=>[l(" 状态："+c(T.value==-1?"正在获取Group数据":"已加载了"+T.value+"条"),1)]),default:u(()=>[d("div",V,[d("div",J,[d("div",Q,[(o(),r(z,null,M([1,2,3,4,5,6,7],e=>d("div",{class:"labi-block",key:e,style:{height:"1045px"}},"Page # "+c(e),1)),64))])]),q.value?s("",!0):(o(),r("div",{key:0,id:"corehtml",style:k({width:"18.76cm",columns:$.value,"line-height":"normal"})},[b.value%N==0?(o(),r("p",Z," Generated by thost | Group UUID: "+c(n.$route.params.id)+" | Title: "+c(C.value),1)):s("",!0),b.value%N==1?(o(),r("div",K,[d("p",W,c(C.value),1),d("p",X,[l("Generated by thost | UUID: "),d("span",Y,c(n.$route.params.id),1)])])):s("",!0),b.value%N==2?(o(),r("div",tt,[d("p",et,c(C.value),1)])):s("",!0),(o(!0),r(z,null,M(F(f.value),(e,v)=>(o(),r("div",{key:e.id,onClick:y=>S.value(e.id),data_type:g(e.extra).info[0],class:"___core_block"},[h.value%x==0?(o(),r("p",ot,[l(" UUID:"),d("span",rt,c(e.id),1),l(" | qid:"),d("span",lt,c(e.qid),1),l(),a.value.q?(o(),r("span",it,"| Info: "+c(g(e.extra).info)+" | Origin: "+c(g(e.extra).from),1)):s("",!0)])):s("",!0),h.value%x==0?(o(),r("div",st,[a.value.q?(o(),r("div",{key:0,innerHTML:i(L)(e.q,{ret2:n.Noptions_ret2}),style:k({fontSize:"9.5pt",fontFamily:w.value})},null,12,at)):s("",!0)])):s("",!0),h.value%x==1?(o(),r("div",ut,[a.value.q?(o(),r("div",{key:0,innerHTML:"<strong>"+(v+1)+".</strong> ("+g(e.extra).info[0]+","+g(e.extra).info[1]+") "+i(L)(e.q,{ret2:n.Noptions_ret2}),style:k({fontSize:"9.5pt",fontFamily:w.value})},null,12,pt)):s("",!0)])):s("",!0),h.value%x==2?(o(),r("div",dt,[a.value.q?(o(),r("div",{key:0,innerHTML:"<strong>"+(v+1)+".</strong> "+i(L)(e.q,{ret2:n.Noptions_ret2}),style:k({fontSize:"9.5pt",fontFamily:w.value})},null,12,mt)):s("",!0)])):s("",!0),a.value.q?(o(),r("div",{key:4,style:k({display:"block",height:(e._extb_height||0)+"px"})},null,4)):s("",!0),a.value.a?(o(),r("div",ct,[d("img",{src:"/oss-storage/"+e.a.replace("<answerparser>","").replace("</answerparser>","").split("|")[0]+".png"},null,8,_t)])):s("",!0),a.value.p?(o(),r("div",ft,[d("img",{src:"/oss-storage/"+e.a.replace("<answerparser>","").replace("</answerparser>","").split("|")[1]+".png"},null,8,vt)])):s("",!0)],8,nt))),128))],4))])]),_:1},8,["show"])],64))}};export{Bt as default};
