import{A as _}from"./APIHelper-c6c5541a.js";import{aZ as s,a8 as n,l as f,j as g,aE as u,b7 as i,k,F as w,m as r,t as d,s as p,ae as A,bd as C}from"./index-c2ed52a5.js";import{N as E}from"./Input-b50999c9.js";import{N as o}from"./Button-591cb8c7.js";import{N as h}from"./Card-bc241d1a.js";import"./light-3c431b54.js";import"./format-length-c9d165c6.js";import"./Icon-9d083982.js";import"./Warning-fc401418.js";import"./Close-4e65a8ab.js";import"./Scrollbar-5b7370f2.js";import"./runtime-dom.esm-bundler-51aad541.js";import"./keysOf-5d5107c5.js";import"./use-memo-13475312.js";import"./use-locale-ca0d0990.js";import"./index-975a2d8f.js";import"./use-merged-state-5c1c3246.js";import"./Loading-b36f50c8.js";import"./use-is-mounted-912be460.js";import"./light-951b0264.js";import"./Suffix-26bafbe6.js";import"./FadeInExpandTransition-3bfdffc9.js";const S=["innerHTML"],G=["innerHTML"],q={key:0},I=["src"],O=["innerHTML"],z=r("div",null,null,-1),F={__name:"index",setup(V){const x=s(""),v=s(1),l=s([]),y=s(""),N=s({}),H=s({}),L=e=>{if(e.key=="Enter"){let t=window.getSelection().toString();l.value.push(t)}},T=()=>{v.value=2,document.addEventListener("keypress",L)},b=async()=>{v.value=31,l.value,l.value=l.value.map(e=>({met:e,list:[],tdp:{}}));for(let e=0;e<l.value.length;e++)await _.get("/api/xkw-helper/qsearch/"+y.value+"/"+l.value[e].met.slice(0,40)).then(t=>{l.value[e].list=t.data.list,l.value[e].index=0,l.value[e].tdp=l.value[e].list[l.value[e].index],t.data.list.forEach((a,c)=>{c<6&&U(y.value,a.id)})})},m=s(0),M=async()=>{v.value=32,l.value,l.value=l.value.map(e=>({met:e,list:[],tdp:{}}));for(let e=0;e<l.value.length;e++)l.value[e].display=!1;l.value[0].display=!0},U=async(e,t)=>{await _.get("/api/qapi/is_collected/"+e+"/"+t).then(a=>{N.value[t]=JSON.stringify(a)})},j=async e=>{H.value[e]=!0,await _.get("/api/data/add/"+y.value+"/"+e)},R=()=>{_.post("/api/regen-attach/state-update/contentupd",l.value.map(e=>encodeURIComponent(e.met.replaceAll(`\r
`," ").replaceAll(/[ \t]/g," ").slice(0,100)))).then(e=>{location.href=_.host+"/api/regen-attach/router/begin"})};return(e,t)=>(n(),f(w,null,[v.value==1?(n(),g(i(h),{key:0},{default:u(()=>[d(i(E),{value:x.value,"onUpdate:value":t[0]||(t[0]=a=>x.value=a),type:"textarea"},null,8,["value"]),d(i(E),{value:y.value,"onUpdate:value":t[1]||(t[1]=a=>y.value=a)},null,8,["value"]),d(i(o),{onClick:T},{default:u(()=>[p("RUN")]),_:1})]),_:1})):k("",!0),v.value==2?(n(),g(i(h),{key:1},{default:u(()=>[r("div",{innerHTML:l.value.join("<br/>")},null,8,S),r("div",{innerHTML:x.value.replaceAll(`
`,"<br/>")},null,8,G),d(i(o),{onClick:b},{default:u(()=>[p("RUN")]),_:1}),d(i(o),{onClick:M},{default:u(()=>[p("RUN using ifr")]),_:1})]),_:1})):k("",!0),v.value==32?(n(),g(i(h),{key:2},{default:u(()=>[d(i(o),{onClick:R},{default:u(()=>[p("GOTO zujuan.xkw.com")]),_:1})]),_:1})):k("",!0),v.value==32?(n(),g(i(h),{key:3},{default:u(()=>[(n(!0),f(w,null,A(l.value,a=>(n(),f("div",{key:a.key},[a.display?(n(),f("div",q,[r("p",null,C(a.met),1),r("iframe",{src:"https://zujuan.xkw.com/quessearch/?keyword="+a.met},null,8,I),d(i(o),{onClick:t[2]||(t[2]=c=>{l.value[m.value].display=!1,m.value++,l.value[m.value].display=!0})},{default:u(()=>[p("< next")]),_:1}),d(i(o),{onClick:t[3]||(t[3]=c=>{l.value[m.value].display=!1,m.value--,l.value[m.value].display=!0})},{default:u(()=>[p("prev >")]),_:1})])):k("",!0)]))),128))]),_:1})):k("",!0),v.value==31?(n(),g(i(h),{key:4},{default:u(()=>[(n(!0),f(w,null,A(l.value,a=>(n(),f("div",{key:a.met},[r("p",null,C(a.met),1),r("div",{innerHTML:a.tdp.body},null,8,O),r("p",null,"QID:"+C(a.tdp.id)+" || "+C(N.value[a.tdp.id]),1),d(i(o),{onClick:c=>j(a.tdp.id),loading:H.value[a.tdp.id]},{default:u(()=>[p("SAVE")]),_:2},1032,["onClick","loading"]),d(i(o),{onClick:c=>a.tdp=a.list[--a.index]},{default:u(()=>[p("< CHANGE")]),_:2},1032,["onClick"]),d(i(o),{onClick:c=>a.tdp=a.list[++a.index]},{default:u(()=>[p("CHANGE >")]),_:2},1032,["onClick"])]))),128))]),_:1})):k("",!0),z],64))}};export{F as default};
