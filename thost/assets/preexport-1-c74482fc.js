import{useRoute as R,useRouter as j}from"./vue-router-ee92e3b2.js";import{q as P}from"./define_basic_qtypes-5cc5565b.js";import{A as E}from"./APIHelper-c6c5541a.js";import{q as B,d as I}from"./diff.map-0594d4b4.js";import{H as D,a as O,b as V,_ as Z,c as G,d as J}from"./block-theme-2-5a205dfb.js";import{aZ as s,a8 as o,l as m,t as f,aE as b,b7 as p,m as h,F as L,ae as S,bc as C,j as _,k as d,s as g,bd as K}from"./index-c2ed52a5.js";import{N as T}from"./Button-591cb8c7.js";import"./light-3c431b54.js";import"./format-length-c9d165c6.js";import"./Icon-9d083982.js";import"./Warning-fc401418.js";import"./Close-4e65a8ab.js";import"./Scrollbar-5b7370f2.js";import"./runtime-dom.esm-bundler-51aad541.js";import"./keysOf-5d5107c5.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./Loading-b36f50c8.js";import"./use-is-mounted-912be460.js";import"./use-memo-13475312.js";import"./FadeInExpandTransition-3bfdffc9.js";function M(i,l){const t=document.createElement("div");return i=i.replaceAll("\u3010\u9898\u6587\u3011",""),l.q0b.bankid==10&&(i=i.replaceAll(/【小题(\d)】/g,"$1. ")),t.innerHTML=i,t.querySelectorAll("img").forEach(e=>{if(e.src.includes("/formula/")&&(e.src=e.src.replace(".png",".svg"),e.style.width=e.width*.8+"px",e.setAttribute("width",e.width*.8),e.setAttribute("height","")),e.src.includes("/dksih/")){let r=/\?resizew=(\d*)/.exec(e.src);r&&r.length!=0&&(r[1]>500&&(r[1]=500),e.style.width=r[1]+"px",e.src=e.src.replace(/\?resizew=(\d*)/,""),e.setAttribute("width",r[1]),e.setAttribute("height","")),e.outerHTML=`
        
            <div style="width: fit-content;display: inline-block;text-align: center;" data-belongsto="${l.tindex-1}" class="__ccccimage">${e.outerHTML}
    <p style="margin: 0 0;font-family: kaiti;">\uFF08\u7B2C${l.tindex}\u9898\u56FE\uFF09</p></div>`}}),t.querySelectorAll("p").forEach(e=>{e.style.fontFamily||(e.style.fontFamily="Times New Roman , \u5B8B\u4F53"),e.style.fontSize||(e.style.fontSize="9.5pt"),e.style.margin="0px"}),t.querySelectorAll("table[name=optionsTable]").forEach(e=>{if(e.querySelectorAll("td").length==4){let r=[];e.querySelectorAll("td").forEach(k=>{r.push(k.outerHTML)});const{ctn:u,next_lns:x}=Q(r,4);e.innerHTML=u}}),t.querySelectorAll("table[name=optionsTable] td").forEach(e=>{e.innerHTML="<span style='width:fit-content;display:block;'>"+e.innerHTML+"</span>",e.style.fontFamily||(e.style.fontFamily="Times New Roman , \u5B8B\u4F53"),e.style.fontSize||(e.style.fontSize="9.5pt"),e.style.margin="0px"}),t.style.fontFamily="Times New Roman , \u5B8B\u4F53",t.childNodes.forEach(e=>{if(e.nodeName=="#text"){const r=document.createElement("span");r.style.display="inline",r.style.margin="0",r.innerText=e.textContent,e.textContent.includes("______________________________________________________")&&(r.style.wordBreak="break-all"),e.parentNode.replaceChild(r,e)}}),t.firstElementChild.tagName=="P"&&(t.firstElementChild.outerHTML="<span>"+t.firstElementChild.innerHTML+"</span><br/>"),t.querySelectorAll("sub").forEach(e=>{e.style.display="inline"}),t.querySelectorAll("sup").forEach(e=>{e.style.display="inline"}),t.querySelectorAll("bk[type=underline]").forEach(e=>{e.innerText.includes("_")&&(e.style.color="lightgray",e.style.fontSize="13pt")}),(l.nqtype==0||l.nqtype==3)&&t.insertAdjacentHTML("afterbegin",` (${B[""+l.q0b.bankid][""+l.q0b.type]},${I[""+l.q0b.diff]}(${l.q0b.diff})) `),(l.nqtype==0||l.nqtype==3||l.nqtype==5)&&t.insertAdjacentHTML("afterbegin",`<strong>${l.tindex}. </strong>`),l.q0b.type==2809&&(console.log("oooo0"),t.querySelectorAll("bk u").forEach(e=>{e.innerHTML=e.innerHTML.replace(/【小题(\d*)】/,"$1.______________"),e.outerHTML=e.outerHTML.replace("<u>","<span>").replace("</u>","</span>")}),t.innerHTML=t.innerHTML.replaceAll(/【小题(\d*)】/g,"$1.")),l.q0b.type==280901&&(t.innerHTML=t.innerHTML.replaceAll(/【小题(\d*)】/g,"$1.")),l.q0b.type==280902&&t.querySelectorAll("bk u").forEach(e=>{e.innerHTML=e.innerHTML.replace(/【小题(\d*)】/,"$1.______________"),e.outerHTML=e.outerHTML.replace("<u>","<span>").replace("</u>","</span>")}),l.q0b.type==2808&&(t.querySelectorAll("span").forEach(e=>{e.innerHTML=e.innerHTML.replace(/【小题(\d*)】/,"$1.")}),t.querySelectorAll("bk").forEach(e=>{e.style="text-decoration: underline black;",e.outerHTML="<span style='text-decoration: underline black;'>&nbsp;&nbsp;&nbsp;"+e.attributes.index.nodeValue+"&nbsp;&nbsp;&nbsp;</span>"})),l.q0b.type==281302&&t.querySelectorAll("bk u").forEach(e=>{e.innerHTML=e.innerHTML.replace(/【小题(\d*)】/,` <span>$1.</span><span style="color: lightgray;
  font-size: 13.5pt;">__________________</span> `),e.outerHTML=e.outerHTML.replace("<u>","<span>").replace("</u>","</span>")}),t.querySelectorAll("p").forEach(e=>{e.parentElement.tagName!="TD"&&(e.innerText==`

`&&e.parentNode.removeChild(e),e.innerText==""&&e.parentNode.removeChild(e))}),t.querySelectorAll("span").forEach(e=>{e.parentElement.tagName!="TD"&&(e.innerText==`

`&&e.parentNode.removeChild(e),e.innerText==""&&e.parentNode.removeChild(e))}),t.querySelectorAll("br").forEach(e=>{var r;((r=e.nextSibling)==null?void 0:r.tagName)=="BR"&&(e.nextSibling.style.display="none")}),t.querySelectorAll("br").forEach(e=>{e.style.display=="none"&&e.parentNode.removeChild(e)}),t.outerHTML}function Q(i,l){if(l==1)return{ctn:"<tbody><tr>"+i.join("")+"</tr></tbody>",next_lns:2};if(l==2)return{ctn:`<tbody><tr>${i[0]}${i[1]}</tr><tr>${i[2]}${i[3]}</tr></tbody>`,next_lns:4};if(l==4)return{ctn:"<tbody><tr>"+i.join("</tr><tr>")+"</tr></tbody>",next_lns:1}}const U={style:{width:"18.76cm","line-height":"normal"},id:"oonom"},W={class:"noprint"},X={class:"labi-container"},Y=["onClick","data_id"],ee={__name:"preexport-1",setup(i){const l=R(),t=j(),e=s(0),r=s(0),u=3,x=3,k=s({q:!0,a:!1,p:!1}),$=s(""),v=s({title:"",guid:l.params.id}),H=s({}),w=s(!1);E.get("/api/group/get/"+l.params.id).then(c=>{c.entry.split(",").forEach(a=>{H.value[a]=P}),v.value.title=$.value=c.title,Promise.all(c.entry.split(",").map(a=>new Promise((n,y)=>{E.get("/api/data/get/"+a).then(A=>{H.value[a]=A})}))).then(()=>{})});const N=c=>Object.entries(c).map(a=>a[1]),z=s(c=>{}),q=s(1),F=()=>{localStorage.setItem("___thost___html_export",document.getElementById("corehtml").outerHTML),t.push("/grouping/preexport-2/"+l.params.id)};return s("Cambria , \u5B8B\u4F53"),(c,a)=>(o(),m(L,null,[f(p(T),{class:"noprint",onClick:a[0]||(a[0]=n=>q.value==2?q.value=1:q.value=2)},{default:b(()=>[g("\u6539\u53D8\u5217\u6570 ")]),_:1}),f(p(T),{class:"noprint",onClick:a[1]||(a[1]=n=>w.value=!0)},{default:b(()=>[g("Retheme 2")]),_:1}),f(p(T),{class:"noprint",ref:"btn1",onClick:a[2]||(a[2]=n=>e.value++)},{default:b(()=>[g("Title format")]),_:1},512),f(p(T),{class:"noprint",ref:"btn2",onClick:a[3]||(a[3]=n=>r.value++)},{default:b(()=>[g("Info format")]),_:1},512),f(p(T),{class:"noprint",ref:"btn3",onClick:a[4]||(a[4]=n=>F())},{default:b(()=>[g("\u8FDB\u5165\u4E0D\u5305\u542Bfixed content\u7684\u4FEE\u6B63\u9875\u9762")]),_:1},512),h("div",U,[h("div",W,[h("div",X,[(o(),m(L,null,S([1,2,3,4,5,6,7],n=>h("div",{class:"labi-block",key:n,style:{height:"1045px"}}," Page # "+K(n),1)),64))])]),h("div",{id:"corehtml",style:C({width:"18.95cm",columns:q.value,"line-height":"normal"})},[e.value%u==0?(o(),_(D,{key:0,data:v.value},null,8,["data"])):d("",!0),e.value%u==1?(o(),_(O,{key:1,data:v.value},null,8,["data"])):d("",!0),e.value%u==2?(o(),_(V,{key:2,data:v.value},null,8,["data"])):d("",!0),(o(!0),m(L,null,S(N(H.value),(n,y)=>(o(),m("div",{key:n.id,onClick:A=>z.value(n.id),class:"___core_block",data_id:y},[r.value%x==0?(o(),_(Z,{key:0,data:n,index:y,normalizeFun:p(M)},null,8,["data","index","normalizeFun"])):d("",!0),r.value%x==1?(o(),_(G,{key:1,data:n,index:y,normalizeFun:p(M)},null,8,["data","index","normalizeFun"])):d("",!0),r.value%x==2?(o(),_(J,{key:2,data:n,index:y,normalizeFun:p(M)},null,8,["data","index","normalizeFun"])):d("",!0),k.value.q?(o(),m("div",{key:3,style:C({display:"block",height:(n._extb_height||0)+"px"}),class:"extblank"},null,4)):d("",!0)],8,Y))),128))],4)])],64))}};export{ee as default};
