import{l as De,c as Ce,h as Fe,a as G,u as Ne,d as H,o as Oe,$ as Ue}from"./light-3c431b54.js";import{u as Se}from"./use-locale-ca0d0990.js";import{u as ke}from"./Loading-b36f50c8.js";import{u as Me}from"./use-merged-state-5c1c3246.js";import{u as h,r as W,b as _}from"./use-memo-13475312.js";import{N as Re}from"./Input-b50999c9.js";import{b as Ae,X as Q}from"./Button-591cb8c7.js";import{i as $e}from"./light-951b0264.js";import{o as Y}from"./Scrollbar-5b7370f2.js";import{N as ee}from"./Icon-9d083982.js";import{v as te,J as o,aZ as V,b3 as je,az as ze,i as Ee,X as Ke}from"./index-c2ed52a5.js";import{A as Le}from"./Add-068f2940.js";import{c as w}from"./use-is-mounted-912be460.js";const Xe=te({name:"Remove",render(){return o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},o("line",{x1:"400",y1:"256",x2:"112",y2:"256",style:`
        fill: none;
        stroke: currentColor;
        stroke-linecap: round;
        stroke-linejoin: round;
        stroke-width: 32px;
      `}))}}),Je=t=>{const{textColorDisabled:r}=t;return{iconColorDisabled:r}},Ze=De({name:"InputNumber",common:Ce,peers:{Button:Ae,Input:$e},self:Je}),qe=Ze;function Ge(t){return t==null||typeof t=="string"&&t.trim()===""?null:Number(t)}function He(t){return t.includes(".")&&(/^(-)?\d+.*(\.|0)$/.test(t)||/^\.\d+$/.test(t))}function E(t){return t==null?!0:!Number.isNaN(t)}function ne(t,r){return t==null?"":r===void 0?String(t):t.toFixed(r)}function K(t){if(t===null)return null;if(typeof t=="number")return t;{const r=Number(t);return Number.isNaN(r)?null:r}}const We=Fe([G("input-number-suffix",`
 display: inline-block;
 margin-right: 10px;
 `),G("input-number-prefix",`
 display: inline-block;
 margin-left: 10px;
 `)]),ie=800,re=100,_e=Object.assign(Object.assign({},H.props),{autofocus:Boolean,loading:{type:Boolean,default:void 0},placeholder:String,defaultValue:{type:Number,default:null},value:Number,step:{type:[Number,String],default:1},min:[Number,String],max:[Number,String],size:String,disabled:{type:Boolean,default:void 0},validator:Function,bordered:{type:Boolean,default:void 0},showButton:{type:Boolean,default:!0},buttonPlacement:{type:String,default:"right"},inputProps:Object,readonly:Boolean,clearable:Boolean,keyboard:{type:Object,default:{}},updateValueOnInput:{type:Boolean,default:!0},parse:Function,format:Function,precision:Number,status:String,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onFocus:[Function,Array],onBlur:[Function,Array],onClear:[Function,Array],onChange:[Function,Array]}),Qe=te({name:"InputNumber",props:_e,setup(t){const{mergedBorderedRef:r,mergedClsPrefixRef:g,mergedRtlRef:F}=Ne(t),u=H("InputNumber","-input-number",We,qe,t,g),{localeRef:m}=Se("InputNumber"),P=ke(t),{mergedSizeRef:le,mergedDisabledRef:oe,mergedStatusRef:ue}=P,d=V(null),L=V(null),X=V(null),N=V(t.defaultValue),ae=je(t,"value"),f=Me(ae,N),v=V(""),O=e=>{const n=String(e).split(".")[1];return n?n.length:0},se=e=>{const n=[t.min,t.max,t.step,e].map(i=>i===void 0?0:O(i));return Math.max(...n)},de=h(()=>{const{placeholder:e}=t;return e!==void 0?e:m.value.placeholder}),T=h(()=>{const e=K(t.step);return e!==null?e===0?1:Math.abs(e):1}),J=h(()=>{const e=K(t.min);return e!==null?e:null}),Z=h(()=>{const e=K(t.max);return e!==null?e:null}),I=e=>{const{value:n}=f;if(e===n){b();return}const{"onUpdate:value":i,onUpdateValue:l,onChange:s}=t,{nTriggerFormInput:c,nTriggerFormChange:x}=P;s&&w(s,e),l&&w(l,e),i&&w(i,e),N.value=e,c(),x()},a=({offset:e,doUpdateIfValid:n,fixPrecision:i,isInputing:l})=>{const{value:s}=v;if(l&&He(s))return!1;const c=(t.parse||Ge)(s);if(c===null)return n&&I(null),null;if(E(c)){const x=O(c),{precision:$}=t;if($!==void 0&&$<x&&!i)return!1;let p=parseFloat((c+e).toFixed($??se(c)));if(E(p)){const{value:j}=Z,{value:z}=J;if(j!==null&&p>j){if(!n||l)return!1;p=j}if(z!==null&&p<z){if(!n||l)return!1;p=z}return t.validator&&!t.validator(p)?!1:(n&&I(p),p)}}return!1},b=()=>{const{value:e}=f;if(E(e)){const{format:n,precision:i}=t;n?v.value=n(e):e===null||i===void 0||O(e)>i?v.value=ne(e,void 0):v.value=ne(e,i)}else v.value=String(e)};b();const fe=h(()=>a({offset:0,doUpdateIfValid:!1,isInputing:!1,fixPrecision:!1})===!1),U=h(()=>{const{value:e}=f;if(t.validator&&e===null)return!1;const{value:n}=T;return a({offset:-n,doUpdateIfValid:!1,isInputing:!1,fixPrecision:!1})!==!1}),S=h(()=>{const{value:e}=f;if(t.validator&&e===null)return!1;const{value:n}=T;return a({offset:+n,doUpdateIfValid:!1,isInputing:!1,fixPrecision:!1})!==!1});function ce(e){const{onFocus:n}=t,{nTriggerFormFocus:i}=P;n&&w(n,e),i()}function pe(e){var n,i;if(e.target===((n=d.value)===null||n===void 0?void 0:n.wrapperElRef))return;const l=a({offset:0,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0});if(l!==!1){const x=(i=d.value)===null||i===void 0?void 0:i.inputElRef;x&&(x.value=String(l||"")),f.value===l&&b()}else b();const{onBlur:s}=t,{nTriggerFormBlur:c}=P;s&&w(s,e),c(),Ke(()=>{b()})}function me(e){const{onClear:n}=t;n&&w(n,e)}function k(){const{value:e}=S;if(!e){A();return}const{value:n}=f;if(n===null)t.validator||I(q());else{const{value:i}=T;a({offset:i,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})}}function M(){const{value:e}=U;if(!e){R();return}const{value:n}=f;if(n===null)t.validator||I(q());else{const{value:i}=T;a({offset:-i,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})}}const ve=ce,he=pe;function q(){if(t.validator)return null;const{value:e}=J,{value:n}=Z;return e!==null?Math.max(0,e):n!==null?Math.min(0,n):0}function ge(e){me(e),I(null)}function be(e){var n,i,l;!((n=X.value)===null||n===void 0)&&n.$el.contains(e.target)&&e.preventDefault(),!((i=L.value)===null||i===void 0)&&i.$el.contains(e.target)&&e.preventDefault(),(l=d.value)===null||l===void 0||l.activate()}let y=null,B=null,D=null;function R(){D&&(window.clearTimeout(D),D=null),y&&(window.clearInterval(y),y=null)}function A(){C&&(window.clearTimeout(C),C=null),B&&(window.clearInterval(B),B=null)}function xe(){R(),D=window.setTimeout(()=>{y=window.setInterval(()=>{M()},re)},ie),Y("mouseup",document,R,{once:!0})}let C=null;function we(){A(),C=window.setTimeout(()=>{B=window.setInterval(()=>{k()},re)},ie),Y("mouseup",document,A,{once:!0})}const Ie=()=>{B||k()},ye=()=>{y||M()};function Be(e){var n,i;if(e.key==="Enter"){if(e.target===((n=d.value)===null||n===void 0?void 0:n.wrapperElRef))return;a({offset:0,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})!==!1&&((i=d.value)===null||i===void 0||i.deactivate())}else if(e.key==="ArrowUp"){if(!S.value||t.keyboard.ArrowUp===!1)return;e.preventDefault(),a({offset:0,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})!==!1&&k()}else if(e.key==="ArrowDown"){if(!U.value||t.keyboard.ArrowDown===!1)return;e.preventDefault(),a({offset:0,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})!==!1&&M()}}function Ve(e){v.value=e,t.updateValueOnInput&&!t.format&&!t.parse&&t.precision===void 0&&a({offset:0,doUpdateIfValid:!0,isInputing:!0,fixPrecision:!1})}ze(f,()=>{b()});const Pe={focus:()=>{var e;return(e=d.value)===null||e===void 0?void 0:e.focus()},blur:()=>{var e;return(e=d.value)===null||e===void 0?void 0:e.blur()},select:()=>{var e;return(e=d.value)===null||e===void 0?void 0:e.select()}},Te=Oe("InputNumber",F,g);return Object.assign(Object.assign({},Pe),{rtlEnabled:Te,inputInstRef:d,minusButtonInstRef:L,addButtonInstRef:X,mergedClsPrefix:g,mergedBordered:r,uncontrolledValue:N,mergedValue:f,mergedPlaceholder:de,displayedValueInvalid:fe,mergedSize:le,mergedDisabled:oe,displayedValue:v,addable:S,minusable:U,mergedStatus:ue,handleFocus:ve,handleBlur:he,handleClear:ge,handleMouseDown:be,handleAddClick:Ie,handleMinusClick:ye,handleAddMousedown:we,handleMinusMousedown:xe,handleKeyDown:Be,handleUpdateDisplayedValue:Ve,mergedTheme:u,inputThemeOverrides:{paddingSmall:"0 8px 0 10px",paddingMedium:"0 8px 0 12px",paddingLarge:"0 8px 0 14px"},buttonThemeOverrides:Ee(()=>{const{self:{iconColorDisabled:e}}=u.value,[n,i,l,s]=Ue(e);return{textColorTextDisabled:`rgb(${n}, ${i}, ${l})`,opacityDisabled:`${s}`}})})},render(){const{mergedClsPrefix:t,$slots:r}=this,g=()=>o(Q,{text:!0,disabled:!this.minusable||this.mergedDisabled||this.readonly,focusable:!1,theme:this.mergedTheme.peers.Button,themeOverrides:this.mergedTheme.peerOverrides.Button,builtinThemeOverrides:this.buttonThemeOverrides,onClick:this.handleMinusClick,onMousedown:this.handleMinusMousedown,ref:"minusButtonInstRef"},{icon:()=>_(r["minus-icon"],()=>[o(ee,{clsPrefix:t},{default:()=>o(Xe,null)})])}),F=()=>o(Q,{text:!0,disabled:!this.addable||this.mergedDisabled||this.readonly,focusable:!1,theme:this.mergedTheme.peers.Button,themeOverrides:this.mergedTheme.peerOverrides.Button,builtinThemeOverrides:this.buttonThemeOverrides,onClick:this.handleAddClick,onMousedown:this.handleAddMousedown,ref:"addButtonInstRef"},{icon:()=>_(r["add-icon"],()=>[o(ee,{clsPrefix:t},{default:()=>o(Le,null)})])});return o("div",{class:[`${t}-input-number`,this.rtlEnabled&&`${t}-input-number--rtl`]},o(Re,{ref:"inputInstRef",autofocus:this.autofocus,status:this.mergedStatus,bordered:this.mergedBordered,loading:this.loading,value:this.displayedValue,onUpdateValue:this.handleUpdateDisplayedValue,theme:this.mergedTheme.peers.Input,themeOverrides:this.mergedTheme.peerOverrides.Input,builtinThemeOverrides:this.inputThemeOverrides,size:this.mergedSize,placeholder:this.mergedPlaceholder,disabled:this.mergedDisabled,readonly:this.readonly,textDecoration:this.displayedValueInvalid?"line-through":void 0,onFocus:this.handleFocus,onBlur:this.handleBlur,onKeydown:this.handleKeyDown,onMousedown:this.handleMouseDown,onClear:this.handleClear,clearable:this.clearable,inputProps:this.inputProps,internalLoadingBeforeSuffix:!0},{prefix:()=>{var u;return this.showButton&&this.buttonPlacement==="both"?[g(),W(r.prefix,m=>m?o("span",{class:`${t}-input-number-prefix`},m):null)]:(u=r.prefix)===null||u===void 0?void 0:u.call(r)},suffix:()=>{var u;return this.showButton?[W(r.suffix,m=>m?o("span",{class:`${t}-input-number-suffix`},m):null),this.buttonPlacement==="right"?g():null,F()]:(u=r.suffix)===null||u===void 0?void 0:u.call(r)}}))}});export{Qe as N};
