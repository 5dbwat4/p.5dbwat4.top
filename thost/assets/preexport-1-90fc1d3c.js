import{useRoute as j,useRouter as D}from"./vue-router-3740985a.js";import{n as z}from"./nomorlize_q-589fa2c5.js";import{q as O}from"./define_basic_qtypes-ddf25d69.js";import{A as w}from"./APIHelper-c9b99a18.js";import{aZ as _,a8 as n,l as o,t as p,aE as d,s as i,b7 as r,m as u,F as H,ae as M,bd as c,bc as k,k as a}from"./runtime-core.esm-bundler-c066f4bf.js";import{a as m}from"./Button-68cb5d7d.js";import"./light-5802f424.js";import"./format-length-c9d165c6.js";import"./Icon-fde79c06.js";import"./Warning-459cf3e9.js";import"./Close-10bb4ae3.js";import"./Scrollbar-068db0c3.js";import"./runtime-dom.esm-bundler-caa8590e.js";import"./use-memo-b9add725.js";import"./FadeInExpandTransition-ff940b4d.js";const R={style:{width:"18.76cm","line-height":"normal"},id:"oonom"},V={class:"noprint"},G={class:"labi-container"},J={key:0,style:{"font-size":"6.5pt","font-family":"Cambria , 仿宋",margin:"0px"}},Q={key:1,style:{"text-align":"center","font-family":"Cambria , 仿宋",margin:"0px"}},Z={style:{"font-size":"10pt"}},K={style:{"font-size":"6.5pt"}},W={style:{"font-family":"'courier new'"}},X={key:2,style:{"text-align":"center","font-family":"黑体",margin:"0px"}},Y={style:{"font-size":"10pt"}},tt=["onClick","data_type","data_id"],et={key:0,style:{"font-size":"6.5pt",margin:"0px","font-family":"Cambria , 仿宋"}},nt={style:{"font-family":"'courier new'"}},ot={style:{"font-family":"'courier new'"}},lt={key:0},rt={key:1},it=["innerHTML"],at={key:2},st=["innerHTML"],ut={key:3},pt=["innerHTML"],dt={key:5},ct=["src"],mt={key:6},_t=["src"],Ht={__name:"preexport-1",setup(ft){const I=j(),N=D(),s=_({q:!0,a:!1,p:!1}),x=_(0),h=_(0),L=3,b=3,C=_(""),v=_({}),q=_(!1);w.post("/api/group/get",{id:I.params.id}).then(l=>{l.entry.split(",").forEach(t=>{v.value[t]=O}),C.value=l.title,Promise.all(l.entry.split(",").map(t=>new Promise((e,f)=>{w.get("/api/qapi/get/"+t).then(y=>{v.value[t]=y})}))).then(()=>{})});const g=l=>JSON.parse(l),E=l=>Object.entries(l).map(t=>t[1]),S=_(l=>{}),A=l=>{v.value[l]._extb_height=(v.value[l]._extb_height||0)+50,console.log(v.value[l]._extb_height)},T=_(1),B=()=>{localStorage.setItem("___thost___html_export",document.getElementById("corehtml").outerHTML),N.push("/grouping/preexport-2/"+I.params.id)},$=_("Cambria , 宋体"),F=()=>{$.value="Times New Roman , 宋体!important"},U=()=>{document.querySelectorAll("table[name=optionsTable]").forEach(t=>{if(t.querySelectorAll("td").length==4){console.log("oo",t);let e=[],f=1;t.querySelectorAll("td").forEach(y=>{e.push(y.outerHTML)}),t.addEventListener("click",()=>{console.log("click");const{ctn:y,next_lns:P}=l(e,f);t.innerHTML=y,f=P})}});function l(t,e){if(e==1)return{ctn:"<tbody><tr>"+t.join("")+"</tr></tbody>",next_lns:2};if(e==2)return{ctn:`<tbody><tr>${t[0]}${t[1]}</tr><tr>${t[2]}${t[3]}</tr></tbody>`,next_lns:4};if(e==4)return{ctn:"<tbody><tr>"+t.join("</tr><tr>")+"</tr></tbody>",next_lns:1}}};return(l,t)=>(n(),o(H,null,[p(r(m),{class:"noprint",onClick:t[0]||(t[0]=e=>s.value.q=!s.value.q)},{default:d(()=>[i("Q")]),_:1}),p(r(m),{class:"noprint",onClick:t[1]||(t[1]=e=>s.value.a=!s.value.a)},{default:d(()=>[i("A")]),_:1}),p(r(m),{class:"noprint",onClick:t[2]||(t[2]=e=>s.value.p=!s.value.p)},{default:d(()=>[i("P")]),_:1}),p(r(m),{class:"noprint",onClick:t[3]||(t[3]=e=>S.value=A)},{default:d(()=>[i("单击题面时增加空格")]),_:1}),p(r(m),{class:"noprint",onClick:F},{default:d(()=>[i("字体转为Times")]),_:1}),p(r(m),{class:"noprint",onClick:t[4]||(t[4]=e=>T.value==2?T.value=1:T.value=2)},{default:d(()=>[i("改变列数 ")]),_:1}),p(r(m),{class:"noprint",onClick:t[5]||(t[5]=e=>{S.value=()=>{},U()})},{default:d(()=>[i("修正opttable")]),_:1}),p(r(m),{class:"noprint",onClick:t[6]||(t[6]=e=>q.value=!0)},{default:d(()=>[i("Retheme 2")]),_:1}),p(r(m),{class:"noprint",onClick:t[7]||(t[7]=e=>x.value++)},{default:d(()=>[i("Title format")]),_:1}),p(r(m),{class:"noprint",onClick:t[8]||(t[8]=e=>h.value++)},{default:d(()=>[i("Info format")]),_:1}),p(r(m),{class:"noprint",onClick:t[9]||(t[9]=e=>B())},{default:d(()=>[i("进入不包含fixed content的修正页面")]),_:1}),u("div",R,[u("div",V,[u("div",G,[(n(),o(H,null,M([1,2,3,4,5,6,7],e=>u("div",{class:"labi-block",key:e,style:{height:"1045px"}},"Page # "+c(e),1)),64))])]),u("div",{id:"corehtml",style:k({width:"18.76cm",columns:T.value,"line-height":"normal"})},[x.value%L==0?(n(),o("p",J," Generated by thost | Group UUID: "+c(l.$route.params.id)+" | Title: "+c(C.value),1)):a("",!0),x.value%L==1?(n(),o("div",Q,[u("p",Z,c(C.value),1),u("p",K,[i("Generated by thost | UUID: "),u("span",W,c(l.$route.params.id),1)])])):a("",!0),x.value%L==2?(n(),o("div",X,[u("p",Y,c(C.value),1)])):a("",!0),(n(!0),o(H,null,M(E(v.value),(e,f)=>(n(),o("div",{key:e.id,onClick:y=>S.value(e.id),data_type:g(e.extra).info[0],class:"___core_block",data_id:f},[h.value%b==0?(n(),o("p",et,[i(" UUID:"),u("span",nt,c(e.id),1),i(" | qid:"),u("span",ot,c(e.qid),1),i(),s.value.q?(n(),o("span",lt,"| "+c(g(e.extra).info[0])+" | "+c(g(e.extra).info[1])+" | Origin: "+c(g(e.extra).from),1)):a("",!0)])):a("",!0),h.value%b==0?(n(),o("div",rt,[s.value.q?(n(),o("div",{key:0,innerHTML:r(z)(e.q,{ret2:q.value,tindex:f+1,includeti:!0}),style:k({fontSize:"9.5pt",fontFamily:$.value})},null,12,it)):a("",!0)])):a("",!0),h.value%b==1?(n(),o("div",at,[s.value.q?(n(),o("div",{key:0,innerHTML:r(z)(e.q,{ret2:q.value,tindex:f+1,gtittype:3,ootInfo:g(e.extra).info}),style:k({fontSize:"9.5pt",fontFamily:$.value})},null,12,st)):a("",!0)])):a("",!0),h.value%b==2?(n(),o("div",ut,[s.value.q?(n(),o("div",{key:0,innerHTML:r(z)(e.q,{ret2:q.value,tindex:f+1,gtittype:4}),style:k({fontSize:"9.5pt",fontFamily:$.value})},null,12,pt)):a("",!0)])):a("",!0),s.value.q?(n(),o("div",{key:4,style:k({display:"block",height:(e._extb_height||0)+"px"}),class:"extblank"},null,4)):a("",!0),s.value.a?(n(),o("div",dt,[u("img",{src:r(w).host+"/oss-storage/"+e.a.replace("<answerparser>","").replace("</answerparser>","").split("|")[0]+".png"},null,8,ct)])):a("",!0),s.value.p?(n(),o("div",mt,[u("img",{src:r(w).host+"/oss-storage/"+e.a.replace("<answerparser>","").replace("</answerparser>","").split("|")[1]+".png"},null,8,_t)])):a("",!0)],8,tt))),128))],4)])],64))}};export{Ht as default};
