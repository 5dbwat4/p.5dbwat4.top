import{useRoute as U,useRouter as j}from"./vue-router-3740985a.js";import{n as B}from"./nomorlize_q-965c5716.js";import{q as E}from"./define_basic_qtypes-ddf25d69.js";import{A as p}from"./APIHelper-c9b99a18.js";import{s as F}from"./sweetalert.min-9dab74b7.js";import{_ as V}from"./_plugin-vue_export-helper-c27b6911.js";import{N as L}from"./Checkbox-45e1205f.js";import{N as C,a as H}from"./Image-171fe8dd.js";import{aZ as c,a8 as d,l as u,t as i,aE as s,s as r,b7 as o,m as l,bd as _,F as I,ae as J,k as v,bc as M,ab as R,a9 as K}from"./runtime-core.esm-bundler-c066f4bf.js";import{a as f}from"./Button-68cb5d7d.js";import{N as D}from"./Spin-ff5dfbad.js";import{N as Q}from"./p-d7e0cfbf.js";import"./light-5802f424.js";import"./format-length-c9d165c6.js";import"./Icon-fde79c06.js";import"./Warning-459cf3e9.js";import"./Close-10bb4ae3.js";import"./Scrollbar-068db0c3.js";import"./runtime-dom.esm-bundler-caa8590e.js";import"./_commonjsHelpers-725317a4.js";import"./use-merged-state-89f8109f.js";import"./FadeInExpandTransition-ff940b4d.js";import"./use-memo-b9add725.js";import"./fade-in-scale-up.cssr-e615339f.js";import"./flatten-a133123b.js";import"./use-false-until-truthy-a506b738.js";import"./Tooltip-bcde8d3a.js";import"./Popover-df9fe6bd.js";import"./get-aeafa5fe.js";import"./utils-d7fa52af.js";import"./use-compitable-42538ef7.js";import"./next-frame-once-7035a838.js";import"./use-locale-5324fa07.js";import"./index-975a2d8f.js";import"./light-111bcf27.js";const S=y=>(R("data-v-b8635217"),y=y(),K(),y),W={style:{width:"18.76cm","line-height":"normal"},id:"oonom"},X=S(()=>l("div",{class:"noprint"},null,-1)),Z={id:"corehtml",style:{width:"18.76cm",columns:1,"line-height":"normal"}},Y={style:{"font-size":"9.5pt","font-family":"Cambria , fangsong",margin:"0px"}},ee={style:{"font-size":"9.5pt",margin:"0px","font-family":"Cambria , 仿宋"}},te={style:{"font-family":"'courier new'"}},ae={style:{"font-family":"'courier new'"}},oe={key:0},ie=["innerHTML"],re={key:2},se=["src"],ne={key:3},le=["src"],pe={key:4},de=S(()=>l("div",null,null,-1)),ue={__name:"index",setup(y){const g=U(),b=j(),n=c({q:!0,a:!1,p:!1}),A=c(!1),x=c(""),h=c({});p.post("/api/group/get",{id:g.params.id}).then(a=>{a.entry.split(",").forEach(e=>{h.value[e]=E}),a.entry.split(","),x.value=a.title,Promise.all(a.entry.split(",").map(e=>new Promise((t,T)=>{p.get("/api/qapi/get/"+e).then(G=>{h.value[e]=G}),O(e)}))).then(()=>{})});const w=a=>JSON.parse(a),q=c({}),z=a=>Object.entries(a).map(e=>e[1]),N=async a=>{console.log(a),await p.post("/api/qapi/doneinfo/mark",{quuid:a.id,timestamp:new Date().getTime(),displayednote:"",note:"",rate:50,bankid:a.bankid})},$=async()=>{Promise.all(Object.entries(h.value).map(a=>N(a[1]))).then(a=>{F("ok.")})},O=async a=>{q.value[a]=await p.get("/api/qapi/doneinfo/getbyquuid/"+a)},m=c(!1),k=c({}),P=a=>{console.log(a),m.value=a,m.value&&Object.entries(h.value).forEach(e=>{console.log(e),p.get("/api/xkw-helper/get_more_detail/600/"+e[1].bankid+"/"+e[1].qid).then(t=>{k.value[e[1].id]={a:p.host+"/api/xkw-helper/route-pic?purl="+btoa(t.data.answerImg.replace("@2","@3").replace("c2","c1")),p:p.host+"/api/xkw-helper/route-pic?purl="+btoa(t.data.parseImg.replace("@2","@3").replace("c2","c1"))}})})};return(a,e)=>(d(),u(I,null,[i(o(f),{class:"noprint",onClick:e[0]||(e[0]=t=>n.value.q=!n.value.q)},{default:s(()=>[r("Q")]),_:1}),i(o(f),{class:"noprint",onClick:e[1]||(e[1]=t=>n.value.a=!n.value.a)},{default:s(()=>[r("A")]),_:1}),i(o(f),{class:"noprint",onClick:e[2]||(e[2]=t=>n.value.p=!n.value.p)},{default:s(()=>[r("P")]),_:1}),i(o(f),{onClick:e[3]||(e[3]=t=>o(b).push("/grouping/preexport-1/"+o(g).params.id))},{default:s(()=>[r("开始准备打印")]),_:1}),i(o(f),{onClick:e[4]||(e[4]=t=>o(b).push("/export/"+o(g).params.id+"/a"))},{default:s(()=>[r("打印答案")]),_:1}),i(o(f),{onClick:$},{default:s(()=>[r("将本group内所有试题标记为done")]),_:1}),i(o(L),{checked:m.value,"onUpdate:checked":[e[5]||(e[5]=t=>m.value=t),P]},{default:s(()=>[r(" 直接从组卷网获取答案解析数据而非从oss缓存 ")]),_:1},8,["checked"]),l("div",W,[X,r(),i(o(H),null,{default:s(()=>[l("div",Z,[l("p",Y,"Generated by thost | Group UUID: "+_(a.$route.params.id)+" | Title: "+_(x.value),1),(d(!0),u(I,null,J(z(h.value),t=>(d(),u("div",{key:t.id},[l("p",ee,[r("UUID:"),l("span",te,_(t.id),1),r(" | qid:"),l("span",ae,_(t.qid),1),r(),n.value.q?(d(),u("span",oe,"| Info: "+_(w(t.extra).info)+" | Origin: "+_(w(t.extra).from),1)):v("",!0)]),n.value.q?(d(),u("div",{key:0,innerHTML:o(B)(t.q,{ret2:A.value}),style:{fontSize:"12pt",fontFamily:"Cambria"}},null,8,ie)):v("",!0),n.value.q?(d(),u("div",{key:1,style:M({display:"block",height:(t._extb_height||0)+"px"})},null,4)):v("",!0),n.value.a&&!m.value?(d(),u("div",re,[l("img",{src:o(p).host+"/oss-storage/"+t.a.replace("<answerparser>","").replace("</answerparser>","").split("|")[0]+".png"},null,8,se)])):v("",!0),n.value.p&&!m.value?(d(),u("div",ne,[l("img",{src:o(p).host+"/oss-storage/"+t.a.replace("<answerparser>","").replace("</answerparser>","").split("|")[1]+".png"},null,8,le)])):v("",!0),m.value?(d(),u("div",pe,[i(o(C),{lazy:"",src:(k.value[t.id]||{a:""}).a,width:700},{placeholder:s(()=>[i(o(D))]),_:2},1032,["src"]),i(o(C),{lazy:"",src:(k.value[t.id]||{p:""}).p,width:700},{placeholder:s(()=>[i(o(D))]),_:2},1032,["src"]),de])):v("",!0),i(o(f),{text:"",onClick:T=>N(t)},{default:s(()=>[r("标记为已完成")]),_:2},1032,["onClick"]),i(o(Q),null,{default:s(()=>[r("完成状态："+_(q.value[t.id]),1)]),_:2},1024)]))),128))])]),_:1})])],64))}},Re=V(ue,[["__scopeId","data-v-b8635217"]]);export{Re as default};
