import{A as _,d as G}from"./APIHelper-4c0d0968.js";import{s as ne}from"./sweetalert.min-37390c4f.js";import{a as ie,d as w,l as R,f as g,e as q,u as X,g as Y,q as ee,h as se,b as de,F as ue}from"./light-96080c0b.js";import{f as ce}from"./fade-in-height-expand.cssr-9dfe9456.js";import{u as pe}from"./use-merged-state-89f8109f.js";import{c as T,N as me}from"./FadeInExpandTransition-ff940b4d.js";import{v as $,J as f,aZ as O,i as z,aa as fe,b3 as he,aG as ve,O as ge,a8 as V,l as B,t as a,aE as o,b7 as t,s as h,bd as j,m as S,F as xe}from"./runtime-core.esm-bundler-c066f4bf.js";import{m as Ce}from"./runtime-dom.esm-bundler-caa8590e.js";import{u as be}from"./use-false-until-truthy-a506b738.js";import{c as we}from"./Scrollbar-25ba1ebe.js";import{u as Ne,b as J,c as _e}from"./use-memo-b9add725.js";import{N as ye}from"./Icon-e6ca0735.js";import{C as Ae}from"./ChevronRight-989c7384.js";import{N as Ie}from"./Spin-28bd4bca.js";import{N as K}from"./Alert-063ee1d4.js";import{N as M}from"./text-f4d25175.js";import{a as k}from"./Button-418af94d.js";import{N as Pe}from"./p-8644848c.js";import{N as Re}from"./Form-61f17521.js";import{N as U}from"./FormItem-8814ee03.js";import{N as W}from"./Input-32bb51de.js";import{N as Q}from"./Switch-8471804c.js";import{N as I}from"./Card-e4be8a6b.js";import{N as H}from"./Divider-65b08aae.js";import{N as ke}from"./InputGroup-1135b579.js";import"./format-length-c9d165c6.js";import"./Warning-ff31488d.js";import"./Close-d6ea1a86.js";import"./_commonjsHelpers-042e6b4d.js";import"./use-compitable-42538ef7.js";import"./light-169f895b.js";import"./get-9e715692.js";import"./use-collection-26725bb7.js";import"./use-locale-55e0af58.js";import"./index-975a2d8f.js";import"./light-a188f855.js";import"./Suffix-fac0a942.js";const Se=$({name:"ChevronLeft",render(){return f("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},f("path",{d:"M10.3536 3.14645C10.5488 3.34171 10.5488 3.65829 10.3536 3.85355L6.20711 8L10.3536 12.1464C10.5488 12.3417 10.5488 12.6583 10.3536 12.8536C10.1583 13.0488 9.84171 13.0488 9.64645 12.8536L5.14645 8.35355C4.95118 8.15829 4.95118 7.84171 5.14645 7.64645L9.64645 3.14645C9.84171 2.95118 10.1583 2.95118 10.3536 3.14645Z",fill:"currentColor"}))}}),ze=l=>{const{fontWeight:e,textColor1:s,textColor2:i,textColorDisabled:d,dividerColor:r,fontSize:u}=l;return{titleFontSize:u,titleFontWeight:e,dividerColor:r,titleTextColor:s,titleTextColorDisabled:d,fontSize:u,textColor:i,arrowColor:i,arrowColorDisabled:d,itemMargin:"16px 0 0 0",titlePadding:"16px 0 0 0"}},Ee={name:"Collapse",common:ie,self:ze},Le=Ee,De=w("collapse","width: 100%;",[w("collapse-item",`
 font-size: var(--n-font-size);
 color: var(--n-text-color);
 transition:
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 margin: var(--n-item-margin);
 `,[R("disabled",[g("header","cursor: not-allowed;",[g("header-main",`
 color: var(--n-title-text-color-disabled);
 `),w("collapse-item-arrow",`
 color: var(--n-arrow-color-disabled);
 `)])]),w("collapse-item","margin-left: 32px;"),q("&:first-child","margin-top: 0;"),q("&:first-child >",[g("header","padding-top: 0;")]),R("left-arrow-placement",[g("header",[w("collapse-item-arrow","margin-right: 4px;")])]),R("right-arrow-placement",[g("header",[w("collapse-item-arrow","margin-left: 4px;")])]),g("content-wrapper",[g("content-inner","padding-top: 16px;"),ce({duration:"0.15s"})]),R("active",[g("header",[R("active",[w("collapse-item-arrow","transform: rotate(90deg);")])])]),q("&:not(:first-child)","border-top: 1px solid var(--n-divider-color);"),g("header",`
 font-size: var(--n-title-font-size);
 display: flex;
 flex-wrap: nowrap;
 align-items: center;
 transition: color .3s var(--n-bezier);
 position: relative;
 padding: var(--n-title-padding);
 color: var(--n-title-text-color);
 cursor: pointer;
 `,[g("header-main",`
 display: flex;
 flex-wrap: nowrap;
 align-items: center;
 font-weight: var(--n-title-font-weight);
 transition: color .3s var(--n-bezier);
 flex: 1;
 color: var(--n-title-text-color);
 `),g("header-extra",`
 display: flex;
 align-items: center;
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 `),w("collapse-item-arrow",`
 display: flex;
 transition:
 transform .15s var(--n-bezier),
 color .3s var(--n-bezier);
 font-size: 18px;
 color: var(--n-arrow-color);
 `)])])]),Te=Object.assign(Object.assign({},Y.props),{defaultExpandedNames:{type:[Array,String],default:null},expandedNames:[Array,String],arrowPlacement:{type:String,default:"left"},accordion:{type:Boolean,default:!1},displayDirective:{type:String,default:"if"},onItemHeaderClick:[Function,Array],"onUpdate:expandedNames":[Function,Array],onUpdateExpandedNames:[Function,Array],onExpandedNamesChange:{type:[Function,Array],validator:()=>!0,default:void 0}}),te=de("n-collapse"),je=$({name:"Collapse",props:Te,setup(l,{slots:e}){const{mergedClsPrefixRef:s,inlineThemeDisabled:i,mergedRtlRef:d}=X(l),r=O(l.defaultExpandedNames),u=z(()=>l.expandedNames),n=pe(u,r),p=Y("Collapse","-collapse",De,Le,l,s);function x(C){const{"onUpdate:expandedNames":c,onUpdateExpandedNames:b,onExpandedNamesChange:A}=l;b&&T(b,C),c&&T(c,C),A&&T(A,C),r.value=C}function v(C){const{onItemHeaderClick:c}=l;c&&T(c,C)}function m(C,c,b){const{accordion:A}=l,{value:L}=n;if(A)C?(x([c]),v({name:c,expanded:!0,event:b})):(x([]),v({name:c,expanded:!1,event:b}));else if(!Array.isArray(L))x([c]),v({name:c,expanded:!0,event:b});else{const N=L.slice(),D=N.findIndex(F=>c===F);~D?(N.splice(D,1),x(N),v({name:c,expanded:!1,event:b})):(N.push(c),x(N),v({name:c,expanded:!0,event:b}))}}fe(te,{props:l,mergedClsPrefixRef:s,expandedNamesRef:n,slots:e,toggleItem:m});const P=ee("Collapse",d,s),E=z(()=>{const{common:{cubicBezierEaseInOut:C},self:{titleFontWeight:c,dividerColor:b,titlePadding:A,titleTextColor:L,titleTextColorDisabled:N,textColor:D,arrowColor:F,fontSize:ae,titleFontSize:le,arrowColorDisabled:oe,itemMargin:re}}=p.value;return{"--n-font-size":ae,"--n-bezier":C,"--n-text-color":D,"--n-divider-color":b,"--n-title-padding":A,"--n-title-font-size":le,"--n-title-text-color":L,"--n-title-text-color-disabled":N,"--n-title-font-weight":c,"--n-arrow-color":F,"--n-arrow-color-disabled":oe,"--n-item-margin":re}}),y=i?se("collapse",void 0,E,l):void 0;return{rtlEnabled:P,mergedTheme:p,mergedClsPrefix:s,cssVars:i?void 0:E,themeClass:y?.themeClass,onRender:y?.onRender}},render(){var l;return(l=this.onRender)===null||l===void 0||l.call(this),f("div",{class:[`${this.mergedClsPrefix}-collapse`,this.rtlEnabled&&`${this.mergedClsPrefix}-collapse--rtl`,this.themeClass],style:this.cssVars},this.$slots)}}),Ue=$({name:"CollapseItemContent",props:{displayDirective:{type:String,required:!0},show:Boolean,clsPrefix:{type:String,required:!0}},setup(l){return{onceTrue:be(he(l,"show"))}},render(){return f(me,null,{default:()=>{const{show:l,displayDirective:e,onceTrue:s,clsPrefix:i}=this,d=e==="show"&&s,r=f("div",{class:`${i}-collapse-item__content-wrapper`},f("div",{class:`${i}-collapse-item__content-inner`},this.$slots));return d?ve(r,[[Ce,l]]):l?r:null}})}}),$e={title:String,name:[String,Number],disabled:Boolean,displayDirective:String},Z=$({name:"CollapseItem",props:$e,setup(l){const{mergedRtlRef:e}=X(l),s=we(),i=Ne(()=>{var m;return(m=l.name)!==null&&m!==void 0?m:s}),d=ge(te);d||ue("collapse-item","`n-collapse-item` must be placed inside `n-collapse`.");const{expandedNamesRef:r,props:u,mergedClsPrefixRef:n,slots:p}=d,x=z(()=>{const{value:m}=r;if(Array.isArray(m)){const{value:P}=i;return!~m.findIndex(E=>E===P)}else if(m){const{value:P}=i;return P!==m}return!0});return{rtlEnabled:ee("Collapse",e,n),collapseSlots:p,randomName:s,mergedClsPrefix:n,collapsed:x,mergedDisplayDirective:z(()=>{const{displayDirective:m}=l;return m||u.displayDirective}),arrowPlacement:z(()=>u.arrowPlacement),handleClick(m){d&&!l.disabled&&d.toggleItem(x.value,i.value,m)}}},render(){const{collapseSlots:l,$slots:e,arrowPlacement:s,collapsed:i,mergedDisplayDirective:d,mergedClsPrefix:r,disabled:u}=this,n=J(e.header,{collapsed:i},()=>[this.title]),p=e["header-extra"]||l["header-extra"],x=e.arrow||l.arrow;return f("div",{class:[`${r}-collapse-item`,`${r}-collapse-item--${s}-arrow-placement`,u&&`${r}-collapse-item--disabled`,!i&&`${r}-collapse-item--active`]},f("div",{class:[`${r}-collapse-item__header`,!i&&`${r}-collapse-item__header--active`]},f("div",{class:`${r}-collapse-item__header-main`,onClick:this.handleClick},s==="right"&&n,f("div",{class:`${r}-collapse-item-arrow`,key:this.rtlEnabled?0:1},J(x,{collapsed:i},()=>{var v;return[f(ye,{clsPrefix:r},{default:(v=l.expandIcon)!==null&&v!==void 0?v:()=>this.rtlEnabled?f(Se,null):f(Ae,null)})]})),s==="left"&&n),_e(p,{collapsed:i},v=>f("div",{class:`${r}-collapse-item__header-extra`,onClick:this.handleClick},v))),f(Ue,{clsPrefix:r,displayDirective:d,show:!i},e))}}),Fe={key:0},qe=S("br",null,null,-1),Ve={key:1},Be={style:{display:"flex","justify-content":"flex-end"}},It={__name:"settings",setup(l){const e=O({authed:!1,loading:!0,APIURL:"",AuthCode:"",loginoutLoading:!1,rememberAuthCode:!1,autologin:!1}),s={logout:()=>{e.value.loginoutLoading=!0,_.get("/zujuan-ink-be-core/auth/json/logout").then(u=>{e.value.loginoutLoading=!1,e.value.loading=!0,localStorage.removeItem("__thost_zujuanink_auth"),_.get("/zujuan-ink-be-core/auth/status").then(n=>{e.value.authed=n.auth,e.value.loading=!1})})},login:()=>{e.value.loginoutLoading=!0,_.post("/zujuan-ink-be-core/auth/json/login",{password:e.value.AuthCode}).then(u=>{e.value.loginoutLoading=!1,u.auth?(e.value.loading=!0,e.value.rememberAuthCode&&localStorage.setItem("__thost_zujuanink_auth",JSON.stringify({autologin:e.value.autologin,rememberAuthCode:e.value.rememberAuthCode,authcode:e.value.AuthCode})),_.get("/zujuan-ink-be-core/auth/status").then(n=>{e.value.authed=n.auth,e.value.loading=!1})):ne({icon:"error",title:"鉴权失败"})})}};e.value.APIURL=_.host,_.get("/zujuan-ink-be-core/auth/status").then(u=>{e.value.authed=u.auth,e.value.loading=!1});const i=u=>window[u],d=O({sqlcontent:"",sqlresult:null}),r={execsql:()=>{_.post("/zujuan-ink-be-core/----=-SQL/----exec-",{st:d.value.sqlcontent})}};return(u,n)=>(V(),B(xe,null,[a(t(I),{title:"API鉴权",hoverable:""},{default:o(()=>[a(t(Ie),{show:e.value.loading},{default:o(()=>[e.value.authed?(V(),B("div",Fe,[a(t(K),{title:"鉴权状态有效",type:"success"},{default:o(()=>[h(" 当前使用的API地址为"),a(t(M),{code:""},{default:o(()=>[h(j(e.value.APIURL),1)]),_:1}),h("(共享自thost)"),qe,h(" 如果您需要取消自动登录，请先撤销鉴权 ")]),_:1}),a(t(k),{type:"error",dashed:"",onClick:s.logout,loading:e.value.loginoutLoading},{default:o(()=>[h(" 撤销鉴权 ")]),_:1},8,["onClick","loading"])])):(V(),B("div",Ve,[a(t(K),{title:"鉴权失败",type:"warning"},{default:o(()=>[h(" 这可能会导致您无法使用"),a(t(M),{code:""},{default:o(()=>[h("thost/zujuanink")]),_:1}),h("的一些功能。 ")]),_:1}),a(t(Pe),null,{default:o(()=>[h("您可以通过以下表单重新鉴权")]),_:1}),a(t(Re),{"label-placement":"left","label-width":"auto","require-mark-placement":"right-hanging"},{default:o(()=>[a(t(U),{label:"API URL",path:"inputValue"},{default:o(()=>[a(t(W),{value:e.value.APIURL,"onUpdate:value":n[0]||(n[0]=p=>e.value.APIURL=p),disabled:"",placeholder:"e.g. https://api.example.com"},null,8,["value"])]),_:1}),a(t(U),{label:"Auth Code",path:"inputValue"},{default:o(()=>[a(t(W),{value:e.value.AuthCode,"onUpdate:value":n[1]||(n[1]=p=>e.value.AuthCode=p),placeholder:"e.g. authcode123456",type:"password"},null,8,["value"])]),_:1}),a(t(U),{label:"记住我的Auth Code",path:"inputValue"},{default:o(()=>[a(t(Q),{value:e.value.rememberAuthCode,"onUpdate:value":n[2]||(n[2]=p=>e.value.rememberAuthCode=p)},null,8,["value"])]),_:1}),a(t(U),{label:"自动登录",path:"inputValue"},{default:o(()=>[a(t(Q),{value:e.value.autologin,"onUpdate:value":n[3]||(n[3]=p=>e.value.autologin=p),disabled:!e.value.rememberAuthCode},null,8,["value","disabled"])]),_:1}),S("div",Be,[a(t(k),{round:"",type:"primary",onClick:s.login,loading:e.value.loginoutLoading},{default:o(()=>[h(" Authenticate ")]),_:1},8,["onClick","loading"])])]),_:1})]))]),_:1},8,["show"])]),_:1}),a(t(H)),a(t(I),{title:"用户态",hoverable:""},{default:o(()=>[a(t(k),{ghost:"",onClick:t(G)},{default:o(()=>[h(" 移除所有Notification（例如API错误） ")]),_:1},8,["onClick"])]),_:1}),a(t(H)),a(t(I),{title:"Notification",hoverable:""},{default:o(()=>[a(t(k),{ghost:"",onClick:t(G)},{default:o(()=>[h(" 移除所有Notification（例如API错误） ")]),_:1},8,["onClick"])]),_:1}),a(t(H)),a(t(I),{title:"开发者选项",hoverable:""},{default:o(()=>[a(t(I),{title:"window.*"},{default:o(()=>[a(t(je),null,{default:o(()=>[a(t(Z),{title:"window.TList",name:"1"},{default:o(()=>[S("pre",null,j(i("TList")),1)]),_:1}),a(t(Z),{title:"window.bankid",name:"2"},{default:o(()=>[S("div",null,j(i("bankid")),1)]),_:1})]),_:1})]),_:1}),a(t(I),{title:"SQL Inject"},{default:o(()=>[a(t(M),null,{default:o(()=>[h("这也正是用户不应随意泄露自己的API地址的原因。正如你所见，任一获得了您的API地址和Auth Code的用户将拥有对您的后端数据库的绝对控制能力。")]),_:1}),a(t(ke),null,{default:o(()=>[a(t(W),{value:d.value.sqlcontent,"onUpdate:value":n[4]||(n[4]=p=>d.value.sqlcontent=p),placeholder:"Type your sql statement."},null,8,["value"]),a(t(k),{onClick:r.execsql},{default:o(()=>[h("EXEC")]),_:1},8,["onClick"])]),_:1}),S("pre",null,j(d.value.sqlresult),1)]),_:1})]),_:1})],64))}};export{It as default};
