import{T as xe}from"./runtime-dom.esm-bundler-caa8590e.js";import{i as pt,a as bt,e as yt,F as wt,V as kt,u as Rt,h as Ct,g as xt,N as St,c as Mt,d as Tt}from"./utils-656c6aaf.js";import{d as B,B as Nt,c as Ft,a as Pt,b as Ot,e as ce,f as ke,n as G,u as Lt,g as qe,h as Kt,s as _t}from"./light-5802f424.js";import{u as fe,r as We,a as It}from"./use-memo-b9add725.js";import{N as Bt,u as At}from"./Button-68cb5d7d.js";import{N as $e}from"./Icon-fde79c06.js";import{C as zt}from"./ChevronRight-989c7384.js";import{c as Vt,N as $t}from"./Checkbox-45e1205f.js";import{h as Pe,c as Ge,S as Dt}from"./create-e19b3023.js";import{v as re,b3 as E,aZ as S,_ as jt,J as d,O as Se,i as m,aG as Je,aQ as Et,az as De,aa as Ut,X as Ht}from"./runtime-core.esm-bundler-c066f4bf.js";import{f as qt,s as Wt,N as Gt,g as Jt}from"./Scrollbar-068db0c3.js";import{d as he}from"./Close-10bb4ae3.js";import{c as Qe,f as je}from"./fade-in-scale-up.cssr-e615339f.js";import{u as Qt}from"./use-locale-5324fa07.js";import{u as Ee}from"./use-merged-state-89f8109f.js";import{i as Xt,c as ee}from"./FadeInExpandTransition-ff940b4d.js";import{m as Zt}from"./index-cbfaa337.js";import{u as Ce,V as Yt,b as en,c as Ue}from"./Popover-df9fe6bd.js";const tn=B("base-menu-mask",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 display: flex;
 align-items: center;
 justify-content: center;
 text-align: center;
 padding: 14px;
 overflow: hidden;
`,[qt()]),nn=re({name:"BaseMenuMask",props:{clsPrefix:{type:String,required:!0}},setup(t){Nt("-base-menu-mask",tn,E(t,"clsPrefix"));const a=S(null);let o=null;const l=S(!1);return jt(()=>{o!==null&&window.clearTimeout(o)}),Object.assign({message:a,show:l},{showOnce(p,k=1500){o&&window.clearTimeout(o),l.value=!0,a.value=p,o=window.setTimeout(()=>{l.value=!1,a.value=null},k)}})},render(){return d(xe,{name:"fade-in-transition"},{default:()=>this.show?d("div",{class:`${this.clsPrefix}-base-menu-mask`},this.message):null})}}),on=t=>{const{borderRadius:a,boxShadow2:o,popoverColor:l,textColor2:h,textColor3:p,primaryColor:k,textColorDisabled:v,dividerColor:b,hoverColor:x,fontSizeMedium:R,heightMedium:N}=t;return{menuBorderRadius:a,menuColor:l,menuBoxShadow:o,menuDividerColor:b,menuHeight:"calc(var(--n-option-height) * 6.6)",optionArrowColor:p,optionHeight:N,optionFontSize:R,optionColorHover:x,optionTextColor:h,optionTextColorActive:k,optionTextColorDisabled:v,optionCheckMarkColor:k,loadingColor:k,columnWidth:"180px"}},an=Ft({name:"Cascader",common:Pt,peers:{InternalSelectMenu:pt,InternalSelection:bt,Scrollbar:Wt,Checkbox:Vt,Empty:yt},self:on}),ln=an;function Re(t){return t?t.map(a=>a.rawNode):null}function rn(t,a,o,l){const h=[],p=[];function k(v){for(const b of v){if(b.disabled)continue;const{rawNode:x}=b;p.push(x),(b.isLeaf||!a)&&h.push({label:Oe(b,l,o),value:b.key,rawNode:b.rawNode,path:Array.from(p)}),!b.isLeaf&&b.children&&k(b.children),p.pop()}}return k(t),h}function Oe(t,a,o){const l=[];for(;t;)l.push(t.rawNode[o]),t=t.parent;return l.reverse().join(a)}const ve=Ot("n-cascader"),He=re({name:"NCascaderOption",props:{tmNode:{type:Object,required:!0}},setup(t){const{expandTriggerRef:a,remoteRef:o,multipleRef:l,mergedValueRef:h,checkedKeysRef:p,indeterminateKeysRef:k,hoverKeyPathRef:v,keyboardKeyRef:b,loadingKeySetRef:x,cascadeRef:R,mergedCheckStrategyRef:N,onLoadRef:z,mergedClsPrefixRef:K,mergedThemeRef:J,labelFieldRef:Z,showCheckboxRef:M,updateHoverKey:g,updateKeyboardKey:_,addLoadingKey:O,deleteLoadingKey:L,closeMenu:I,doCheck:D,doUncheck:te,renderLabelRef:ne}=Se(ve),V=m(()=>t.tmNode.key),u=m(()=>{const{value:T}=a,{value:W}=o;return!W&&T==="hover"}),F=m(()=>{if(u.value)return X}),A=m(()=>{if(u.value)return ue}),P=fe(()=>{const{value:T}=l;return T?p.value.includes(V.value):h.value===V.value}),U=fe(()=>l.value?k.value.includes(V.value):!1),H=fe(()=>v.value.includes(V.value)),ie=fe(()=>{const{value:T}=b;return T===null?!1:T===V.value}),Me=fe(()=>o.value?x.value.has(V.value):!1),se=m(()=>t.tmNode.isLeaf),j=m(()=>t.tmNode.disabled),me=m(()=>t.tmNode.rawNode[Z.value]),q=m(()=>t.tmNode.shallowLoaded);function Q(T){if(j.value)return;const{value:W}=o,{value:pe}=x,{value:be}=z,{value:C}=V,{value:Te}=se,{value:$}=q;Pe(T,"checkbox")||(W&&!$&&!pe.has(C)&&be&&(O(C),be(t.tmNode.rawNode).then(()=>{L(C)}).catch(()=>{L(C)})),g(C),_(C)),Te&&oe()}function X(){if(!u.value||j.value)return;const{value:T}=V;g(T),_(T)}function ue(){u.value&&X()}function ge(){const{value:T}=se;T||oe()}function oe(){const{value:T}=l,{value:W}=V;T?U.value||P.value?te(W):D(W):(D(W),I(!0))}return{checkStrategy:N,multiple:l,cascade:R,checked:P,indeterminate:U,hoverPending:H,keyboardPending:ie,isLoading:Me,showCheckbox:M,isLeaf:se,disabled:j,label:me,mergedClsPrefix:K,mergedTheme:J,handleClick:Q,handleCheckboxUpdateValue:ge,mergedHandleMouseEnter:F,mergedHandleMouseMove:A,renderLabel:ne}},render(){const{mergedClsPrefix:t,renderLabel:a}=this;return d("div",{class:[`${t}-cascader-option`,{[`${t}-cascader-option--pending`]:this.keyboardPending||this.hoverPending,[`${t}-cascader-option--disabled`]:this.disabled,[`${t}-cascader-option--show-prefix`]:this.showCheckbox}],onMouseenter:this.mergedHandleMouseEnter,onMousemove:this.mergedHandleMouseMove,onClick:this.handleClick},this.showCheckbox?d("div",{class:`${t}-cascader-option__prefix`},d($t,{focusable:!1,"data-checkbox":!0,disabled:this.disabled,checked:this.checked,indeterminate:this.indeterminate,theme:this.mergedTheme.peers.Checkbox,themeOverrides:this.mergedTheme.peerOverrides.Checkbox,onUpdateChecked:this.handleCheckboxUpdateValue})):null,d("span",{class:`${t}-cascader-option__label`},a?a(this.tmNode.rawNode,this.checked):this.label),d("div",{class:`${t}-cascader-option__suffix`},d("div",{class:`${t}-cascader-option-icon-placeholder`},this.isLeaf?this.checkStrategy==="child"&&!(this.multiple&&this.cascade)?d(xe,{name:"fade-in-scale-up-transition"},{default:()=>this.checked?d($e,{clsPrefix:t,class:`${t}-cascader-option-icon ${t}-cascader-option-icon--checkmark`},{default:()=>d(wt,null)}):null}):null:d(Bt,{clsPrefix:t,scale:.85,strokeWidth:24,show:this.isLoading,class:`${t}-cascader-option-icon`},{default:()=>d($e,{clsPrefix:t,key:"arrow",class:`${t}-cascader-option-icon ${t}-cascader-option-icon--arrow`},{default:()=>d(zt,null)})}))))}}),sn=re({name:"CascaderSubmenu",props:{depth:{type:Number,required:!0},tmNodes:{type:Array,required:!0}},setup(){const{virtualScrollRef:t,mergedClsPrefixRef:a,mergedThemeRef:o,optionHeightRef:l}=Se(ve),h=S(null),p=S(null),k={scroll(v,b){var x,R;t.value?(x=p.value)===null||x===void 0||x.scrollTo({index:v}):(R=h.value)===null||R===void 0||R.scrollTo({index:v,elSize:b})}};return Object.assign({mergedClsPrefix:a,mergedTheme:o,scrollbarInstRef:h,vlInstRef:p,virtualScroll:t,itemSize:m(()=>he(l.value)),handleVlScroll:()=>{var v;(v=h.value)===null||v===void 0||v.sync()},getVlContainer:()=>{var v;return(v=p.value)===null||v===void 0?void 0:v.listElRef},getVlContent:()=>{var v;return(v=p.value)===null||v===void 0?void 0:v.itemsElRef}},k)},render(){const{mergedClsPrefix:t,mergedTheme:a,virtualScroll:o}=this;return d("div",{class:[o&&`${t}-cascader-submenu--virtual`,`${t}-cascader-submenu`]},d(Gt,{ref:"scrollbarInstRef",theme:a.peers.Scrollbar,themeOverrides:a.peerOverrides.Scrollbar,container:o?this.getVlContainer:void 0,content:o?this.getVlContent:void 0},{default:()=>o?d(kt,{items:this.tmNodes,itemSize:this.itemSize,onScroll:this.handleVlScroll,showScrollbar:!1,ref:"vlInstRef"},{default:({item:l})=>d(He,{key:l.key,tmNode:l})}):this.tmNodes.map(l=>d(He,{key:l.key,tmNode:l}))}))}}),un=re({name:"NCascaderMenu",props:{value:[String,Number,Array],placement:{type:String,default:"bottom-start"},show:Boolean,menuModel:{type:Array,required:!0},loading:Boolean,onFocus:{type:Function,required:!0},onBlur:{type:Function,required:!0},onKeydown:{type:Function,required:!0},onMousedown:{type:Function,required:!0},onTabout:{type:Function,required:!0}},setup(t){const{localeRef:a,isMountedRef:o,mergedClsPrefixRef:l,syncCascaderMenuPosition:h,handleCascaderMenuClickOutside:p,mergedThemeRef:k}=Se(ve),v=[],b=S(null),x=S(null);function R(){h()}Rt(x,R);function N(M){var g;const{value:{loadingRequiredMessage:_}}=a;(g=b.value)===null||g===void 0||g.showOnce(_(M))}function z(M){p(M)}function K(M){const{value:g}=x;g&&(g.contains(M.relatedTarget)||t.onFocus(M))}function J(M){const{value:g}=x;g&&(g.contains(M.relatedTarget)||t.onBlur(M))}return Object.assign({isMounted:o,mergedClsPrefix:l,selfElRef:x,submenuInstRefs:v,maskInstRef:b,mergedTheme:k,handleFocusin:K,handleFocusout:J,handleClickOutside:z},{scroll(M,g,_){const O=v[M];O&&O.scroll(g,_)},showErrorMessage:N})},render(){const{submenuInstRefs:t,mergedClsPrefix:a,mergedTheme:o}=this;return d(xe,{name:"fade-in-scale-up-transition",appear:this.isMounted},{default:()=>this.show?Je(d("div",{tabindex:"0",ref:"selfElRef",class:`${a}-cascader-menu`,onMousedown:this.onMousedown,onFocusin:this.handleFocusin,onFocusout:this.handleFocusout,onKeydown:this.onKeydown},this.menuModel[0].length?d("div",{class:`${a}-cascader-submenu-wrapper`},this.menuModel.map((l,h)=>d(sn,{ref:p=>{p&&(t[h]=p)},key:h,tmNodes:l,depth:h+1})),d(nn,{clsPrefix:a,ref:"maskInstRef"})):d("div",{class:`${a}-cascader-menu__empty`},We(this.$slots.empty,()=>[d(xt,{theme:o.peers.Empty,themeOverrides:o.peerOverrides.Empty})])),It(this.$slots.action,l=>l&&d("div",{class:`${a}-cascader-menu-action`,"data-action":!0},l)),d(Ct,{onFocus:this.onTabout})),[[Qe,this.handleClickOutside,void 0,{capture:!0}]]):null})}}),dn=re({name:"NCascaderSelectMenu",props:{value:{type:[String,Number,Array],default:null},show:Boolean,pattern:{type:String,default:""},multiple:Boolean,tmNodes:{type:Array,default:()=>[]},filter:Function,labelField:{type:String,required:!0},separator:{type:String,required:!0}},setup(t){const{isMountedRef:a,mergedValueRef:o,mergedClsPrefixRef:l,mergedThemeRef:h,mergedCheckStrategyRef:p,slots:k,syncSelectMenuPosition:v,closeMenu:b,handleSelectMenuClickOutside:x,doUncheck:R,doCheck:N,clearPattern:z}=Se(ve),K=S(null),J=m(()=>rn(t.tmNodes,p.value==="child",t.labelField,t.separator)),Z=m(()=>{const{filter:u}=t;if(u)return u;const{labelField:F}=t;return(A,P,U)=>U.some(H=>H[F]&&~H[F].indexOf(A))}),M=m(()=>{const{pattern:u}=t,{value:F}=Z;return(u?J.value.filter(A=>F(u,A.rawNode,A.path)):J.value).map(A=>({value:A.value,label:A.label}))}),g=m(()=>Ge(M.value,Mt("value","children")));function _(){v()}function O(u){L(u)}function L(u){if(t.multiple){const{value:F}=o;Array.isArray(F)?F.includes(u.key)?R(u.key):N(u.key):F===null&&N(u.key),z()}else N(u.key),b(!0)}function I(){var u;(u=K.value)===null||u===void 0||u.prev()}function D(){var u;(u=K.value)===null||u===void 0||u.next()}function te(){var u;if(K){const F=(u=K.value)===null||u===void 0?void 0:u.getPendingTmNode();return F&&L(F),!0}return!1}function ne(u){x(u)}return Object.assign({isMounted:a,mergedTheme:h,mergedClsPrefix:l,menuInstRef:K,selectTreeMate:g,handleResize:_,handleToggle:O,handleClickOutside:ne,cascaderSlots:k},{prev:I,next:D,enter:te})},render(){const{mergedClsPrefix:t,isMounted:a,mergedTheme:o,cascaderSlots:l}=this;return d(xe,{name:"fade-in-scale-up-transition",appear:a},{default:()=>this.show?Je(d(St,{ref:"menuInstRef",onResize:this.handleResize,clsPrefix:t,class:`${t}-cascader-menu`,autoPending:!0,themeOverrides:o.peerOverrides.InternalSelectMenu,theme:o.peers.InternalSelectMenu,treeMate:this.selectTreeMate,multiple:this.multiple,value:this.value,onToggle:this.handleToggle},{empty:()=>We(l["not-found"],()=>[])}),[[Qe,this.handleClickOutside,void 0,{capture:!0}]]):null})}}),cn=ce([B("cascader-menu",`
 outline: none;
 position: relative;
 margin: 4px 0;
 display: flex;
 flex-flow: column nowrap;
 border-radius: var(--n-menu-border-radius);
 overflow: hidden;
 box-shadow: var(--n-menu-box-shadow);
 color: var(--n-option-text-color);
 background-color: var(--n-menu-color);
 `,[je({transformOrigin:"inherit",duration:"0.2s"}),ke("empty",`
 display: flex;
 padding: 12px 32px;
 flex: 1;
 justify-content: center;
 `),B("scrollbar",{width:"100%"}),B("base-menu-mask",{backgroundColor:"var(--n-menu-mask-color)"}),B("base-loading",{color:"var(--n-loading-color)"}),B("cascader-submenu-wrapper",`
 position: relative;
 display: flex;
 flex-wrap: nowrap;
 `),B("cascader-submenu",`
 height: var(--n-menu-height);
 min-width: var(--n-column-width);
 position: relative;
 `,[G("virtual",`
 width: var(--n-column-width);
 `),B("scrollbar-content",{position:"relative"}),ce("&:first-child",`
 border-top-left-radius: var(--n-menu-border-radius);
 border-bottom-left-radius: var(--n-menu-border-radius);
 `),ce("&:last-child",`
 border-top-right-radius: var(--n-menu-border-radius);
 border-bottom-right-radius: var(--n-menu-border-radius);
 `),ce("&:not(:first-child)",`
 border-left: 1px solid var(--n-menu-divider-color);
 `)]),B("cascader-menu-action",`
 box-sizing: border-box;
 padding: 8px;
 border-top: 1px solid var(--n-menu-divider-color);
 `),B("cascader-option",`
 height: var(--n-option-height);
 line-height: var(--n-option-height);
 font-size: var(--n-option-font-size);
 padding: 0 0 0 18px;
 box-sizing: border-box;
 min-width: 182px;
 background-color: #0000;
 display: flex;
 align-items: center;
 white-space: nowrap;
 position: relative;
 cursor: pointer;
 transition:
 background-color .2s var(--n-bezier),
 color 0.2s var(--n-bezier);
 `,[G("show-prefix",{paddingLeft:0}),ke("label",`
 flex: 1 0 0;
 overflow: hidden;
 text-overflow: ellipsis;
 `),ke("prefix",{width:"32px",display:"flex",alignItems:"center",justifyContent:"center"}),ke("suffix",{width:"32px",display:"flex",alignItems:"center",justifyContent:"center"}),B("cascader-option-icon-placeholder",{lineHeight:0,position:"relative",width:"16px",height:"16px",fontSize:"16px"},[B("cascader-option-icon",[G("checkmark",{color:"var(--n-option-check-mark-color)"},[je({originalTransition:"background-color .3s var(--n-bezier), box-shadow .3s var(--n-bezier)"})]),G("arrow",{color:"var(--n-option-arrow-color)"})])]),G("selected",{color:"var(--n-option-text-color-active)"}),G("active",{color:"var(--n-option-text-color-active)",backgroundColor:"var(--n-option-color-hover)"}),G("pending",{backgroundColor:"var(--n-option-color-hover)"}),ce("&:hover",{backgroundColor:"var(--n-option-color-hover)"}),G("disabled",`
 color: var(--n-option-text-color-disabled);
 background-color: #0000;
 cursor: not-allowed;
 `,[B("cascader-option-icon",[G("arrow",{color:"var(--n-option-text-color-disabled)"})])])])]),B("cascader",`
 z-index: auto;
 position: relative;
 width: 100%;
 `)]),fn=Object.assign(Object.assign({},qe.props),{allowCheckingNotLoaded:Boolean,to:Ce.propTo,bordered:{type:Boolean,default:void 0},options:{type:Array,default:()=>[]},value:[String,Number,Array],defaultValue:{type:[String,Number,Array],default:null},placeholder:String,multiple:Boolean,size:String,filterable:Boolean,disabled:{type:Boolean,default:void 0},disabledField:{type:String,default:"disabled"},expandTrigger:{type:String,default:"click"},clearable:Boolean,clearFilterAfterSelect:{type:Boolean,default:!0},remote:Boolean,onLoad:Function,separator:{type:String,default:" / "},filter:Function,placement:{type:String,default:"bottom-start"},cascade:{type:Boolean,default:!0},leafOnly:Boolean,showPath:{type:Boolean,default:!0},show:{type:Boolean,default:void 0},maxTagCount:[String,Number],menuProps:Object,filterMenuProps:Object,virtualScroll:{type:Boolean,default:!0},checkStrategy:{type:String,default:"all"},valueField:{type:String,default:"value"},labelField:{type:String,default:"label"},childrenField:{type:String,default:"children"},renderLabel:Function,status:String,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],"onUpdate:show":[Function,Array],onUpdateShow:[Function,Array],onBlur:Function,onFocus:Function,onChange:[Function,Array]}),On=re({name:"Cascader",props:fn,setup(t,{slots:a}){const{mergedBorderedRef:o,mergedClsPrefixRef:l,namespaceRef:h,inlineThemeDisabled:p}=Lt(t),k=qe("Cascader","-cascader",cn,ln,t,l),{localeRef:v}=Qt("Cascader"),b=S(t.defaultValue),x=m(()=>t.value),R=Ee(x,b),N=m(()=>t.leafOnly?"child":t.checkStrategy),z=S(""),K=At(t),{mergedSizeRef:J,mergedDisabledRef:Z,mergedStatusRef:M}=K,g=S(null),_=S(null),O=S(null),L=S(null),I=S(null),D=S(new Set),te=S(null),ne=S(null),V=Ce(t),u=S(!1),F=e=>{D.value.add(e)},A=e=>{D.value.delete(e)},P=m(()=>{const{valueField:e,childrenField:n,disabledField:r}=t;return Ge(t.options,{getDisabled(c){return c[r]},getKey(c){return c[e]},getChildren(c){return c[n]}})}),U=m(()=>{const{cascade:e,multiple:n}=t;return n&&Array.isArray(R.value)?P.value.getCheckedKeys(R.value,{cascade:e,allowNotLoaded:t.allowCheckingNotLoaded}):{checkedKeys:[],indeterminateKeys:[]}}),H=m(()=>U.value.checkedKeys),ie=m(()=>U.value.indeterminateKeys),Me=m(()=>{const{treeNodePath:e,treeNode:n}=P.value.getPath(I.value);let r;return n===null?r=[P.value.treeNodes]:(r=e.map(c=>c.siblings),!n.isLeaf&&!D.value.has(n.key)&&n.children&&r.push(n.children)),r}),se=m(()=>{const{keyPath:e}=P.value.getPath(I.value);return e}),j=m(()=>k.value.self.optionHeight);Et(t.options)&&De(t.options,(e,n)=>{e!==n&&(I.value=null,L.value=null)});function me(e){const{onUpdateShow:n,"onUpdate:show":r}=t;n&&ee(n,e),r&&ee(r,e),pe.value=e}function q(e,n,r){const{onUpdateValue:c,"onUpdate:value":i,onChange:y}=t,{nTriggerFormInput:s,nTriggerFormChange:w}=K;c&&ee(c,e,n,r),i&&ee(i,e,n,r),y&&ee(y,e,n,r),b.value=e,s(),w()}function Q(e){L.value=e}function X(e){I.value=e}function ue(e){const{value:{getNode:n}}=P;return e.map(r=>{var c;return((c=n(r))===null||c===void 0?void 0:c.rawNode)||null})}function ge(e){var n;const{cascade:r,multiple:c,filterable:i}=t,{value:{check:y,getNode:s,getPath:w}}=P;if(c)try{const{checkedKeys:f}=y(e,U.value.checkedKeys,{cascade:r,checkStrategy:N.value,allowNotLoaded:t.allowCheckingNotLoaded});q(f,ue(f),f.map(le=>{var de;return Re((de=w(le))===null||de===void 0?void 0:de.treeNodePath)})),i&&Ne(),L.value=e,I.value=e}catch(f){if(f instanceof Dt){if(g.value){const le=s(e);le!==null&&g.value.showErrorMessage(le.rawNode[t.labelField])}}else throw f}else if(N.value==="child"){const f=s(e);if(f?.isLeaf)q(e,f.rawNode,Re(w(e).treeNodePath));else return!1}else{const f=s(e);q(e,f?.rawNode||null,Re((n=w(e))===null||n===void 0?void 0:n.treeNodePath))}return!0}function oe(e){const{cascade:n,multiple:r}=t;if(r){const{value:{uncheck:c,getNode:i,getPath:y}}=P,{checkedKeys:s}=c(e,U.value.checkedKeys,{cascade:n,checkStrategy:N.value,allowNotLoaded:t.allowCheckingNotLoaded});q(s,s.map(w=>{var f;return((f=i(w))===null||f===void 0?void 0:f.rawNode)||null}),s.map(w=>{var f;return Re((f=y(w))===null||f===void 0?void 0:f.treeNodePath)})),L.value=e,I.value=e}}const T=m(()=>{if(t.multiple){const{showPath:e,separator:n,labelField:r,cascade:c}=t,{getCheckedKeys:i,getNode:y}=P.value;return i(H.value,{cascade:c,checkStrategy:N.value,allowNotLoaded:t.allowCheckingNotLoaded}).checkedKeys.map(w=>{const f=y(w);return f===null?{label:String(w),value:w}:{label:e?Oe(f,n,r):f.rawNode[r],value:f.key}})}else return[]}),W=m(()=>{const{multiple:e,showPath:n,separator:r,labelField:c}=t,{value:i}=R;if(!e&&!Array.isArray(i)){const{getNode:y}=P.value;if(i===null)return null;const s=y(i);return s===null?{label:String(i),value:i}:{label:n?Oe(s,r,c):s.rawNode[c],value:s.key}}else return null}),pe=S(!1),be=E(t,"show"),C=Ee(be,pe),Te=m(()=>{const{placeholder:e}=t;return e!==void 0?e:v.value.placeholder}),$=m(()=>!!(t.filterable&&z.value));De(C,e=>{if(!e||t.multiple)return;const{value:n}=R;!Array.isArray(n)&&n!==null?(L.value=n,I.value=n,Ht(()=>{var r;if(!C.value)return;const{value:c}=I;if(R.value!==null){const i=P.value.getNode(c);i&&((r=g.value)===null||r===void 0||r.scroll(i.level,i.index,he(j.value)))}})):(L.value=null,I.value=null)},{immediate:!0});function Le(e){const{onBlur:n}=t,{nTriggerFormBlur:r}=K;n&&ee(n,e),r()}function Ke(e){const{onFocus:n}=t,{nTriggerFormFocus:r}=K;n&&ee(n,e),r()}function Ne(){var e;(e=O.value)===null||e===void 0||e.focusInput()}function Xe(){var e;(e=O.value)===null||e===void 0||e.focus()}function ye(){Z.value||(z.value="",me(!0),t.filterable&&Ne())}function Y(e=!1){e&&Xe(),me(!1),z.value=""}function _e(e){var n;$.value||C.value&&(!((n=O.value)===null||n===void 0)&&n.$el.contains(Jt(e))||Y())}function Ze(e){$.value&&_e(e)}function Ie(){t.clearFilterAfterSelect&&(z.value="")}function we(e){var n,r,c;const{value:i}=L,{value:y}=P;switch(e){case"prev":if(i!==null){const s=y.getPrev(i,{loop:!0});s!==null&&(Q(s.key),(n=g.value)===null||n===void 0||n.scroll(s.level,s.index,he(j.value)))}break;case"next":if(i===null){const s=y.getFirstAvailableNode();s!==null&&(Q(s.key),(r=g.value)===null||r===void 0||r.scroll(s.level,s.index,he(j.value)))}else{const s=y.getNext(i,{loop:!0});s!==null&&(Q(s.key),(c=g.value)===null||c===void 0||c.scroll(s.level,s.index,he(j.value)))}break;case"child":if(i!==null){const s=y.getNode(i);if(s!==null)if(s.shallowLoaded){const w=y.getChild(i);w!==null&&(X(i),Q(w.key))}else{const{value:w}=D;if(!w.has(i)){F(i),X(i);const{onLoad:f}=t;f&&f(s.rawNode).then(()=>{A(i)}).catch(()=>{A(i)})}}}break;case"parent":if(i!==null){const s=y.getParent(i);if(s!==null){Q(s.key);const w=s.getParent();X(w===null?null:w.key)}}break}}function Be(e){var n,r;switch(e.key){case" ":case"ArrowDown":case"ArrowUp":if(t.filterable&&C.value)break;e.preventDefault();break}if(!Pe(e,"action"))switch(e.key){case" ":if(t.filterable)return;case"Enter":if(!C.value)ye();else{const{value:c}=$,{value:i}=L;if(c)_.value&&_.value.enter()&&Ie();else if(i!==null)if(H.value.includes(i)||ie.value.includes(i))oe(i);else{const y=ge(i);!t.multiple&&y&&Y(!0)}}break;case"ArrowUp":e.preventDefault(),C.value&&($.value?(n=_.value)===null||n===void 0||n.prev():we("prev"));break;case"ArrowDown":e.preventDefault(),C.value?$.value?(r=_.value)===null||r===void 0||r.next():we("next"):ye();break;case"ArrowLeft":e.preventDefault(),C.value&&!$.value&&we("parent");break;case"ArrowRight":e.preventDefault(),C.value&&!$.value&&we("child");break;case"Escape":C.value&&(Zt(e),Y(!0))}}function Ye(e){Be(e)}function et(e){e.stopPropagation(),t.multiple?q([],[],[]):q(null,null,null)}function tt(e){var n;!((n=g.value)===null||n===void 0)&&n.$el.contains(e.relatedTarget)||(u.value=!0,Ke(e))}function nt(e){var n;!((n=g.value)===null||n===void 0)&&n.$el.contains(e.relatedTarget)||(u.value=!1,Le(e),Y())}function ot(e){var n;!((n=O.value)===null||n===void 0)&&n.$el.contains(e.relatedTarget)||(u.value=!0,Ke(e))}function at(e){var n;!((n=O.value)===null||n===void 0)&&n.$el.contains(e.relatedTarget)||(u.value=!1,Le(e))}function lt(e){Pe(e,"action")||t.multiple&&t.filter&&(e.preventDefault(),Ne())}function rt(){Y(!0)}function it(){t.filterable?ye():C.value?Y(!0):ye()}function st(e){z.value=e.target.value}function ut(e){const{multiple:n}=t,{value:r}=R;n&&Array.isArray(r)&&e.value!==void 0?oe(e.value):q(null,null,null)}function Ae(){var e;(e=te.value)===null||e===void 0||e.syncPosition()}function ze(){var e;(e=ne.value)===null||e===void 0||e.syncPosition()}function dt(){C.value&&($.value?Ae():ze())}const Fe=m(()=>!!(t.multiple&&t.cascade||N.value!=="child"));Ut(ve,{slots:a,mergedClsPrefixRef:l,mergedThemeRef:k,mergedValueRef:R,checkedKeysRef:H,indeterminateKeysRef:ie,hoverKeyPathRef:se,mergedCheckStrategyRef:N,showCheckboxRef:Fe,cascadeRef:E(t,"cascade"),multipleRef:E(t,"multiple"),keyboardKeyRef:L,hoverKeyRef:I,remoteRef:E(t,"remote"),loadingKeySetRef:D,expandTriggerRef:E(t,"expandTrigger"),isMountedRef:Xt(),onLoadRef:E(t,"onLoad"),virtualScrollRef:E(t,"virtualScroll"),optionHeightRef:j,localeRef:v,labelFieldRef:E(t,"labelField"),renderLabelRef:E(t,"renderLabel"),syncCascaderMenuPosition:ze,syncSelectMenuPosition:Ae,updateKeyboardKey:Q,updateHoverKey:X,addLoadingKey:F,deleteLoadingKey:A,doCheck:ge,doUncheck:oe,closeMenu:Y,handleSelectMenuClickOutside:Ze,handleCascaderMenuClickOutside:_e,clearPattern:Ie});const ct={focus:()=>{var e;(e=O.value)===null||e===void 0||e.focus()},blur:()=>{var e;(e=O.value)===null||e===void 0||e.blur()},getCheckedData:()=>{if(Fe.value){const e=H.value;return{keys:e,options:ue(e)}}return{keys:[],options:[]}},getIndeterminateData:()=>{if(Fe.value){const e=ie.value;return{keys:e,options:ue(e)}}return{keys:[],options:[]}}},Ve=m(()=>{const{self:{optionArrowColor:e,optionTextColor:n,optionTextColorActive:r,optionTextColorDisabled:c,optionCheckMarkColor:i,menuColor:y,menuBoxShadow:s,menuDividerColor:w,menuBorderRadius:f,menuHeight:le,optionColorHover:de,optionHeight:ft,optionFontSize:ht,loadingColor:vt,columnWidth:mt},common:{cubicBezierEaseInOut:gt}}=k.value;return{"--n-bezier":gt,"--n-menu-border-radius":f,"--n-menu-box-shadow":s,"--n-menu-height":le,"--n-column-width":mt,"--n-menu-color":y,"--n-menu-divider-color":w,"--n-option-height":ft,"--n-option-font-size":ht,"--n-option-text-color":n,"--n-option-text-color-disabled":c,"--n-option-text-color-active":r,"--n-option-color-hover":de,"--n-option-check-mark-color":i,"--n-option-arrow-color":e,"--n-menu-mask-color":_t(y,{alpha:.75}),"--n-loading-color":vt}}),ae=p?Kt("cascader",void 0,Ve,t):void 0;return Object.assign(Object.assign({},ct),{handleTriggerResize:dt,mergedStatus:M,selectMenuFollowerRef:te,cascaderMenuFollowerRef:ne,triggerInstRef:O,selectMenuInstRef:_,cascaderMenuInstRef:g,mergedBordered:o,mergedClsPrefix:l,namespace:h,mergedValue:R,mergedShow:C,showSelectMenu:$,pattern:z,treeMate:P,mergedSize:J,mergedDisabled:Z,localizedPlaceholder:Te,selectedOption:W,selectedOptions:T,adjustedTo:V,menuModel:Me,handleMenuTabout:rt,handleMenuFocus:ot,handleMenuBlur:at,handleMenuKeydown:Ye,handleMenuMousedown:lt,handleTriggerFocus:tt,handleTriggerBlur:nt,handleTriggerClick:it,handleClear:et,handleDeleteOption:ut,handlePatternInput:st,handleKeydown:Be,focused:u,optionHeight:j,mergedTheme:k,cssVars:p?void 0:Ve,themeClass:ae?.themeClass,onRender:ae?.onRender})},render(){const{mergedClsPrefix:t}=this;return d("div",{class:`${t}-cascader`},d(Yt,null,{default:()=>[d(en,null,{default:()=>d(Tt,{onResize:this.handleTriggerResize,ref:"triggerInstRef",status:this.mergedStatus,clsPrefix:t,maxTagCount:this.maxTagCount,bordered:this.mergedBordered,size:this.mergedSize,theme:this.mergedTheme.peers.InternalSelection,themeOverrides:this.mergedTheme.peerOverrides.InternalSelection,active:this.mergedShow,pattern:this.pattern,placeholder:this.localizedPlaceholder,selectedOption:this.selectedOption,selectedOptions:this.selectedOptions,multiple:this.multiple,filterable:this.filterable,clearable:this.clearable,disabled:this.mergedDisabled,focused:this.focused,onFocus:this.handleTriggerFocus,onBlur:this.handleTriggerBlur,onClick:this.handleTriggerClick,onClear:this.handleClear,onDeleteOption:this.handleDeleteOption,onPatternInput:this.handlePatternInput,onKeydown:this.handleKeydown},{arrow:()=>{var a,o;return(o=(a=this.$slots).arrow)===null||o===void 0?void 0:o.call(a)}})}),d(Ue,{key:"cascaderMenu",ref:"cascaderMenuFollowerRef",show:this.mergedShow&&!this.showSelectMenu,containerClass:this.namespace,placement:this.placement,width:this.options.length?void 0:"target",teleportDisabled:this.adjustedTo===Ce.tdkey,to:this.adjustedTo},{default:()=>{var a;(a=this.onRender)===null||a===void 0||a.call(this);const{menuProps:o}=this;return d(un,Object.assign({},o,{ref:"cascaderMenuInstRef",class:[this.themeClass,o?.class],value:this.mergedValue,show:this.mergedShow&&!this.showSelectMenu,menuModel:this.menuModel,style:[this.cssVars,o?.style],onFocus:this.handleMenuFocus,onBlur:this.handleMenuBlur,onKeydown:this.handleMenuKeydown,onMousedown:this.handleMenuMousedown,onTabout:this.handleMenuTabout}),{action:()=>{var l,h;return(h=(l=this.$slots).action)===null||h===void 0?void 0:h.call(l)},empty:()=>{var l,h;return(h=(l=this.$slots).empty)===null||h===void 0?void 0:h.call(l)}})}}),d(Ue,{key:"selectMenu",ref:"selectMenuFollowerRef",show:this.mergedShow&&this.showSelectMenu,containerClass:this.namespace,width:"target",placement:this.placement,to:this.adjustedTo,teleportDisabled:this.adjustedTo===Ce.tdkey},{default:()=>{var a;(a=this.onRender)===null||a===void 0||a.call(this);const{filterMenuProps:o}=this;return d(dn,Object.assign({},o,{ref:"selectMenuInstRef",class:[this.themeClass,o?.class],value:this.mergedValue,show:this.mergedShow&&this.showSelectMenu,pattern:this.pattern,multiple:this.multiple,tmNodes:this.treeMate.treeNodes,filter:this.filter,labelField:this.labelField,separator:this.separator,style:[this.cssVars,o?.style]}))}})]}))}});export{On as N};
