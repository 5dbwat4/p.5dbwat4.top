import{useRoute as D,useRouter as N}from"./vue-router-3740985a.js";import{q as O}from"./define_basic_qtypes-ddf25d69.js";import{A as H}from"./APIHelper-5dc80534.js";import{aZ as g,a8 as r,l as i,t as m,aE as y,s as a,b7 as s,m as d,F as z,ae as F,bd as _,bc as w,k as u}from"./runtime-core.esm-bundler-c066f4bf.js";import{a as h}from"./Button-d0cd9be2.js";import"./light-d6058c0b.js";import"./format-length-c9d165c6.js";import"./Icon-d321f943.js";import"./Warning-3558c7da.js";import"./Close-ebf3a9fb.js";import"./Scrollbar-24cda971.js";import"./runtime-dom.esm-bundler-caa8590e.js";import"./use-memo-b9add725.js";import"./FadeInExpandTransition-ff940b4d.js";function E(f,o){const c=document.createElement("div");return f=f.replaceAll("【题文】",""),c.innerHTML=f,c.querySelectorAll("img").forEach(t=>{if(t.src.includes("/formula/")&&(t.src=t.src.replace(".png",".svg"),t.style.width=t.width*.8+"px",t.setAttribute("width",t.width*.8),t.setAttribute("height","")),t.src.includes("/dksih/")){let p=/\?resizew=(\d*)/.exec(t.src);p&&p.length!=0&&(t.style.width=p[1]+"px",t.src=t.src.replace(/\?resizew=(\d*)/,""),t.setAttribute("width",p[1]),t.setAttribute("height","")),t.setAttribute("data-pictid",o.tindex)}}),c.querySelectorAll("p").forEach(t=>{t.style.fontFamily||(t.style.fontFamily="Times New Roman , 宋体"),t.style.fontSize||(t.style.fontSize="9.5pt"),t.style.margin="0px"}),c.querySelectorAll("table[name=optionsTable]").forEach(t=>{if(t.querySelectorAll("td").length==4){let p=[];t.querySelectorAll("td").forEach(x=>{p.push(x.outerHTML)});const{ctn:v,next_lns:q}=V(p,4);t.innerHTML=v}}),c.querySelectorAll("table[name=optionsTable] td").forEach(t=>{t.innerHTML="<span style='width:fit-content;display:block;'>"+t.innerHTML+"</span>",t.style.fontFamily||(t.style.fontFamily="Times New Roman , 宋体"),t.style.fontSize||(t.style.fontSize="9.5pt"),t.style.margin="0px"}),c.style.fontFamily="Times New Roman , 宋体",o.includeti&&(console.log("rrr"),c.insertAdjacentHTML("afterbegin",`<strong>${o.tindex}. </strong>`)),o.gtittype==3&&c.insertAdjacentHTML("afterbegin",`<strong>${o.tindex}.</strong> (${o.ootInfo[0]},${o.ootInfo[1]}) `),o.gtittype==4&&c.insertAdjacentHTML("afterbegin",`<strong>${o.tindex}.</strong> `),c.outerHTML}function V(f,o){if(o==1)return{ctn:"<tbody><tr>"+f.join("")+"</tr></tbody>",next_lns:2};if(o==2)return{ctn:`<tbody><tr>${f[0]}${f[1]}</tr><tr>${f[2]}${f[3]}</tr></tbody>`,next_lns:4};if(o==4)return{ctn:"<tbody><tr>"+f.join("</tr><tr>")+"</tr></tbody>",next_lns:1}}const G={style:{width:"18.76cm","line-height":"normal"},id:"oonom"},J={class:"noprint"},Q={class:"labi-container"},W={key:0,style:{"font-size":"6.5pt","font-family":"Cambria , 仿宋",margin:"0px"}},Z={key:1,style:{"text-align":"center","font-family":"Cambria , 仿宋",margin:"0px"}},K={style:{"font-size":"10pt"}},X={style:{"font-size":"6.5pt"}},Y={style:{"font-family":"'courier new'"}},tt={key:2,style:{"text-align":"center","font-family":"黑体",margin:"0px"}},et={style:{"font-size":"10pt"}},nt=["onClick","data_type","data_id"],rt={key:0,style:{"font-size":"6.5pt",margin:"0px","font-family":"Cambria , 仿宋"}},it={style:{"font-family":"'courier new'"}},lt={style:{"font-family":"'courier new'"}},ot={key:0},st={key:1},at=["innerHTML"],ut={key:2},dt=["innerHTML"],ct={key:3},pt=["innerHTML"],ft={key:5},mt=["src"],yt={key:6},_t=["src"],Ht={__name:"preexport-1",setup(f){const o=D(),c=N(),t=g({q:!0,a:!1,p:!1}),p=g(0),v=g(0),q=3,x=3,C=g(""),k=g({}),A=g(!1);H.post("/api/group/get",{id:o.params.id}).then(l=>{l.entry.split(",").forEach(e=>{k.value[e]=O}),C.value=l.title,Promise.all(l.entry.split(",").map(e=>new Promise((n,b)=>{H.get("/api/qapi/get/"+e).then(T=>{k.value[e]=T})}))).then(()=>{})});const $=l=>JSON.parse(l),I=l=>Object.entries(l).map(e=>e[1]),M=g(l=>{}),j=l=>{k.value[l]._extb_height=(k.value[l]._extb_height||0)+50,console.log(k.value[l]._extb_height)},S=g(1),R=()=>{localStorage.setItem("___thost___html_export",document.getElementById("corehtml").outerHTML),c.push("/grouping/preexport-2/"+o.params.id)},L=g("Cambria , 宋体"),B=()=>{L.value="Times New Roman , 宋体!important"},U=()=>{document.querySelectorAll("table[name=optionsTable]").forEach(e=>{if(e.querySelectorAll("td").length==4){console.log("oo",e);let n=[],b=1;e.querySelectorAll("td").forEach(T=>{n.push(T.outerHTML)}),e.addEventListener("click",()=>{console.log("click");const{ctn:T,next_lns:P}=l(n,b);e.innerHTML=T,b=P})}});function l(e,n){if(n==1)return{ctn:"<tbody><tr>"+e.join("")+"</tr></tbody>",next_lns:2};if(n==2)return{ctn:`<tbody><tr>${e[0]}${e[1]}</tr><tr>${e[2]}${e[3]}</tr></tbody>`,next_lns:4};if(n==4)return{ctn:"<tbody><tr>"+e.join("</tr><tr>")+"</tr></tbody>",next_lns:1}}};return(l,e)=>(r(),i(z,null,[m(s(h),{class:"noprint",onClick:e[0]||(e[0]=n=>t.value.q=!t.value.q)},{default:y(()=>[a("Q")]),_:1}),m(s(h),{class:"noprint",onClick:e[1]||(e[1]=n=>t.value.a=!t.value.a)},{default:y(()=>[a("A")]),_:1}),m(s(h),{class:"noprint",onClick:e[2]||(e[2]=n=>t.value.p=!t.value.p)},{default:y(()=>[a("P")]),_:1}),m(s(h),{class:"noprint",onClick:e[3]||(e[3]=n=>M.value=j)},{default:y(()=>[a("单击题面时增加空格")]),_:1}),m(s(h),{class:"noprint",onClick:B},{default:y(()=>[a("字体转为Times")]),_:1}),m(s(h),{class:"noprint",onClick:e[4]||(e[4]=n=>S.value==2?S.value=1:S.value=2)},{default:y(()=>[a("改变列数 ")]),_:1}),m(s(h),{class:"noprint",onClick:e[5]||(e[5]=n=>{M.value=()=>{},U()})},{default:y(()=>[a("修正opttable")]),_:1}),m(s(h),{class:"noprint",onClick:e[6]||(e[6]=n=>A.value=!0)},{default:y(()=>[a("Retheme 2")]),_:1}),m(s(h),{class:"noprint",onClick:e[7]||(e[7]=n=>p.value++)},{default:y(()=>[a("Title format")]),_:1}),m(s(h),{class:"noprint",onClick:e[8]||(e[8]=n=>v.value++)},{default:y(()=>[a("Info format")]),_:1}),m(s(h),{class:"noprint",onClick:e[9]||(e[9]=n=>R())},{default:y(()=>[a("进入不包含fixed content的修正页面")]),_:1}),d("div",G,[d("div",J,[d("div",Q,[(r(),i(z,null,F([1,2,3,4,5,6,7],n=>d("div",{class:"labi-block",key:n,style:{height:"1045px"}},"Page # "+_(n),1)),64))])]),d("div",{id:"corehtml",style:w({width:"18.95cm",columns:S.value,"line-height":"normal"})},[p.value%q==0?(r(),i("p",W," Generated by thost | Group UUID: "+_(l.$route.params.id)+" | Title: "+_(C.value),1)):u("",!0),p.value%q==1?(r(),i("div",Z,[d("p",K,_(C.value),1),d("p",X,[a("Generated by thost | UUID: "),d("span",Y,_(l.$route.params.id),1)])])):u("",!0),p.value%q==2?(r(),i("div",tt,[d("p",et,_(C.value),1)])):u("",!0),(r(!0),i(z,null,F(I(k.value),(n,b)=>(r(),i("div",{key:n.id,onClick:T=>M.value(n.id),data_type:$(n.extra).info[0],class:"___core_block",data_id:b},[v.value%x==0?(r(),i("p",rt,[a(" UUID:"),d("span",it,_(n.id),1),a(" | qid:"),d("span",lt,_(n.qid),1),a(),t.value.q?(r(),i("span",ot,"| "+_($(n.extra).info[0])+" | "+_($(n.extra).info[1])+" | Origin: "+_($(n.extra).from),1)):u("",!0)])):u("",!0),v.value%x==0?(r(),i("div",st,[t.value.q?(r(),i("div",{key:0,innerHTML:s(E)(n.q,{ret2:A.value,tindex:b+1,includeti:!0}),style:w({fontSize:"9.5pt",fontFamily:L.value})},null,12,at)):u("",!0)])):u("",!0),v.value%x==1?(r(),i("div",ut,[t.value.q?(r(),i("div",{key:0,innerHTML:s(E)(n.q,{ret2:A.value,tindex:b+1,gtittype:3,ootInfo:$(n.extra).info}),style:w({fontSize:"9.5pt",fontFamily:L.value})},null,12,dt)):u("",!0)])):u("",!0),v.value%x==2?(r(),i("div",ct,[t.value.q?(r(),i("div",{key:0,innerHTML:s(E)(n.q,{ret2:A.value,tindex:b+1,gtittype:4}),style:w({fontSize:"9.5pt",fontFamily:L.value})},null,12,pt)):u("",!0)])):u("",!0),t.value.q?(r(),i("div",{key:4,style:w({display:"block",height:(n._extb_height||0)+"px"}),class:"extblank"},null,4)):u("",!0),t.value.a?(r(),i("div",ft,[d("img",{src:s(H).host+"/oss-storage/"+n.a.replace("<answerparser>","").replace("</answerparser>","").split("|")[0]+".png"},null,8,mt)])):u("",!0),t.value.p?(r(),i("div",yt,[d("img",{src:s(H).host+"/oss-storage/"+n.a.replace("<answerparser>","").replace("</answerparser>","").split("|")[1]+".png"},null,8,_t)])):u("",!0)],8,nt))),128))],4)])],64))}};export{Ht as default};
