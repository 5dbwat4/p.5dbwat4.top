import{useRoute as T,useRouter as G}from"./vue-router-3740985a.js";import{n as U}from"./nomorlize_q-589fa2c5.js";import{q as j}from"./define_basic_qtypes-ddf25d69.js";import{A as p}from"./APIHelper-c9b99a18.js";import{s as B}from"./sweetalert.min-9dab74b7.js";import{N as E}from"./Checkbox-45e1205f.js";import{N,a as F}from"./Image-171fe8dd.js";import{aZ as c,a8 as u,l as m,t as i,aE as s,s as o,b7 as r,m as l,bd as f,F as C,ae as V,k as v,bc as L}from"./runtime-core.esm-bundler-c066f4bf.js";import{a as _}from"./Button-68cb5d7d.js";import{N as D}from"./Spin-ff5dfbad.js";import{N as H}from"./p-d7e0cfbf.js";import"./light-5802f424.js";import"./format-length-c9d165c6.js";import"./Icon-fde79c06.js";import"./Warning-459cf3e9.js";import"./Close-10bb4ae3.js";import"./Scrollbar-068db0c3.js";import"./runtime-dom.esm-bundler-caa8590e.js";import"./_commonjsHelpers-725317a4.js";import"./use-merged-state-89f8109f.js";import"./FadeInExpandTransition-ff940b4d.js";import"./use-memo-b9add725.js";import"./fade-in-scale-up.cssr-e615339f.js";import"./flatten-a133123b.js";import"./use-false-until-truthy-a506b738.js";import"./Tooltip-bcde8d3a.js";import"./Popover-df9fe6bd.js";import"./get-aeafa5fe.js";import"./utils-d7fa52af.js";import"./use-compitable-42538ef7.js";import"./next-frame-once-7035a838.js";import"./use-locale-5324fa07.js";import"./index-975a2d8f.js";import"./light-111bcf27.js";const J={style:{width:"18.76cm","line-height":"normal"},id:"oonom"},M=l("div",{class:"noprint"},null,-1),R={id:"corehtml",style:{width:"18.76cm",columns:1,"line-height":"normal"}},K={style:{"font-size":"9.5pt","font-family":"Cambria , fangsong",margin:"0px"}},Q={style:{"font-size":"9.5pt",margin:"0px","font-family":"Cambria , 仿宋"}},W={style:{"font-family":"'courier new'"}},X={style:{"font-family":"'courier new'"}},Z={key:0},Y=["innerHTML"],ee={key:2},te=["src"],ae={key:3},re=["src"],ie={key:4},oe=l("div",null,null,-1),Fe={__name:"index",setup(se){const y=T(),k=G(),n=c({q:!0,a:!1,p:!1}),I=c(!1),b=c(""),h=c({});p.post("/api/group/get",{id:y.params.id}).then(a=>{a.entry.split(",").forEach(e=>{h.value[e]=j}),a.entry.split(","),b.value=a.title,Promise.all(a.entry.split(",").map(e=>new Promise((t,P)=>{p.get("/api/qapi/get/"+e).then(S=>{h.value[e]=S}),$(e)}))).then(()=>{})});const w=a=>JSON.parse(a),x=c({}),A=a=>Object.entries(a).map(e=>e[1]),q=async a=>{console.log(a),await p.post("/api/qapi/doneinfo/mark",{quuid:a.id,timestamp:new Date().getTime(),displayednote:"",note:"",rate:50,bankid:a.bankid})},z=async()=>{Promise.all(Object.entries(h.value).map(a=>q(a[1]))).then(a=>{B("ok.")})},$=async a=>{x.value[a]=await p.get("/api/qapi/doneinfo/getbyquuid/"+a)},d=c(!1),g=c({}),O=a=>{console.log(a),d.value=a,d.value&&Object.entries(h.value).forEach(e=>{console.log(e),p.get("/api/xkw-helper/get_more_detail/600/"+e[1].bankid+"/"+e[1].qid).then(t=>{g.value[e[1].id]={a:p.host+"/api/xkw-helper/route-pic?purl="+btoa(t.data.answerImg.replace("@2","@3").replace("c2","c1")),p:p.host+"/api/xkw-helper/route-pic?purl="+btoa(t.data.parseImg.replace("@2","@3").replace("c2","c1"))}})})};return(a,e)=>(u(),m(C,null,[i(r(_),{class:"noprint",onClick:e[0]||(e[0]=t=>n.value.q=!n.value.q)},{default:s(()=>[o("Q")]),_:1}),i(r(_),{class:"noprint",onClick:e[1]||(e[1]=t=>n.value.a=!n.value.a)},{default:s(()=>[o("A")]),_:1}),i(r(_),{class:"noprint",onClick:e[2]||(e[2]=t=>n.value.p=!n.value.p)},{default:s(()=>[o("P")]),_:1}),i(r(_),{onClick:e[3]||(e[3]=t=>r(k).push("/grouping/preexport-1/"+r(y).params.id))},{default:s(()=>[o("开始准备打印")]),_:1}),i(r(_),{onClick:e[4]||(e[4]=t=>r(k).push("/export/"+r(y).params.id+"/a"))},{default:s(()=>[o("打印答案")]),_:1}),i(r(_),{onClick:z},{default:s(()=>[o("将本group内所有试题标记为done")]),_:1}),i(r(E),{checked:d.value,"onUpdate:checked":[e[5]||(e[5]=t=>d.value=t),O]},{default:s(()=>[o(" 直接从组卷网获取答案解析数据而非从oss缓存 ")]),_:1},8,["checked"]),l("div",J,[M,o(),i(r(F),null,{default:s(()=>[l("div",R,[l("p",K,"Generated by thost | Group UUID: "+f(a.$route.params.id)+" | Title: "+f(b.value),1),(u(!0),m(C,null,V(A(h.value),t=>(u(),m("div",{key:t.id},[l("p",Q,[o("UUID:"),l("span",W,f(t.id),1),o(" | qid:"),l("span",X,f(t.qid),1),o(),n.value.q?(u(),m("span",Z,"| Info: "+f(w(t.extra).info)+" | Origin: "+f(w(t.extra).from),1)):v("",!0)]),n.value.q?(u(),m("div",{key:0,innerHTML:r(U)(t.q,{ret2:I.value}),style:{fontSize:"12pt",fontFamily:"Cambria"}},null,8,Y)):v("",!0),n.value.q?(u(),m("div",{key:1,style:L({display:"block",height:(t._extb_height||0)+"px"})},null,4)):v("",!0),n.value.a&&!d.value?(u(),m("div",ee,[l("img",{src:r(p).host+"/oss-storage/"+t.a.replace("<answerparser>","").replace("</answerparser>","").split("|")[0]+".png"},null,8,te)])):v("",!0),n.value.p&&!d.value?(u(),m("div",ae,[l("img",{src:r(p).host+"/oss-storage/"+t.a.replace("<answerparser>","").replace("</answerparser>","").split("|")[1]+".png"},null,8,re)])):v("",!0),d.value?(u(),m("div",ie,[i(r(N),{lazy:"",src:(g.value[t.id]||{a:""}).a},{placeholder:s(()=>[i(r(D))]),_:2},1032,["src"]),i(r(N),{lazy:"",src:(g.value[t.id]||{p:""}).p},{placeholder:s(()=>[i(r(D))]),_:2},1032,["src"]),oe])):v("",!0),i(r(_),{text:"",onClick:P=>q(t)},{default:s(()=>[o("标记为已完成")]),_:2},1032,["onClick"]),i(r(H),null,{default:s(()=>[o("完成状态："+f(x.value[t.id]),1)]),_:2},1024)]))),128))])]),_:1})])],64))}};export{Fe as default};
