import{H as j,j as D}from"./json-8bda58bf.js";import{onBeforeRouteLeave as L}from"./vue-router-ee92e3b2.js";import{A as r}from"./APIHelper-c6c5541a.js";import{N as U}from"./Code-1be90b8c.js";import{N as $}from"./ConfigProvider-d7f93fa6.js";import{aZ as n,a8 as p,l as d,t as u,aE as s,b7 as t,F as x,m as f,s as v,k as h,j as B}from"./index-c2ed52a5.js";import{N as m}from"./Button-591cb8c7.js";import{N as w}from"./Input-b50999c9.js";import{N as E}from"./Spin-89bf8d7a.js";import"./_commonjsHelpers-de833af9.js";import"./light-3c431b54.js";import"./format-length-c9d165c6.js";import"./Icon-9d083982.js";import"./Warning-fc401418.js";import"./Close-4e65a8ab.js";import"./Scrollbar-5b7370f2.js";import"./runtime-dom.esm-bundler-51aad541.js";import"./keysOf-5d5107c5.js";import"./use-memo-13475312.js";import"./Loading-b36f50c8.js";import"./use-is-mounted-912be460.js";import"./FadeInExpandTransition-3bfdffc9.js";import"./use-locale-ca0d0990.js";import"./index-975a2d8f.js";import"./use-merged-state-5c1c3246.js";import"./light-951b0264.js";import"./Suffix-26bafbe6.js";import"./use-compitable-c3112252.js";const F={key:0},G=f("span",null,"\u6B63\u5728\u67E5\u8BE2Syncbatch\u72B6\u6001",-1),H=[G],I={key:1},J=f("span",null,"\u5C1A\u672A\u5F00\u59CBSyncbatch",-1),O={key:2},P=f("span",null,"\u5DF2\u7ECF\u5F00\u59CBSyncbatch",-1),R={key:0},V=f("div",null,null,-1),Z={__name:"syncbatch",setup(q){j.registerLanguage("json",D);const a=n(0),l=n({started:!1,currentids:[],title:""}),i=n("");r.get("/api/syncbatch/sync-session").then(e=>{l.value=e.data,a.value=1,l.value.started&&(i.value=l.value.title,y())});const C=()=>{a.value=2,r.post("/api/syncbatch/start-session",{title:i.value,time:new Date().getTime()}).then(e=>{l.value=e.data,a.value=1,y()})};let k=!0;L(()=>{k=!1});const y=()=>{a.value=2,r.get("/api/syncbatch/sync-session").then(e=>{l.value=e.data,a.value=1,k&&setTimeout(y,1500)})},N=()=>{a.value=2,r.post("/api/syncbatch/edit-title",{title:i.value}).then(e=>{l.value=e.data,a.value=1})},S=()=>{a.value=2,r.get("/api/syncbatch/kill-session").then(e=>{a.value=1})},b=n(!1),g=n(!1),_=n(""),T=()=>{b.value=!0,r.post("/api/group/new",{entry:l.value.currentids.join(","),timestamp:new Date().getTime(),title:l.value.title,desc:""}).then(e=>{b.value=!1,g.value=!0,_.value=e.id})},A=e=>JSON.stringify(e,void 0,4);return(e,o)=>(p(),d(x,null,[u(t(m),{onClick:o[0]||(o[0]=c=>e.$router.push("/batching/from-basket"))},{default:s(()=>[v("\u4ECE\u8BD5\u9898\u7BEE")]),_:1}),u(t($),{hljs:t(j)},{default:s(()=>[a.value==0?(p(),d("div",F,H)):h("",!0),a.value==1&&!l.value.started?(p(),d("div",I,[J,u(t(w),{value:i.value,"onUpdate:value":o[1]||(o[1]=c=>i.value=c)},null,8,["value"]),u(t(m),{onClick:C},{default:s(()=>[v("\u73B0\u5728\u5F00\u59CB")]),_:1})])):h("",!0),l.value.started?(p(),d("div",O,[P,a.value==2?(p(),d("span",R,"\u6B63\u5728\u53D1\u9001API\u8BF7\u6C42")):h("",!0),u(t(E),{show:a.value==2},{default:s(()=>[u(t(U),{code:A(l.value)},null,8,["code"])]),_:1},8,["show"]),u(t(w),{value:i.value,"onUpdate:value":o[2]||(o[2]=c=>i.value=c)},null,8,["value"]),u(t(m),{onClick:N},{default:s(()=>[v("\u4FEE\u6539Title")]),_:1}),u(t(m),{onClick:T},{default:s(()=>[v("\u4FDD\u5B58\u4E3AGroup")]),_:1}),u(t(m),{onClick:S},{default:s(()=>[v("\u7EC8\u6B62")]),_:1}),g.value?(p(),B(t(m),{key:1,onClick:o[3]||(o[3]=c=>e.$router.push("/group/"+_.value))},{default:s(()=>[v("View")]),_:1})):h("",!0)])):h("",!0)]),_:1},8,["hljs"]),V],64))}};export{Z as default};
