import{A as _}from"./APIHelper-89899791.js";import{b2 as s,ab as n,m as f,k as h,aH as u,bc as i,l as k,F as w,n as r,u as p,t as d,ah as b,bi as C}from"./index-6b27469d.js";import{N as A}from"./Input-c49f615f.js";import{N as o}from"./Button-a421b774.js";import{N as g}from"./Card-b4e38b92.js";import"./light-cb8e5d18.js";import"./format-length-c9d165c6.js";import"./Icon-0741e3aa.js";import"./Warning-ad995842.js";import"./Close-df27b242.js";import"./Scrollbar-6ef5ad24.js";import"./runtime-dom.esm-bundler-4f377a37.js";import"./keysOf-5d5107c5.js";import"./use-memo-7138c88c.js";import"./use-locale-13d55c5c.js";import"./index-975a2d8f.js";import"./use-merged-state-236ae148.js";import"./Loading-a27cceda.js";import"./use-is-mounted-e356ec1d.js";import"./light-5edeff63.js";import"./Suffix-8898b6d6.js";import"./FadeInExpandTransition-65435983.js";const j=["innerHTML"],G=["innerHTML"],q={key:0},I=["src"],O=["innerHTML"],z=r("div",null,null,-1),F={__name:"index",setup(V){const x=s(""),v=s(1),a=s([]),y=s(""),H=s({}),N=s({}),L=e=>{if(e.key=="Enter"){let t=window.getSelection().toString();a.value.push(t)}},T=()=>{v.value=2,document.addEventListener("keypress",L)},E=async()=>{v.value=31,a.value,a.value=a.value.map(e=>({met:e,list:[],tdp:{}}));for(let e=0;e<a.value.length;e++)await _.get("/api/xkw-helper/qsearch/"+y.value+"/"+a.value[e].met.slice(0,40)).then(t=>{a.value[e].list=t.data.list,a.value[e].index=0,a.value[e].tdp=a.value[e].list[a.value[e].index],t.data.list.forEach((l,c)=>{c<6&&U(y.value,l.id)})})},m=s(0),M=async()=>{v.value=32,a.value,a.value=a.value.map(e=>({met:e,list:[],tdp:{}}));for(let e=0;e<a.value.length;e++)a.value[e].display=!1;a.value[0].display=!0},U=async(e,t)=>{await _.get("/api/qapi/is_collected/"+e+"/"+t).then(l=>{H.value[t]=JSON.stringify(l)})},R=async e=>{N.value[e]=!0,await _.get("/api/data/add/"+y.value+"/"+e)},S=()=>{_.post("/api/regen-attach/state-update/contentupd",a.value.map(e=>encodeURIComponent(e.met.replaceAll(`\r
`," ").replaceAll(/[ \t]/g," ").slice(0,100)))).then(e=>{location.href=_.host+"/api/regen-attach/router/begin"})};return(e,t)=>(n(),f(w,null,[v.value==1?(n(),h(i(g),{key:0},{default:u(()=>[p(i(A),{value:x.value,"onUpdate:value":t[0]||(t[0]=l=>x.value=l),type:"textarea"},null,8,["value"]),p(i(A),{value:y.value,"onUpdate:value":t[1]||(t[1]=l=>y.value=l)},null,8,["value"]),p(i(o),{onClick:T},{default:u(()=>[d("RUN")]),_:1})]),_:1})):k("",!0),v.value==2?(n(),h(i(g),{key:1},{default:u(()=>[r("div",{innerHTML:a.value.join("<br/>")},null,8,j),r("div",{innerHTML:x.value.replaceAll(`
`,"<br/>")},null,8,G),p(i(o),{onClick:E},{default:u(()=>[d("RUN")]),_:1}),p(i(o),{onClick:M},{default:u(()=>[d("RUN using ifr")]),_:1})]),_:1})):k("",!0),v.value==32?(n(),h(i(g),{key:2},{default:u(()=>[p(i(o),{onClick:S},{default:u(()=>[d("GOTO zujuan.xkw.com")]),_:1})]),_:1})):k("",!0),v.value==32?(n(),h(i(g),{key:3},{default:u(()=>[(n(!0),f(w,null,b(a.value,l=>(n(),f("div",{key:l.key},[l.display?(n(),f("div",q,[r("p",null,C(l.met),1),r("iframe",{src:"https://zujuan.xkw.com/quessearch/?keyword="+l.met},null,8,I),p(i(o),{onClick:t[2]||(t[2]=c=>{a.value[m.value].display=!1,m.value++,a.value[m.value].display=!0})},{default:u(()=>[d("< next")]),_:1}),p(i(o),{onClick:t[3]||(t[3]=c=>{a.value[m.value].display=!1,m.value--,a.value[m.value].display=!0})},{default:u(()=>[d("prev >")]),_:1})])):k("",!0)]))),128))]),_:1})):k("",!0),v.value==31?(n(),h(i(g),{key:4},{default:u(()=>[(n(!0),f(w,null,b(a.value,l=>(n(),f("div",{key:l.met},[r("p",null,C(l.met),1),r("div",{innerHTML:l.tdp.body},null,8,O),r("p",null,"QID:"+C(l.tdp.id)+" || "+C(H.value[l.tdp.id]),1),p(i(o),{onClick:c=>R(l.tdp.id),loading:N.value[l.tdp.id]},{default:u(()=>[d("SAVE")]),_:2},1032,["onClick","loading"]),p(i(o),{onClick:c=>l.tdp=l.list[--l.index]},{default:u(()=>[d("< CHANGE")]),_:2},1032,["onClick"]),p(i(o),{onClick:c=>l.tdp=l.list[++l.index]},{default:u(()=>[d("CHANGE >")]),_:2},1032,["onClick"])]))),128))]),_:1})):k("",!0),z],64))}};export{F as default};
