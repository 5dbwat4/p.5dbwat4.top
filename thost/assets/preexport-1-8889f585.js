import{useRoute as I,useRouter as R}from"./vue-router-ee92e3b2.js";import{q as N}from"./define_basic_qtypes-5cc5565b.js";import{A as S}from"./APIHelper-c6c5541a.js";import{H as P,a as B,b as O,_ as Z,c as D,d as G}from"./block-theme-2-5a205dfb.js";import{_ as J}from"./_plugin-vue_export-helper-c27b6911.js";import{aZ as s,a8 as o,l as f,t as h,aE as b,b7 as d,m as g,F as z,ae as L,bc as M,j as m,k as c,s as v,bd as K}from"./index-c2ed52a5.js";import{N as _}from"./Button-591cb8c7.js";import"./light-3c431b54.js";import"./format-length-c9d165c6.js";import"./Icon-9d083982.js";import"./Warning-fc401418.js";import"./Close-4e65a8ab.js";import"./Scrollbar-5b7370f2.js";import"./runtime-dom.esm-bundler-51aad541.js";import"./keysOf-5d5107c5.js";import"./Loading-b36f50c8.js";import"./use-is-mounted-912be460.js";import"./use-memo-13475312.js";import"./FadeInExpandTransition-3bfdffc9.js";function F(r,e){const n=document.createElement("div");return r=r.replaceAll("\u3010\u9898\u6587\u3011",""),n.innerHTML=r,n.querySelectorAll("img").forEach(t=>{if(t.src.includes("/formula/")&&(t.src=t.src.replace(".png",".svg"),t.style.width=t.width*.8+"px",t.setAttribute("width",t.width*.8),t.setAttribute("height","")),t.src.includes("/dksih/")){let i=/\?resizew=(\d*)/.exec(t.src);i&&i.length!=0&&(t.style.width=i[1]+"px",t.src=t.src.replace(/\?resizew=(\d*)/,""),t.setAttribute("width",i[1]),t.setAttribute("height","")),t.setAttribute("data-pictid",e.tindex)}}),n.querySelectorAll("p").forEach(t=>{t.style.fontFamily||(t.style.fontFamily="Times New Roman , \u5B8B\u4F53"),t.style.fontSize||(t.style.fontSize="9.5pt"),t.style.margin="0px"}),n.querySelectorAll("table[name=optionsTable]").forEach(t=>{if(t.querySelectorAll("td").length==4){let i=[];t.querySelectorAll("td").forEach(T=>{i.push(T.outerHTML)});const{ctn:p,next_lns:x}=Q(i,4);t.innerHTML=p}}),n.querySelectorAll("table[name=optionsTable] td").forEach(t=>{t.innerHTML="<span style='width:fit-content;display:block;'>"+t.innerHTML+"</span>",t.style.fontFamily||(t.style.fontFamily="Times New Roman , \u5B8B\u4F53"),t.style.fontSize||(t.style.fontSize="9.5pt"),t.style.margin="0px"}),n.style.fontFamily="Times New Roman , \u5B8B\u4F53",e.includeti&&(console.log("rrr"),n.insertAdjacentHTML("afterbegin",`<strong>${e.tindex}. </strong>`)),e.gtittype==3&&n.insertAdjacentHTML("afterbegin",`<strong>${e.tindex}.</strong> (${e.ootInfo[0]},${e.ootInfo[1]}) `),e.gtittype==4&&n.insertAdjacentHTML("afterbegin",`<strong>${e.tindex}.</strong> `),n.outerHTML}function Q(r,e){if(e==1)return{ctn:"<tbody><tr>"+r.join("")+"</tr></tbody>",next_lns:2};if(e==2)return{ctn:`<tbody><tr>${r[0]}${r[1]}</tr><tr>${r[2]}${r[3]}</tr></tbody>`,next_lns:4};if(e==4)return{ctn:"<tbody><tr>"+r.join("</tr><tr>")+"</tr></tbody>",next_lns:1}}const U={style:{width:"18.76cm","line-height":"normal"},id:"oonom"},V={class:"noprint"},W={class:"labi-container"},X=["onClick","data_id"],Y={__name:"preexport-1",setup(r){const e=I(),n=R(),t=s(0),i=s(0),p=3,x=3,T=s({q:!0,a:!1,p:!1}),q=s(""),k=s({title:"",guid:e.params.id}),w=s({}),E=s(!1);S.get("/api/group/get/"+e.params.id).then(u=>{u.entry.split(",").forEach(a=>{w.value[a]=N}),k.value.title=q.value=u.title,Promise.all(u.entry.split(",").map(a=>new Promise((l,y)=>{S.get("/api/data/get/"+a).then(H=>{w.value[a]=H})}))).then(()=>{})});const $=u=>Object.entries(u).map(a=>a[1]),C=s(u=>{}),A=s(1),j=()=>{localStorage.setItem("___thost___html_export",document.getElementById("corehtml").outerHTML),n.push("/grouping/preexport-2/"+e.params.id)};return s("Cambria , \u5B8B\u4F53"),(u,a)=>(o(),f(z,null,[h(d(_),{class:"noprint",onClick:a[0]||(a[0]=l=>A.value==2?A.value=1:A.value=2)},{default:b(()=>[v("\u6539\u53D8\u5217\u6570 ")]),_:1}),h(d(_),{class:"noprint",onClick:a[1]||(a[1]=l=>E.value=!0)},{default:b(()=>[v("Retheme 2")]),_:1}),h(d(_),{class:"noprint",ref:"btn1",onClick:a[2]||(a[2]=l=>t.value++)},{default:b(()=>[v("Title format")]),_:1},512),h(d(_),{class:"noprint",ref:"btn2",onClick:a[3]||(a[3]=l=>i.value++)},{default:b(()=>[v("Info format")]),_:1},512),h(d(_),{class:"noprint",ref:"btn3",onClick:a[4]||(a[4]=l=>j())},{default:b(()=>[v("\u8FDB\u5165\u4E0D\u5305\u542Bfixed content\u7684\u4FEE\u6B63\u9875\u9762")]),_:1},512),g("div",U,[g("div",V,[g("div",W,[(o(),f(z,null,L([1,2,3,4,5,6,7],l=>g("div",{class:"labi-block",key:l,style:{height:"1045px"}}," Page # "+K(l),1)),64))])]),g("div",{id:"corehtml",style:M({width:"18.95cm",columns:A.value,"line-height":"normal"})},[t.value%p==0?(o(),m(P,{key:0,data:k.value},null,8,["data"])):c("",!0),t.value%p==1?(o(),m(B,{key:1,data:k.value},null,8,["data"])):c("",!0),t.value%p==2?(o(),m(O,{key:2,data:k.value},null,8,["data"])):c("",!0),(o(!0),f(z,null,L($(w.value),(l,y)=>(o(),f("div",{key:l.id,onClick:H=>C.value(l.id),class:"___core_block",data_id:y},[i.value%x==0?(o(),m(Z,{key:0,normalizeFun:d(F),data:l,index:y},null,8,["normalizeFun","data","index"])):c("",!0),i.value%x==1?(o(),m(D,{key:1,normalizeFun:d(F),data:l,index:y},null,8,["normalizeFun","data","index"])):c("",!0),i.value%x==2?(o(),m(G,{key:2,normalizeFun:d(F),data:l,index:y},null,8,["normalizeFun","data","index"])):c("",!0),T.value.q?(o(),f("div",{key:3,style:M({display:"block",height:(l._extb_height||0)+"px"}),class:"extblank"},null,4)):c("",!0)],8,X))),128))],4)])],64))}},tt=J(Y,[["__scopeId","data-v-96b025c5"]]);export{tt as default};
