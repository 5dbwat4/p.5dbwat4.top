{"version":3,"file":"list-2bb80d2a.js","sources":["../../src/views/grouping/list.vue"],"sourcesContent":["<template>\r\n    <n-input-group>\r\n<n-input placeholder=\"Search\" v-model:value=\"searchParams\" :loading=\"LoadingSearch\" :on-input=\"SearchUpdate\" clearable/>\r\n<n-select v-model:value=\"searchFrom\" :options=\"[\r\n    {label:'UUID',value:'UUID'},{label:'标题',value:'title'}\r\n    ]\" style=\"width:160px\" />\r\n<n-button @click=\"handleSearch\">     <template #icon><n-icon :component=\"SearchOutline\"/></template></n-button>\r\n<n-button @click=\"Refresh\">     <template #icon><n-icon :component=\"RefreshOutline\"/></template></n-button>\r\n</n-input-group>\r\n<n-data-table remote :loading=\"loadingData\" :pagination=\"paginationReactive\"\r\n:data=\"data\" :columns=\"columns\"\r\n    @update:checked-row-keys=\"handleCheck\" :row-key=\"(row)=>row.id\" visual-scroll/>\r\n</template>\r\n\r\n<script setup>\r\nimport { NButton, NDataTable,NInputGroup,NInput,NIcon,NTime,NSelect } from \"naive-ui\";\r\nimport { h, ref } from \"vue\";\r\nimport { API } from \"../../shared/APIHelper\"\r\nimport {useRoute,useRouter} from \"vue-router\"\r\nimport { SearchOutline,RefreshOutline } from \"@vicons/ionicons5\";\r\nimport subjectsmapFlattened from \"../../shared/base-zj-data/subjects-flattened-reversed.json\"\r\nconst route=useRoute(),router=useRouter()\r\n\r\nconst loadingData=ref(true),LoadingSearch=ref(false),searchParams=ref(\"\"),searchFrom=ref(\"UUID\")\r\nconst data=ref([])\r\n\r\nconst columns=[{\r\n    type:\"selection\"\r\n},{\r\n    title:\"uuid\",\r\n    key:\"id\"\r\n},{\r\n    title:\"title\",\r\n    key:\"title\"\r\n},{\r\n    title:\"Subjects\",\r\n    render(row){\r\n        return h(\"span\",{},subjectsmapFlattened[\"\"+row.bankid])\r\n    }\r\n},{\r\n    title:\"submit time\",\r\n    render(row){\r\n        return h(NTime,{\r\n            time:row.timestamp,\r\n            to:(new Date()).getTime(),\r\n            type:\"relative\"\r\n        })\r\n    }\r\n},{\r\n    title:\"view\",\r\n    render(row){\r\n        return h(NButton,{\r\n            text:true,\r\n            onClick:()=>{\r\n                router.push(\"/group/\"+row.id)\r\n            }\r\n        },{default:()=>\"View\"})\r\n    }\r\n}]\r\n\r\nconst checkedRowKeysRef=ref([])\r\nconst handleCheck=(rowKeys) =>{\r\n        checkedRowKeysRef.value = rowKeys;\r\n        console.log(rowKeys);\r\n      }\r\n\r\n      ,gotobatch=()=>{\r\n        router.push(\"/batch/\"+checkedRowKeysRef.value.join(\",\"))\r\n      }\r\n\r\n\r\n      const  paginationReactive = ref({\r\n      page: 1,\r\n      pageSize: 10,\r\n      showSizePicker: true,\r\n      itemCount:0,\r\n      pageSizes: [5,10,20,50],\r\n      onChange: (page) => {\r\n        paginationReactive.value.page = page\r\n        loadingData.value=true\r\n        Refresh()\r\n      },\r\n      onUpdatePageSize: (pageSize) => {\r\n        paginationReactive.value.pageSize = pageSize\r\n        paginationReactive.value.page = 1\r\n        loadingData.value=true\r\n        Refresh()\r\n      }\r\n    })\r\n\r\nconst Refresh=()=>{\r\n    if(searchParams.value==\"\"){\r\n        API.get(`/api/v2/group/list?offset=${(paginationReactive.value.page-1)*paginationReactive.value.pageSize}&pagesize=${paginationReactive.value.pageSize}`).then(v=>{\r\n    data.value=v.data\r\n    paginationReactive.value.itemCount=v.count\r\n    loadingData.value=false\r\n    LoadingSearch.value=false\r\n})\r\n    }else{\r\n        if(searchFrom.value==\"UUID\"){\r\n            API.get(`/api/v2/group/list/search/uuid?q=${encodeURIComponent(searchParams.value)}&offset=${(paginationReactive.value.page-1)*paginationReactive.value.pageSize}&pagesize=${paginationReactive.value.pageSize}`).then(v=>{\r\n    data.value=v.data\r\n    loadingData.value=false\r\n    LoadingSearch.value=false    })\r\n        }else if(searchFrom.value==\"title\"){\r\n            API.post(`/api/v2/group/list/search/title?offset=${(paginationReactive.value.page-1)*paginationReactive.value.pageSize}&pagesize=${paginationReactive.value.pageSize}`,{\r\n                query:searchParams.value\r\n            }).then(v=>{\r\n    data.value=v.data\r\n    loadingData.value=false\r\n    LoadingSearch.value=false    })\r\n        }\r\n\r\n\r\n}\r\n}\r\n\r\n,SearchUpdate=(v)=>{\r\n    searchParams.value=v\r\n    LoadingSearch.value=true\r\n    Refresh()\r\n}\r\n\r\n// API.get(\"/api/v2/group/list\").then(v=>{\r\n//     data.value=v\r\n//     loadingData.value=false\r\n// })\r\n\r\nRefresh()\r\n\r\n</script>\r\n\r\n<style>\r\n\r\n</style>\r\n"],"names":["useRoute","router","useRouter","loadingData","ref","LoadingSearch","searchParams","searchFrom","data","columns","row","h","subjectsmapFlattened","NTime","NButton","checkedRowKeysRef","handleCheck","rowKeys","paginationReactive","page","Refresh","pageSize","API","v","SearchUpdate"],"mappings":"g4DAqBAA,EAAA,EAAA,MAAAC,EAAAC,EAAA,EAEAC,EAAAC,EAAA,EAAA,EAAAC,EAAAD,EAAA,EAAA,EAAAE,EAAAF,EAAA,EAAA,EAAAG,EAAAH,EAAA,MAAA,EACAI,EAAAJ,EAAA,EAAA,EAEAK,EAAA,CAAA,CACA,KAAA,WACA,EAAA,CACA,MAAA,OACA,IAAA,IACA,EAAA,CACA,MAAA,QACA,IAAA,OACA,EAAA,CACA,MAAA,WACA,OAAAC,EAAA,CACA,OAAAC,EAAA,OAAA,CAAA,EAAAC,EAAA,GAAAF,EAAA,MAAA,CAAA,CACA,CACA,EAAA,CACA,MAAA,cACA,OAAAA,EAAA,CACA,OAAAC,EAAAE,EAAA,CACA,KAAAH,EAAA,UACA,GAAA,IAAA,KAAA,EAAA,QAAA,EACA,KAAA,UACA,CAAA,CACA,CACA,EAAA,CACA,MAAA,OACA,OAAAA,EAAA,CACA,OAAAC,EAAAG,EAAA,CACA,KAAA,GACA,QAAA,IAAA,CACAb,EAAA,KAAA,UAAAS,EAAA,EAAA,CACA,CACA,EAAA,CAAA,QAAA,IAAA,MAAA,CAAA,CACA,CACA,CAAA,EAEAK,EAAAX,EAAA,EAAA,EACAY,EAAAC,GAAA,CACAF,EAAA,MAAAE,EACA,QAAA,IAAAA,CAAA,CACA,EAOAC,EAAAd,EAAA,CACA,KAAA,EACA,SAAA,GACA,eAAA,GACA,UAAA,EACA,UAAA,CAAA,EAAA,GAAA,GAAA,EAAA,EACA,SAAAe,GAAA,CACAD,EAAA,MAAA,KAAAC,EACAhB,EAAA,MAAA,GACAiB,EAAA,CACA,EACA,iBAAAC,GAAA,CACAH,EAAA,MAAA,SAAAG,EACAH,EAAA,MAAA,KAAA,EACAf,EAAA,MAAA,GACAiB,EAAA,CACA,CACA,CAAA,EAEAA,EAAA,IAAA,CACAd,EAAA,OAAA,GACAgB,EAAA,IAAA,8BAAAJ,EAAA,MAAA,KAAA,GAAAA,EAAA,MAAA,QAAA,aAAAA,EAAA,MAAA,QAAA,EAAA,EAAA,KAAAK,GAAA,CACAf,EAAA,MAAAe,EAAA,KACAL,EAAA,MAAA,UAAAK,EAAA,MACApB,EAAA,MAAA,GACAE,EAAA,MAAA,EACA,CAAA,EAEAE,EAAA,OAAA,OACAe,EAAA,IAAA,oCAAA,mBAAAhB,EAAA,KAAA,CAAA,YAAAY,EAAA,MAAA,KAAA,GAAAA,EAAA,MAAA,QAAA,aAAAA,EAAA,MAAA,QAAA,EAAA,EAAA,KAAAK,GAAA,CACAf,EAAA,MAAAe,EAAA,KACApB,EAAA,MAAA,GACAE,EAAA,MAAA,GAAA,EACAE,EAAA,OAAA,SACAe,EAAA,KAAA,2CAAAJ,EAAA,MAAA,KAAA,GAAAA,EAAA,MAAA,QAAA,aAAAA,EAAA,MAAA,QAAA,GAAA,CACA,MAAAZ,EAAA,KACA,CAAA,EAAA,KAAAiB,GAAA,CACAf,EAAA,MAAAe,EAAA,KACApB,EAAA,MAAA,GACAE,EAAA,MAAA,GAAA,CAKA,EAEAmB,EAAAD,GAAA,CACAjB,EAAA,MAAAiB,EACAlB,EAAA,MAAA,GACAe,EAAA,CACA,EAOA,OAAAA,EAAA"}