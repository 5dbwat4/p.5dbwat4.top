import{H as w,j as D}from"./json-8bda58bf.js";import{onBeforeRouteLeave as H}from"./vue-router-85f8dd9e.js";import{A as r}from"./APIHelper-89899791.js";import{N as L}from"./Code-d8e2f3eb.js";import{N as U}from"./ConfigProvider-085d7668.js";import{b2 as n,ab as p,m as d,u,aH as i,bc as a,F as $,n as f,t as v,l as h,k as x}from"./index-6b27469d.js";import{N as m}from"./Button-a421b774.js";import{N as C}from"./Input-c49f615f.js";import{N as B}from"./Spin-dbb425d2.js";import"./_commonjsHelpers-de833af9.js";import"./light-cb8e5d18.js";import"./format-length-c9d165c6.js";import"./Icon-0741e3aa.js";import"./Warning-ad995842.js";import"./Close-df27b242.js";import"./Scrollbar-6ef5ad24.js";import"./runtime-dom.esm-bundler-4f377a37.js";import"./keysOf-5d5107c5.js";import"./use-memo-7138c88c.js";import"./Loading-a27cceda.js";import"./use-is-mounted-e356ec1d.js";import"./FadeInExpandTransition-65435983.js";import"./use-locale-13d55c5c.js";import"./index-975a2d8f.js";import"./use-merged-state-236ae148.js";import"./light-5edeff63.js";import"./Suffix-8898b6d6.js";import"./use-compitable-182c3d4e.js";const F={key:0},G=f("span",null,"\u6B63\u5728\u67E5\u8BE2Syncbatch\u72B6\u6001",-1),I=[G],J={key:1},O=f("span",null,"\u5C1A\u672A\u5F00\u59CBSyncbatch",-1),P={key:2},R=f("span",null,"\u5DF2\u7ECF\u5F00\u59CBSyncbatch",-1),V={key:0},q=f("div",null,null,-1),E={__name:"syncbatch",setup(z){w.registerLanguage("json",D);const t=n(0),l=n({started:!1,currentids:[],title:""}),s=n("");r.get("/api/syncbatch/sync-session").then(e=>{l.value=e.data,t.value=1,l.value.started&&(s.value=l.value.title,y())});const N=()=>{t.value=2,r.post("/api/syncbatch/start-session",{title:s.value,time:new Date().getTime()}).then(e=>{l.value=e.data,t.value=1,y()})};let k=!0;H(()=>{k=!1});const y=()=>{t.value=2,r.get("/api/syncbatch/sync-session").then(e=>{l.value=e.data,t.value=1,k&&setTimeout(y,1500)})},j=()=>{t.value=2,r.post("/api/syncbatch/edit-title",{title:s.value}).then(e=>{l.value=e.data,t.value=1})},S=()=>{t.value=2,r.get("/api/syncbatch/kill-session").then(e=>{t.value=1})},b=n(!1),g=n(!1),_=n(""),T=()=>{b.value=!0,r.post("/api/group/new",{entry:l.value.currentids.join(","),timestamp:new Date().getTime(),title:l.value.title,desc:""}).then(e=>{b.value=!1,g.value=!0,_.value=e.id})},A=e=>JSON.stringify(e,void 0,4);return(e,o)=>(p(),d($,null,[u(a(m),{onClick:o[0]||(o[0]=c=>e.$router.push("/batching/from-basket"))},{default:i(()=>[v("\u4ECE\u8BD5\u9898\u7BEE")]),_:1}),u(a(U),{hljs:a(w)},{default:i(()=>[t.value==0?(p(),d("div",F,I)):h("",!0),t.value==1&&!l.value.started?(p(),d("div",J,[O,u(a(C),{value:s.value,"onUpdate:value":o[1]||(o[1]=c=>s.value=c)},null,8,["value"]),u(a(m),{onClick:N},{default:i(()=>[v("\u73B0\u5728\u5F00\u59CB")]),_:1})])):h("",!0),l.value.started?(p(),d("div",P,[R,t.value==2?(p(),d("span",V,"\u6B63\u5728\u53D1\u9001API\u8BF7\u6C42")):h("",!0),u(a(B),{show:t.value==2},{default:i(()=>[u(a(L),{code:A(l.value)},null,8,["code"])]),_:1},8,["show"]),u(a(C),{value:s.value,"onUpdate:value":o[2]||(o[2]=c=>s.value=c)},null,8,["value"]),u(a(m),{onClick:j},{default:i(()=>[v("\u4FEE\u6539Title")]),_:1}),u(a(m),{onClick:T},{default:i(()=>[v("\u4FDD\u5B58\u4E3AGroup")]),_:1}),u(a(m),{onClick:S},{default:i(()=>[v("\u7EC8\u6B62")]),_:1}),g.value?(p(),x(a(m),{key:1,onClick:o[3]||(o[3]=c=>e.$router.push("/group/"+_.value))},{default:i(()=>[v("View")]),_:1})):h("",!0)])):h("",!0)]),_:1},8,["hljs"]),q],64))}};export{E as default};
