import{useRoute as P,useRouter as D}from"./vue-router-85f8dd9e.js";import{q as B}from"./define_basic_qtypes-5cc5565b.js";import{A as S}from"./APIHelper-89899791.js";import{q as E,d as z}from"./diff.map-0594d4b4.js";import{H as O,a as U,b as V,_ as G,c as J,d as K}from"./block-theme-2-4133c67c.js";import{ab as o,m as b,n as d,t as m,bi as $,F as k,b2 as s,u as g,aH as q,bc as p,ah as w,bh as C,k as y,l as c}from"./index-6b27469d.js";import{N as T}from"./Button-a421b774.js";import"./light-cb8e5d18.js";import"./format-length-c9d165c6.js";import"./Icon-0741e3aa.js";import"./Warning-ad995842.js";import"./Close-df27b242.js";import"./Scrollbar-6ef5ad24.js";import"./runtime-dom.esm-bundler-4f377a37.js";import"./keysOf-5d5107c5.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./Loading-a27cceda.js";import"./use-is-mounted-e356ec1d.js";import"./use-memo-7138c88c.js";import"./FadeInExpandTransition-65435983.js";const Q=[280102,280901,280103],W=[2701,2704],X=["\u6570\u5B66\u8BD5\u5377","\u6570\u5B66\u8BD5\u9898","\u6570\u5B66\uFF08\u7406\u79D1\uFF09\u8BD5\u5377"];function H(l,t){const n=document.createElement("div");return n.classList.add("__normalized_block"),l=l.replaceAll("\u3010\u9898\u6587\u3011",""),t.q0b.bankid==10&&(l=l.replaceAll(/【小题(\d)】/g,"$1. ")),n.innerHTML=l,n.querySelectorAll("img").forEach(e=>{if(e.src.includes("/formula/")&&(e.src=e.src.replace(".png",".svg"),e.style.width=e.width*.8+"px",e.setAttribute("width",e.width*.8),e.setAttribute("height","")),e.src.includes("/dksih/")){let a=/\?resizew=(\d*)/.exec(e.src);a&&a.length!=0&&(a[1]>500&&(a[1]=500),e.style.width=a[1]+"px",e.src=e.src.replace(/\?resizew=(\d*)/,""),e.setAttribute("width",a[1]),e.setAttribute("height","")),e.outerHTML=`
        
            <div style="width: fit-content;display: inline-block;text-align: center;" data-belongsto="${t.tindex-1}" class="__ccccimage">${e.outerHTML}
    <p style="margin: 0 0;font-family: kaiti;">\uFF08\u7B2C${t.tindex}\u9898\u56FE\uFF09</p></div>`}}),n.querySelectorAll("p").forEach(e=>{e.style.fontFamily||(e.style.fontFamily="Times New Roman , \u5B8B\u4F53"),e.style.fontSize||(e.style.fontSize="9.5pt"),e.style.margin="0px"}),n.querySelectorAll("span").forEach(e=>{e.style.fontSize=="14px"&&(e.style.fontSize="9.5pt")}),n.querySelectorAll("table[name=optionsTable]").forEach(e=>{if(e.querySelectorAll("td").length==4){let a=[];e.querySelectorAll("td").forEach(L=>{a.push(L.outerHTML)});const{ctn:_,next_lns:h}=Y(a,4);e.innerHTML=_}}),n.querySelectorAll("table[name=optionsTable] td").forEach(e=>{e.innerHTML="<span style='width:fit-content;display:block;'>"+e.innerHTML+"</span>",e.style.fontFamily||(e.style.fontFamily="Times New Roman , \u5B8B\u4F53"),e.style.fontSize||(e.style.fontSize="9.5pt"),e.style.margin="0px"}),n.style.fontFamily="Times New Roman , \u5B8B\u4F53",n.firstElementChild.tagName=="P"&&W.indexOf(t.q0b.type)!=-1&&(n.firstElementChild.outerHTML="<span>"+n.firstElementChild.innerHTML+"</span><br/>"),n.querySelectorAll("bk[type=underline]").forEach(e=>{e.innerText.includes("_")&&(e.style.color="lightgray",e.style.fontSize="13pt")}),(t.nqtype==0||t.nqtype==3)&&n.insertAdjacentHTML("afterbegin",` (${E[""+t.q0b.bankid][""+t.q0b.type]},${z[""+t.q0b.diff]}(${t.q0b.diff})) `),(t.nqtype==0||t.nqtype==3||t.nqtype==5)&&n.insertAdjacentHTML("afterbegin",`<strong>${t.tindex}. </strong>`),t.nqtype==6&&n.insertAdjacentHTML("afterbegin",`<strong>${t.tindex}. </strong>  (${E[""+t.q0b.bankid][""+t.q0b.type]},${z[""+t.q0b.diff]}(${t.q0b.diff})) <span style="font-family:kaiti">\uFF08${Z(t.q0b.origin)}\uFF09</span>`),t.q0b.type==2809&&(console.log("oooo0"),n.querySelectorAll("bk u").forEach(e=>{e.innerHTML=e.innerHTML.replace(/【小题(\d*)】/,"$1.______________"),e.outerHTML=e.outerHTML.replace("<u>","<span>").replace("</u>","</span>")}),n.innerHTML=n.innerHTML.replaceAll(/【小题(\d*)】/g,"$1.")),Q.includes(t.q0b.type)&&(n.innerHTML=n.innerHTML.replaceAll(/【小题(\d*)】/g,"$1.")),t.q0b.type==280902&&n.querySelectorAll("bk u").forEach(e=>{e.innerHTML=e.innerHTML.replace(/【小题(\d*)】/,"$1.______________"),e.outerHTML=e.outerHTML.replace("<u>","<span>").replace("</u>","</span>")}),t.q0b.type==2808&&(n.querySelectorAll("span").forEach(e=>{e.innerHTML=e.innerHTML.replace(/【小题(\d*)】/,"$1.")}),n.querySelectorAll("bk").forEach(e=>{e.style="text-decoration: underline black;",e.outerHTML="<span style='text-decoration: underline black;'>&nbsp;&nbsp;&nbsp;"+e.attributes.index.nodeValue+"&nbsp;&nbsp;&nbsp;</span>"})),t.q0b.type==281302&&n.querySelectorAll("bk u").forEach(e=>{e.innerHTML=e.innerHTML.replace(/【小题(\d*)】/,` <span>$1.</span><span style="color: lightgray;
  font-size: 13.5pt;">__________________</span> `),e.outerHTML=e.outerHTML.replace("<u>","<span>").replace("</u>","</span>")}),n.querySelectorAll("p").forEach(e=>{e.parentElement.tagName!="TD"&&(e.innerText==`

`&&e.parentNode.removeChild(e),e.innerText==""&&e.parentNode.removeChild(e))}),n.querySelectorAll("span").forEach(e=>{e.parentElement.tagName!="TD"&&(e.innerText==`

`&&e.parentNode.removeChild(e),e.innerText==""&&e.parentNode.removeChild(e))}),n.querySelectorAll("br").forEach(e=>{var a;((a=e.nextSibling)==null?void 0:a.tagName)=="BR"&&(e.nextSibling.style.display="none")}),n.querySelectorAll("br").forEach(e=>{e.style.display=="none"&&e.parentNode.removeChild(e)}),n.outerHTML}function Y(l,t){if(t==1)return{ctn:"<tbody><tr>"+l.join("")+"</tr></tbody>",next_lns:2};if(t==2)return{ctn:`<tbody><tr>${l[0]}${l[1]}</tr><tr>${l[2]}${l[3]}</tr></tbody>`,next_lns:4};if(t==4)return{ctn:"<tbody><tr>"+l.join("</tr><tr>")+"</tr></tbody>",next_lns:1}}function Z(l){return X.forEach(t=>{l=l.replaceAll(t,"")}),l}const ee={style:{"font-size":"6.5pt",margin:"0px","font-family":"Cambria, \u4EFF\u5B8B"}},te={style:{"font-family":"'courier new'"}},ne={style:{"font-family":"'courier new'"}},le=["innerHTML"],ae={__name:"block-theme-3",setup(l){return(t,n)=>(o(),b(k,null,[d("p",ee,[m(" UUID:"),d("span",te,$(t.$attrs.data.id),1),m(" | qid:"),d("span",ne,$(t.$attrs.data.qid),1)]),d("div",{innerHTML:t.$attrs.data.bankid==0?t.$attrs.data.q:t.$attrs.normalizeFun(t.$attrs.data.q,{q0b:t.$attrs.data,tindex:t.$attrs.index+1,nqtype:6}),style:{fontSize:"9.5pt",fontFamily:"Times New Romans,\u5B8B\u4F53"}},null,8,le)],64))}},re={style:{width:"18.76cm","line-height":"normal"},id:"oonom"},ie={class:"noprint"},oe={class:"labi-container"},se=["onClick","data_id"],de={__name:"preexport-1",setup(l){const t=P(),n=D(),e=s(0),a=s(0),_=3,h=4,L=s({q:!0,a:!1,p:!1}),F=s(""),x=s({title:"",guid:t.params.id}),M=s({}),N=s(!1);S.get("/api/group/get/"+t.params.id).then(u=>{u.entry.split(",").forEach(r=>{M.value[r]=B}),x.value.title=F.value=u.title,Promise.all(u.entry.split(",").map(r=>new Promise((i,f)=>{S.get("/api/data/get/"+r).then(A=>{M.value[r]=A})}))).then(()=>{})});const R=u=>Object.entries(u).map(r=>r[1]),j=s(u=>{}),v=s(1),I=()=>{localStorage.setItem("___thost___html_export",document.getElementById("corehtml").outerHTML),n.push("/grouping/preexport-2/"+t.params.id)};return s("Cambria , \u5B8B\u4F53"),(u,r)=>(o(),b(k,null,[g(p(T),{class:"noprint",onClick:r[0]||(r[0]=i=>v.value==2?v.value=1:v.value=2)},{default:q(()=>[m("\u6539\u53D8\u5217\u6570 ")]),_:1}),g(p(T),{class:"noprint",onClick:r[1]||(r[1]=i=>N.value=!0)},{default:q(()=>[m("Retheme 2")]),_:1}),g(p(T),{class:"noprint",ref:"btn1",onClick:r[2]||(r[2]=i=>e.value++)},{default:q(()=>[m("Title format")]),_:1},512),g(p(T),{class:"noprint",ref:"btn2",onClick:r[3]||(r[3]=i=>a.value++)},{default:q(()=>[m("Info format")]),_:1},512),g(p(T),{class:"noprint",ref:"btn3",onClick:r[4]||(r[4]=i=>I()),type:"success"},{default:q(()=>[m("\u4E0B\u4E00\u9875")]),_:1},512),d("div",re,[d("div",ie,[d("div",oe,[(o(),b(k,null,w([1,2,3,4,5,6,7],i=>d("div",{class:"labi-block",key:i,style:{height:"1045px"}}," Page # "+$(i),1)),64))])]),d("div",{id:"corehtml",style:C({width:"18.95cm",columns:v.value,"line-height":"normal"})},[e.value%_==0?(o(),y(O,{key:0,data:x.value},null,8,["data"])):c("",!0),e.value%_==1?(o(),y(U,{key:1,data:x.value},null,8,["data"])):c("",!0),e.value%_==2?(o(),y(V,{key:2,data:x.value},null,8,["data"])):c("",!0),(o(!0),b(k,null,w(R(M.value),(i,f)=>(o(),b("div",{key:i.id,onClick:A=>j.value(i.id),class:"___core_block",data_id:f},[a.value%h==0?(o(),y(G,{key:0,data:i,index:f,normalizeFun:p(H)},null,8,["data","index","normalizeFun"])):c("",!0),a.value%h==1?(o(),y(J,{key:1,data:i,index:f,normalizeFun:p(H)},null,8,["data","index","normalizeFun"])):c("",!0),a.value%h==2?(o(),y(K,{key:2,data:i,index:f,normalizeFun:p(H)},null,8,["data","index","normalizeFun"])):c("",!0),a.value%h==3?(o(),y(ae,{key:3,data:i,index:f,normalizeFun:p(H)},null,8,["data","index","normalizeFun"])):c("",!0),L.value.q?(o(),b("div",{key:4,style:C({display:"block",height:(i._extb_height||0)+"px"}),class:"extblank"},null,4)):c("",!0)],8,se))),128))],4)])],64))}};export{de as default};
