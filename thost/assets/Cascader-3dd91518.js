import{T as ke}from"./runtime-dom.esm-bundler-4f377a37.js";import{i as gl,a as bl,e as yl,F as wl,V as kl,u as xl,b as Cl,N as Rl,c as Sl,d as Ml,f as Tl}from"./utils-1657c4d7.js";import{a as A,s as Nl,l as Pl,c as Fl,g as Ol,h as ce,i as xe,b as W,u as Kl,d as Ve,n as Ll,e as Bl}from"./light-cb8e5d18.js";import{u as he,b as De,r as Al}from"./use-memo-7138c88c.js";import{N as zl,u as Il}from"./Loading-a27cceda.js";import{N as He}from"./Icon-0741e3aa.js";import{C as $l,h as Fe}from"./ChevronRight-f0e435af.js";import{c as jl,N as Vl}from"./Checkbox-d6d0f1db.js";import{w as re,b8 as q,b2 as S,a1 as Dl,N as d,R as Ce,j as f,aJ as Ue,aV as Hl,aC as qe,ad as Ul,_ as ql}from"./index-6b27469d.js";import{d as ve}from"./Close-df27b242.js";import{f as El,s as _l,N as Wl,g as Gl}from"./Scrollbar-6ef5ad24.js";import{c as Ee}from"./index-cabd39fd.js";import{c as _e,S as Yl}from"./create-59670860.js";import{f as We}from"./fade-in-scale-up.cssr-59f6c429.js";import{u as Jl}from"./use-locale-13d55c5c.js";import{u as Ge}from"./use-merged-state-236ae148.js";import{i as Ql,c as X}from"./use-is-mounted-e356ec1d.js";import{m as Xl}from"./index-cbfaa337.js";import{u as Re,V as Zl,a as eo,b as Ye}from"./Popover-d5735fab.js";const lo=A("base-menu-mask",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 display: flex;
 align-items: center;
 justify-content: center;
 text-align: center;
 padding: 14px;
 overflow: hidden;
`,[El()]),oo=re({name:"BaseMenuMask",props:{clsPrefix:{type:String,required:!0}},setup(l){Nl("-base-menu-mask",lo,q(l,"clsPrefix"));const t=S(null);let a=null;const n=S(!1);return Dl(()=>{a!==null&&window.clearTimeout(a)}),Object.assign({message:t,show:n},{showOnce(h,m=1500){a&&window.clearTimeout(a),n.value=!0,t.value=h,a=window.setTimeout(()=>{n.value=!1,t.value=null},m)}})},render(){return d(ke,{name:"fade-in-transition"},{default:()=>this.show?d("div",{class:`${this.clsPrefix}-base-menu-mask`},this.message):null})}}),ao=l=>{const{borderRadius:t,boxShadow2:a,popoverColor:n,textColor2:h,textColor3:m,primaryColor:C,textColorDisabled:v,dividerColor:b,hoverColor:R,fontSizeMedium:k,heightMedium:O}=l;return{menuBorderRadius:t,menuColor:n,menuBoxShadow:a,menuDividerColor:b,menuHeight:"calc(var(--n-option-height) * 6.6)",optionArrowColor:m,optionHeight:O,optionFontSize:k,optionColorHover:R,optionTextColor:h,optionTextColorActive:C,optionTextColorDisabled:v,optionCheckMarkColor:C,loadingColor:C,columnWidth:"180px"}},to=Pl({name:"Cascader",common:Fl,peers:{InternalSelectMenu:gl,InternalSelection:bl,Scrollbar:_l,Checkbox:jl,Empty:yl},self:ao}),no=to;function Se(l){return l?l.map(t=>t.rawNode):null}function ro(l,t,a,n){const h=[],m=[];function C(v){for(const b of v){if(b.disabled)continue;const{rawNode:R}=b;m.push(R),(b.isLeaf||!t)&&h.push({label:Oe(b,n,a),value:b.key,rawNode:b.rawNode,path:Array.from(m)}),!b.isLeaf&&b.children&&C(b.children),m.pop()}}return C(l),h}function Oe(l,t,a){const n=[];for(;l;)n.push(l.rawNode[a]),l=l.parent;return n.reverse().join(t)}const pe=Ol("n-cascader"),Je=re({name:"NCascaderOption",props:{tmNode:{type:Object,required:!0}},setup(l){const{expandTriggerRef:t,remoteRef:a,multipleRef:n,mergedValueRef:h,checkedKeysRef:m,indeterminateKeysRef:C,hoverKeyPathRef:v,keyboardKeyRef:b,loadingKeySetRef:R,cascadeRef:k,mergedCheckStrategyRef:O,onLoadRef:I,mergedClsPrefixRef:L,mergedThemeRef:G,labelFieldRef:M,showCheckboxRef:N,updateHoverKey:T,updateKeyboardKey:z,addLoadingKey:$,deleteLoadingKey:K,closeMenu:B,doCheck:D,doUncheck:Z,renderLabelRef:ee}=Ce(pe),u=f(()=>l.tmNode.key),y=f(()=>{const{value:F}=t,{value:_}=a;return!_&&F==="hover"}),j=f(()=>{if(y.value)return J}),le=f(()=>{if(y.value)return ue}),P=he(()=>{const{value:F}=n;return F?m.value.includes(u.value):h.value===u.value}),H=he(()=>n.value?C.value.includes(u.value):!1),oe=he(()=>v.value.includes(u.value)),ie=he(()=>{const{value:F}=b;return F===null?!1:F===u.value}),Me=he(()=>a.value?R.value.has(u.value):!1),se=f(()=>l.tmNode.isLeaf),U=f(()=>l.tmNode.disabled),fe=f(()=>l.tmNode.rawNode[M.value]),E=f(()=>l.tmNode.shallowLoaded);function Y(F){if(U.value)return;const{value:_}=a,{value:ge}=R,{value:be}=I,{value:x}=u,{value:Te}=se,{value:V}=E;Fe(F,"checkbox")||(_&&!V&&!ge.has(x)&&be&&($(x),be(l.tmNode.rawNode).then(()=>{K(x)}).catch(()=>{K(x)})),T(x),z(x)),Te&&ae()}function J(){if(!y.value||U.value)return;const{value:F}=u;T(F),z(F)}function ue(){y.value&&J()}function me(){const{value:F}=se;F||ae()}function ae(){const{value:F}=n,{value:_}=u;F?H.value||P.value?Z(_):D(_):(D(_),B(!0))}return{checkStrategy:O,multiple:n,cascade:k,checked:P,indeterminate:H,hoverPending:oe,keyboardPending:ie,isLoading:Me,showCheckbox:N,isLeaf:se,disabled:U,label:fe,mergedClsPrefix:L,mergedTheme:G,handleClick:Y,handleCheckboxUpdateValue:me,mergedHandleMouseEnter:j,mergedHandleMouseMove:le,renderLabel:ee}},render(){const{mergedClsPrefix:l,renderLabel:t}=this;return d("div",{class:[`${l}-cascader-option`,{[`${l}-cascader-option--pending`]:this.keyboardPending||this.hoverPending,[`${l}-cascader-option--disabled`]:this.disabled,[`${l}-cascader-option--show-prefix`]:this.showCheckbox}],onMouseenter:this.mergedHandleMouseEnter,onMousemove:this.mergedHandleMouseMove,onClick:this.handleClick},this.showCheckbox?d("div",{class:`${l}-cascader-option__prefix`},d(Vl,{focusable:!1,"data-checkbox":!0,disabled:this.disabled,checked:this.checked,indeterminate:this.indeterminate,theme:this.mergedTheme.peers.Checkbox,themeOverrides:this.mergedTheme.peerOverrides.Checkbox,onUpdateChecked:this.handleCheckboxUpdateValue})):null,d("span",{class:`${l}-cascader-option__label`},t?t(this.tmNode.rawNode,this.checked):this.label),d("div",{class:`${l}-cascader-option__suffix`},d("div",{class:`${l}-cascader-option-icon-placeholder`},this.isLeaf?this.checkStrategy==="child"&&!(this.multiple&&this.cascade)?d(ke,{name:"fade-in-scale-up-transition"},{default:()=>this.checked?d(He,{clsPrefix:l,class:`${l}-cascader-option-icon ${l}-cascader-option-icon--checkmark`},{default:()=>d(wl,null)}):null}):null:d(zl,{clsPrefix:l,scale:.85,strokeWidth:24,show:this.isLoading,class:`${l}-cascader-option-icon`},{default:()=>d(He,{clsPrefix:l,key:"arrow",class:`${l}-cascader-option-icon ${l}-cascader-option-icon--arrow`},{default:()=>d($l,null)})}))))}}),io=re({name:"CascaderSubmenu",props:{depth:{type:Number,required:!0},tmNodes:{type:Array,required:!0}},setup(){const{virtualScrollRef:l,mergedClsPrefixRef:t,mergedThemeRef:a,optionHeightRef:n}=Ce(pe),h=S(null),m=S(null),C={scroll(v,b){var R,k;l.value?(R=m.value)===null||R===void 0||R.scrollTo({index:v}):(k=h.value)===null||k===void 0||k.scrollTo({index:v,elSize:b})}};return Object.assign({mergedClsPrefix:t,mergedTheme:a,scrollbarInstRef:h,vlInstRef:m,virtualScroll:l,itemSize:f(()=>ve(n.value)),handleVlScroll:()=>{var v;(v=h.value)===null||v===void 0||v.sync()},getVlContainer:()=>{var v;return(v=m.value)===null||v===void 0?void 0:v.listElRef},getVlContent:()=>{var v;return(v=m.value)===null||v===void 0?void 0:v.itemsElRef}},C)},render(){const{mergedClsPrefix:l,mergedTheme:t,virtualScroll:a}=this;return d("div",{class:[a&&`${l}-cascader-submenu--virtual`,`${l}-cascader-submenu`]},d(Wl,{ref:"scrollbarInstRef",theme:t.peers.Scrollbar,themeOverrides:t.peerOverrides.Scrollbar,container:a?this.getVlContainer:void 0,content:a?this.getVlContent:void 0},{default:()=>a?d(kl,{items:this.tmNodes,itemSize:this.itemSize,onScroll:this.handleVlScroll,showScrollbar:!1,ref:"vlInstRef"},{default:({item:n})=>d(Je,{key:n.key,tmNode:n})}):this.tmNodes.map(n=>d(Je,{key:n.key,tmNode:n}))}))}}),so=re({name:"NCascaderMenu",props:{value:[String,Number,Array],placement:{type:String,default:"bottom-start"},show:Boolean,menuModel:{type:Array,required:!0},loading:Boolean,onFocus:{type:Function,required:!0},onBlur:{type:Function,required:!0},onKeydown:{type:Function,required:!0},onMousedown:{type:Function,required:!0},onTabout:{type:Function,required:!0}},setup(l){const{localeRef:t,isMountedRef:a,mergedClsPrefixRef:n,syncCascaderMenuPosition:h,handleCascaderMenuClickOutside:m,mergedThemeRef:C}=Ce(pe),v=[],b=S(null),R=S(null);function k(){h()}xl(R,k);function O(M){var N;const{value:{loadingRequiredMessage:T}}=t;(N=b.value)===null||N===void 0||N.showOnce(T(M))}function I(M){m(M)}function L(M){const{value:N}=R;N&&(N.contains(M.relatedTarget)||l.onFocus(M))}function G(M){const{value:N}=R;N&&(N.contains(M.relatedTarget)||l.onBlur(M))}return Object.assign({isMounted:a,mergedClsPrefix:n,selfElRef:R,submenuInstRefs:v,maskInstRef:b,mergedTheme:C,handleFocusin:L,handleFocusout:G,handleClickOutside:I},{scroll(M,N,T){const z=v[M];z&&z.scroll(N,T)},showErrorMessage:O})},render(){const{submenuInstRefs:l,mergedClsPrefix:t,mergedTheme:a}=this;return d(ke,{name:"fade-in-scale-up-transition",appear:this.isMounted},{default:()=>this.show?Ue(d("div",{tabindex:"0",ref:"selfElRef",class:`${t}-cascader-menu`,onMousedown:this.onMousedown,onFocusin:this.handleFocusin,onFocusout:this.handleFocusout,onKeydown:this.onKeydown},this.menuModel[0].length?d("div",{class:`${t}-cascader-submenu-wrapper`},this.menuModel.map((n,h)=>d(io,{ref:m=>{m&&(l[h]=m)},key:h,tmNodes:n,depth:h+1})),d(oo,{clsPrefix:t,ref:"maskInstRef"})):d("div",{class:`${t}-cascader-menu__empty`},De(this.$slots.empty,()=>[d(Rl,{theme:a.peers.Empty,themeOverrides:a.peerOverrides.Empty})])),Al(this.$slots.action,n=>n&&d("div",{class:`${t}-cascader-menu-action`,"data-action":!0},n)),d(Cl,{onFocus:this.onTabout})),[[Ee,this.handleClickOutside,void 0,{capture:!0}]]):null})}}),uo=re({name:"NCascaderSelectMenu",props:{value:{type:[String,Number,Array],default:null},show:Boolean,pattern:{type:String,default:""},multiple:Boolean,tmNodes:{type:Array,default:()=>[]},filter:Function,labelField:{type:String,required:!0},separator:{type:String,required:!0}},setup(l){const{isMountedRef:t,mergedValueRef:a,mergedClsPrefixRef:n,mergedThemeRef:h,mergedCheckStrategyRef:m,slots:C,syncSelectMenuPosition:v,closeMenu:b,handleSelectMenuClickOutside:R,doUncheck:k,doCheck:O,clearPattern:I}=Ce(pe),L=S(null),G=f(()=>ro(l.tmNodes,m.value==="child",l.labelField,l.separator)),M=f(()=>{const{filter:u}=l;if(u)return u;const{labelField:y}=l;return(j,le,P)=>P.some(H=>H[y]&&~H[y].indexOf(j))}),N=f(()=>{const{pattern:u}=l,{value:y}=M;return(u?G.value.filter(j=>y(u,j.rawNode,j.path)):G.value).map(j=>({value:j.value,label:j.label}))}),T=f(()=>_e(N.value,Ml("value","children")));function z(){v()}function $(u){K(u)}function K(u){if(l.multiple){const{value:y}=a;Array.isArray(y)?y.includes(u.key)?k(u.key):O(u.key):y===null&&O(u.key),I()}else O(u.key),b(!0)}function B(){var u;(u=L.value)===null||u===void 0||u.prev()}function D(){var u;(u=L.value)===null||u===void 0||u.next()}function Z(){var u;if(L){const y=(u=L.value)===null||u===void 0?void 0:u.getPendingTmNode();return y&&K(y),!0}return!1}function ee(u){R(u)}return Object.assign({isMounted:t,mergedTheme:h,mergedClsPrefix:n,menuInstRef:L,selectTreeMate:T,handleResize:z,handleToggle:$,handleClickOutside:ee,cascaderSlots:C},{prev:B,next:D,enter:Z})},render(){const{mergedClsPrefix:l,isMounted:t,mergedTheme:a,cascaderSlots:n}=this;return d(ke,{name:"fade-in-scale-up-transition",appear:t},{default:()=>this.show?Ue(d(Sl,{ref:"menuInstRef",onResize:this.handleResize,clsPrefix:l,class:`${l}-cascader-menu`,autoPending:!0,themeOverrides:a.peerOverrides.InternalSelectMenu,theme:a.peers.InternalSelectMenu,treeMate:this.selectTreeMate,multiple:this.multiple,value:this.value,onToggle:this.handleToggle},{empty:()=>De(n["not-found"],()=>[])}),[[Ee,this.handleClickOutside,void 0,{capture:!0}]]):null})}}),co=ce([A("cascader-menu",`
 outline: none;
 position: relative;
 margin: 4px 0;
 display: flex;
 flex-flow: column nowrap;
 border-radius: var(--n-menu-border-radius);
 overflow: hidden;
 box-shadow: var(--n-menu-box-shadow);
 color: var(--n-option-text-color);
 background-color: var(--n-menu-color);
 `,[We({transformOrigin:"inherit",duration:"0.2s"}),xe("empty",`
 display: flex;
 padding: 12px 32px;
 flex: 1;
 justify-content: center;
 `),A("scrollbar",{width:"100%"}),A("base-menu-mask",{backgroundColor:"var(--n-menu-mask-color)"}),A("base-loading",{color:"var(--n-loading-color)"}),A("cascader-submenu-wrapper",`
 position: relative;
 display: flex;
 flex-wrap: nowrap;
 `),A("cascader-submenu",`
 height: var(--n-menu-height);
 min-width: var(--n-column-width);
 position: relative;
 `,[W("virtual",`
 width: var(--n-column-width);
 `),A("scrollbar-content",{position:"relative"}),ce("&:first-child",`
 border-top-left-radius: var(--n-menu-border-radius);
 border-bottom-left-radius: var(--n-menu-border-radius);
 `),ce("&:last-child",`
 border-top-right-radius: var(--n-menu-border-radius);
 border-bottom-right-radius: var(--n-menu-border-radius);
 `),ce("&:not(:first-child)",`
 border-left: 1px solid var(--n-menu-divider-color);
 `)]),A("cascader-menu-action",`
 box-sizing: border-box;
 padding: 8px;
 border-top: 1px solid var(--n-menu-divider-color);
 `),A("cascader-option",`
 height: var(--n-option-height);
 line-height: var(--n-option-height);
 font-size: var(--n-option-font-size);
 padding: 0 0 0 18px;
 box-sizing: border-box;
 min-width: 182px;
 background-color: #0000;
 display: flex;
 align-items: center;
 white-space: nowrap;
 position: relative;
 cursor: pointer;
 transition:
 background-color .2s var(--n-bezier),
 color 0.2s var(--n-bezier);
 `,[W("show-prefix",{paddingLeft:0}),xe("label",`
 flex: 1 0 0;
 overflow: hidden;
 text-overflow: ellipsis;
 `),xe("prefix",{width:"32px",display:"flex",alignItems:"center",justifyContent:"center"}),xe("suffix",{width:"32px",display:"flex",alignItems:"center",justifyContent:"center"}),A("cascader-option-icon-placeholder",{lineHeight:0,position:"relative",width:"16px",height:"16px",fontSize:"16px"},[A("cascader-option-icon",[W("checkmark",{color:"var(--n-option-check-mark-color)"},[We({originalTransition:"background-color .3s var(--n-bezier), box-shadow .3s var(--n-bezier)"})]),W("arrow",{color:"var(--n-option-arrow-color)"})])]),W("selected",{color:"var(--n-option-text-color-active)"}),W("active",{color:"var(--n-option-text-color-active)",backgroundColor:"var(--n-option-color-hover)"}),W("pending",{backgroundColor:"var(--n-option-color-hover)"}),ce("&:hover",{backgroundColor:"var(--n-option-color-hover)"}),W("disabled",`
 color: var(--n-option-text-color-disabled);
 background-color: #0000;
 cursor: not-allowed;
 `,[A("cascader-option-icon",[W("arrow",{color:"var(--n-option-text-color-disabled)"})])])])]),A("cascader",`
 z-index: auto;
 position: relative;
 width: 100%;
 `)]),ho=Object.assign(Object.assign({},Ve.props),{allowCheckingNotLoaded:Boolean,to:Re.propTo,bordered:{type:Boolean,default:void 0},options:{type:Array,default:()=>[]},value:[String,Number,Array],defaultValue:{type:[String,Number,Array],default:null},placeholder:String,multiple:Boolean,size:String,filterable:Boolean,disabled:{type:Boolean,default:void 0},disabledField:{type:String,default:"disabled"},expandTrigger:{type:String,default:"click"},clearable:Boolean,clearFilterAfterSelect:{type:Boolean,default:!0},remote:Boolean,onLoad:Function,separator:{type:String,default:" / "},filter:Function,placement:{type:String,default:"bottom-start"},cascade:{type:Boolean,default:!0},leafOnly:Boolean,showPath:{type:Boolean,default:!0},show:{type:Boolean,default:void 0},maxTagCount:[String,Number],ellipsisTagPopoverProps:Object,menuProps:Object,filterMenuProps:Object,virtualScroll:{type:Boolean,default:!0},checkStrategy:{type:String,default:"all"},valueField:{type:String,default:"value"},labelField:{type:String,default:"label"},childrenField:{type:String,default:"children"},renderLabel:Function,status:String,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],"onUpdate:show":[Function,Array],onUpdateShow:[Function,Array],onBlur:Function,onFocus:Function,onChange:[Function,Array]}),vo=re({name:"Cascader",props:ho,setup(l,{slots:t}){const{mergedBorderedRef:a,mergedClsPrefixRef:n,namespaceRef:h,inlineThemeDisabled:m}=Kl(l),C=Ve("Cascader","-cascader",co,no,l,n),{localeRef:v}=Jl("Cascader"),b=S(l.defaultValue),R=f(()=>l.value),k=Ge(R,b),O=f(()=>l.leafOnly?"child":l.checkStrategy),I=S(""),L=Il(l),{mergedSizeRef:G,mergedDisabledRef:M,mergedStatusRef:N}=L,T=S(null),z=S(null),$=S(null),K=S(null),B=S(null),D=S(new Set),Z=S(null),ee=S(null),u=Re(l),y=S(!1),j=e=>{D.value.add(e)},le=e=>{D.value.delete(e)},P=f(()=>{const{valueField:e,childrenField:o,disabledField:r}=l;return _e(l.options,{getDisabled(c){return c[r]},getKey(c){return c[e]},getChildren(c){return c[o]}})}),H=f(()=>{const{cascade:e,multiple:o}=l;return o&&Array.isArray(k.value)?P.value.getCheckedKeys(k.value,{cascade:e,allowNotLoaded:l.allowCheckingNotLoaded}):{checkedKeys:[],indeterminateKeys:[]}}),oe=f(()=>H.value.checkedKeys),ie=f(()=>H.value.indeterminateKeys),Me=f(()=>{const{treeNodePath:e,treeNode:o}=P.value.getPath(B.value);let r;return o===null?r=[P.value.treeNodes]:(r=e.map(c=>c.siblings),!o.isLeaf&&!D.value.has(o.key)&&o.children&&r.push(o.children)),r}),se=f(()=>{const{keyPath:e}=P.value.getPath(B.value);return e}),U=f(()=>C.value.self.optionHeight);Hl(l.options)&&qe(l.options,(e,o)=>{e!==o&&(B.value=null,K.value=null)});function fe(e){const{onUpdateShow:o,"onUpdate:show":r}=l;o&&X(o,e),r&&X(r,e),ge.value=e}function E(e,o,r){const{onUpdateValue:c,"onUpdate:value":s,onChange:w}=l,{nTriggerFormInput:i,nTriggerFormChange:g}=L;c&&X(c,e,o,r),s&&X(s,e,o,r),w&&X(w,e,o,r),b.value=e,i(),g()}function Y(e){K.value=e}function J(e){B.value=e}function ue(e){const{value:{getNode:o}}=P;return e.map(r=>{var c;return((c=o(r))===null||c===void 0?void 0:c.rawNode)||null})}function me(e){var o;const{cascade:r,multiple:c,filterable:s}=l,{value:{check:w,getNode:i,getPath:g}}=P;if(c)try{const{checkedKeys:p}=w(e,H.value.checkedKeys,{cascade:r,checkStrategy:O.value,allowNotLoaded:l.allowCheckingNotLoaded});E(p,ue(p),p.map(ne=>{var de;return Se((de=g(ne))===null||de===void 0?void 0:de.treeNodePath)})),s&&Ne(),K.value=e,B.value=e}catch(p){if(p instanceof Yl){if(T.value){const ne=i(e);ne!==null&&T.value.showErrorMessage(ne.rawNode[l.labelField])}}else throw p}else if(O.value==="child"){const p=i(e);if(p!=null&&p.isLeaf)E(e,p.rawNode,Se(g(e).treeNodePath));else return!1}else{const p=i(e);E(e,(p==null?void 0:p.rawNode)||null,Se((o=g(e))===null||o===void 0?void 0:o.treeNodePath))}return!0}function ae(e){const{cascade:o,multiple:r}=l;if(r){const{value:{uncheck:c,getNode:s,getPath:w}}=P,{checkedKeys:i}=c(e,H.value.checkedKeys,{cascade:o,checkStrategy:O.value,allowNotLoaded:l.allowCheckingNotLoaded});E(i,i.map(g=>{var p;return((p=s(g))===null||p===void 0?void 0:p.rawNode)||null}),i.map(g=>{var p;return Se((p=w(g))===null||p===void 0?void 0:p.treeNodePath)})),K.value=e,B.value=e}}const F=f(()=>{if(l.multiple){const{showPath:e,separator:o,labelField:r,cascade:c}=l,{getCheckedKeys:s,getNode:w}=P.value;return s(oe.value,{cascade:c,checkStrategy:O.value,allowNotLoaded:l.allowCheckingNotLoaded}).checkedKeys.map(i=>{const g=w(i);return g===null?{label:String(i),value:i}:{label:e?Oe(g,o,r):g.rawNode[r],value:g.key}})}else return[]}),_=f(()=>{const{multiple:e,showPath:o,separator:r,labelField:c}=l,{value:s}=k;if(!e&&!Array.isArray(s)){const{getNode:w}=P.value;if(s===null)return null;const i=w(s);return i===null?{label:String(s),value:s}:{label:o?Oe(i,r,c):i.rawNode[c],value:i.key}}else return null}),ge=S(!1),be=q(l,"show"),x=Ge(be,ge),Te=f(()=>{const{placeholder:e}=l;return e!==void 0?e:v.value.placeholder}),V=f(()=>!!(l.filterable&&I.value));qe(x,e=>{if(!e||l.multiple)return;const{value:o}=k;!Array.isArray(o)&&o!==null?(K.value=o,B.value=o,ql(()=>{var r;if(!x.value)return;const{value:c}=B;if(k.value!==null){const s=P.value.getNode(c);s&&((r=T.value)===null||r===void 0||r.scroll(s.level,s.index,ve(U.value)))}})):(K.value=null,B.value=null)},{immediate:!0});function Ke(e){const{onBlur:o}=l,{nTriggerFormBlur:r}=L;o&&X(o,e),r()}function Le(e){const{onFocus:o}=l,{nTriggerFormFocus:r}=L;o&&X(o,e),r()}function Ne(){var e;(e=$.value)===null||e===void 0||e.focusInput()}function Qe(){var e;(e=$.value)===null||e===void 0||e.focus()}function ye(){M.value||(I.value="",fe(!0),l.filterable&&Ne())}function Q(e=!1){e&&Qe(),fe(!1),I.value=""}function Be(e){var o;V.value||x.value&&(!((o=$.value)===null||o===void 0)&&o.$el.contains(Gl(e))||Q())}function Xe(e){V.value&&Be(e)}function Ae(){l.clearFilterAfterSelect&&(I.value="")}function we(e){var o,r,c;const{value:s}=K,{value:w}=P;switch(e){case"prev":if(s!==null){const i=w.getPrev(s,{loop:!0});i!==null&&(Y(i.key),(o=T.value)===null||o===void 0||o.scroll(i.level,i.index,ve(U.value)))}break;case"next":if(s===null){const i=w.getFirstAvailableNode();i!==null&&(Y(i.key),(r=T.value)===null||r===void 0||r.scroll(i.level,i.index,ve(U.value)))}else{const i=w.getNext(s,{loop:!0});i!==null&&(Y(i.key),(c=T.value)===null||c===void 0||c.scroll(i.level,i.index,ve(U.value)))}break;case"child":if(s!==null){const i=w.getNode(s);if(i!==null)if(i.shallowLoaded){const g=w.getChild(s);g!==null&&(J(s),Y(g.key))}else{const{value:g}=D;if(!g.has(s)){j(s),J(s);const{onLoad:p}=l;p&&p(i.rawNode).then(()=>{le(s)}).catch(()=>{le(s)})}}}break;case"parent":if(s!==null){const i=w.getParent(s);if(i!==null){Y(i.key);const g=i.getParent();J(g===null?null:g.key)}}break}}function ze(e){var o,r;switch(e.key){case" ":case"ArrowDown":case"ArrowUp":if(l.filterable&&x.value)break;e.preventDefault();break}if(!Fe(e,"action"))switch(e.key){case" ":if(l.filterable)return;case"Enter":if(!x.value)ye();else{const{value:c}=V,{value:s}=K;if(c)z.value&&z.value.enter()&&Ae();else if(s!==null)if(oe.value.includes(s)||ie.value.includes(s))ae(s);else{const w=me(s);!l.multiple&&w&&Q(!0)}}break;case"ArrowUp":e.preventDefault(),x.value&&(V.value?(o=z.value)===null||o===void 0||o.prev():we("prev"));break;case"ArrowDown":e.preventDefault(),x.value?V.value?(r=z.value)===null||r===void 0||r.next():we("next"):ye();break;case"ArrowLeft":e.preventDefault(),x.value&&!V.value&&we("parent");break;case"ArrowRight":e.preventDefault(),x.value&&!V.value&&we("child");break;case"Escape":x.value&&(Xl(e),Q(!0))}}function Ze(e){ze(e)}function el(e){e.stopPropagation(),l.multiple?E([],[],[]):E(null,null,null)}function ll(e){var o;!((o=T.value)===null||o===void 0)&&o.$el.contains(e.relatedTarget)||(y.value=!0,Le(e))}function ol(e){var o;!((o=T.value)===null||o===void 0)&&o.$el.contains(e.relatedTarget)||(y.value=!1,Ke(e),Q())}function al(e){var o;!((o=$.value)===null||o===void 0)&&o.$el.contains(e.relatedTarget)||(y.value=!0,Le(e))}function tl(e){var o;!((o=$.value)===null||o===void 0)&&o.$el.contains(e.relatedTarget)||(y.value=!1,Ke(e))}function nl(e){Fe(e,"action")||l.multiple&&l.filter&&(e.preventDefault(),Ne())}function rl(){Q(!0)}function il(){l.filterable?ye():x.value?Q(!0):ye()}function sl(e){I.value=e.target.value}function ul(e){const{multiple:o}=l,{value:r}=k;o&&Array.isArray(r)&&e.value!==void 0?ae(e.value):E(null,null,null)}function Ie(){var e;(e=Z.value)===null||e===void 0||e.syncPosition()}function $e(){var e;(e=ee.value)===null||e===void 0||e.syncPosition()}function dl(){x.value&&(V.value?Ie():$e())}const Pe=f(()=>!!(l.multiple&&l.cascade||O.value!=="child"));Ul(pe,{slots:t,mergedClsPrefixRef:n,mergedThemeRef:C,mergedValueRef:k,checkedKeysRef:oe,indeterminateKeysRef:ie,hoverKeyPathRef:se,mergedCheckStrategyRef:O,showCheckboxRef:Pe,cascadeRef:q(l,"cascade"),multipleRef:q(l,"multiple"),keyboardKeyRef:K,hoverKeyRef:B,remoteRef:q(l,"remote"),loadingKeySetRef:D,expandTriggerRef:q(l,"expandTrigger"),isMountedRef:Ql(),onLoadRef:q(l,"onLoad"),virtualScrollRef:q(l,"virtualScroll"),optionHeightRef:U,localeRef:v,labelFieldRef:q(l,"labelField"),renderLabelRef:q(l,"renderLabel"),syncCascaderMenuPosition:$e,syncSelectMenuPosition:Ie,updateKeyboardKey:Y,updateHoverKey:J,addLoadingKey:j,deleteLoadingKey:le,doCheck:me,doUncheck:ae,closeMenu:Q,handleSelectMenuClickOutside:Xe,handleCascaderMenuClickOutside:Be,clearPattern:Ae});const cl={focus:()=>{var e;(e=$.value)===null||e===void 0||e.focus()},blur:()=>{var e;(e=$.value)===null||e===void 0||e.blur()},getCheckedData:()=>{if(Pe.value){const e=oe.value;return{keys:e,options:ue(e)}}return{keys:[],options:[]}},getIndeterminateData:()=>{if(Pe.value){const e=ie.value;return{keys:e,options:ue(e)}}return{keys:[],options:[]}}},je=f(()=>{const{self:{optionArrowColor:e,optionTextColor:o,optionTextColorActive:r,optionTextColorDisabled:c,optionCheckMarkColor:s,menuColor:w,menuBoxShadow:i,menuDividerColor:g,menuBorderRadius:p,menuHeight:ne,optionColorHover:de,optionHeight:hl,optionFontSize:vl,loadingColor:pl,columnWidth:fl},common:{cubicBezierEaseInOut:ml}}=C.value;return{"--n-bezier":ml,"--n-menu-border-radius":p,"--n-menu-box-shadow":i,"--n-menu-height":ne,"--n-column-width":fl,"--n-menu-color":w,"--n-menu-divider-color":g,"--n-option-height":hl,"--n-option-font-size":vl,"--n-option-text-color":o,"--n-option-text-color-disabled":c,"--n-option-text-color-active":r,"--n-option-color-hover":de,"--n-option-check-mark-color":s,"--n-option-arrow-color":e,"--n-menu-mask-color":Ll(w,{alpha:.75}),"--n-loading-color":pl}}),te=m?Bl("cascader",void 0,je,l):void 0;return Object.assign(Object.assign({},cl),{handleTriggerResize:dl,mergedStatus:N,selectMenuFollowerRef:Z,cascaderMenuFollowerRef:ee,triggerInstRef:$,selectMenuInstRef:z,cascaderMenuInstRef:T,mergedBordered:a,mergedClsPrefix:n,namespace:h,mergedValue:k,mergedShow:x,showSelectMenu:V,pattern:I,treeMate:P,mergedSize:G,mergedDisabled:M,localizedPlaceholder:Te,selectedOption:_,selectedOptions:F,adjustedTo:u,menuModel:Me,handleMenuTabout:rl,handleMenuFocus:al,handleMenuBlur:tl,handleMenuKeydown:Ze,handleMenuMousedown:nl,handleTriggerFocus:ll,handleTriggerBlur:ol,handleTriggerClick:il,handleClear:el,handleDeleteOption:ul,handlePatternInput:sl,handleKeydown:ze,focused:y,optionHeight:U,mergedTheme:C,cssVars:m?void 0:je,themeClass:te==null?void 0:te.themeClass,onRender:te==null?void 0:te.onRender})},render(){const{mergedClsPrefix:l}=this;return d("div",{class:`${l}-cascader`},d(Zl,null,{default:()=>[d(eo,null,{default:()=>d(Tl,{onResize:this.handleTriggerResize,ref:"triggerInstRef",status:this.mergedStatus,clsPrefix:l,maxTagCount:this.maxTagCount,ellipsisTagPopoverProps:this.ellipsisTagPopoverProps,bordered:this.mergedBordered,size:this.mergedSize,theme:this.mergedTheme.peers.InternalSelection,themeOverrides:this.mergedTheme.peerOverrides.InternalSelection,active:this.mergedShow,pattern:this.pattern,placeholder:this.localizedPlaceholder,selectedOption:this.selectedOption,selectedOptions:this.selectedOptions,multiple:this.multiple,filterable:this.filterable,clearable:this.clearable,disabled:this.mergedDisabled,focused:this.focused,onFocus:this.handleTriggerFocus,onBlur:this.handleTriggerBlur,onClick:this.handleTriggerClick,onClear:this.handleClear,onDeleteOption:this.handleDeleteOption,onPatternInput:this.handlePatternInput,onKeydown:this.handleKeydown},{arrow:()=>{var t,a;return(a=(t=this.$slots).arrow)===null||a===void 0?void 0:a.call(t)}})}),d(Ye,{key:"cascaderMenu",ref:"cascaderMenuFollowerRef",show:this.mergedShow&&!this.showSelectMenu,containerClass:this.namespace,placement:this.placement,width:this.options.length?void 0:"target",teleportDisabled:this.adjustedTo===Re.tdkey,to:this.adjustedTo},{default:()=>{var t;(t=this.onRender)===null||t===void 0||t.call(this);const{menuProps:a}=this;return d(so,Object.assign({},a,{ref:"cascaderMenuInstRef",class:[this.themeClass,a==null?void 0:a.class],value:this.mergedValue,show:this.mergedShow&&!this.showSelectMenu,menuModel:this.menuModel,style:[this.cssVars,a==null?void 0:a.style],onFocus:this.handleMenuFocus,onBlur:this.handleMenuBlur,onKeydown:this.handleMenuKeydown,onMousedown:this.handleMenuMousedown,onTabout:this.handleMenuTabout}),{action:()=>{var n,h;return(h=(n=this.$slots).action)===null||h===void 0?void 0:h.call(n)},empty:()=>{var n,h;return(h=(n=this.$slots).empty)===null||h===void 0?void 0:h.call(n)}})}}),d(Ye,{key:"selectMenu",ref:"selectMenuFollowerRef",show:this.mergedShow&&this.showSelectMenu,containerClass:this.namespace,width:"target",placement:this.placement,to:this.adjustedTo,teleportDisabled:this.adjustedTo===Re.tdkey},{default:()=>{var t;(t=this.onRender)===null||t===void 0||t.call(this);const{filterMenuProps:a}=this;return d(uo,Object.assign({},a,{ref:"selectMenuInstRef",class:[this.themeClass,a==null?void 0:a.class],value:this.mergedValue,show:this.mergedShow&&this.showSelectMenu,pattern:this.pattern,multiple:this.multiple,tmNodes:this.treeMate.treeNodes,filter:this.filter,labelField:this.labelField,separator:this.separator,style:[this.cssVars,a==null?void 0:a.style]}))}})]}))}});export{vo as N};
