import{useRoute as P,useRouter as j}from"./vue-router-66374999.js";import{n as N}from"./nomorlize_q-4ee1d2af.js";import{q as D}from"./define_basic_qtypes-ddf25d69.js";import{A as z}from"./APIHelper-697d5a21.js";import{aZ as _,a8 as o,l as r,t as p,aE as d,s as i,b7 as l,m as u,F as L,ae as H,bd as m,bc as k,k as s}from"./runtime-core.esm-bundler-42be6625.js";import{b as c}from"./Button-cc4d8cf9.js";import"./light-061b806c.js";import"./format-length-c9d165c6.js";import"./Icon-9bae1ecc.js";import"./Warning-342b5d14.js";import"./Close-7ee9b945.js";import"./Scrollbar-56892bdd.js";import"./runtime-dom.esm-bundler-4c01a608.js";import"./keysOf-5d5107c5.js";import"./use-memo-8d560c6d.js";import"./resolve-slot-612957d7.js";import"./FadeInExpandTransition-8360c680.js";import"./call-7e0089d6.js";const O={style:{width:"18.76cm","line-height":"normal"},id:"oonom"},R={class:"noprint"},V={class:"labi-container"},G={key:0,style:{"font-size":"6.5pt","font-family":"Cambria , 仿宋",margin:"0px"}},J={key:1,style:{"text-align":"center","font-family":"Cambria , 仿宋",margin:"0px"}},Q={style:{"font-size":"10pt"}},Z={style:{"font-size":"6.5pt"}},K={style:{"font-family":"'courier new'"}},W={key:2,style:{"text-align":"center","font-family":"黑体",margin:"0px"}},X={style:{"font-size":"10pt"}},Y=["onClick","data_type"],tt={key:0,style:{"font-size":"6.5pt",margin:"0px","font-family":"Cambria , 仿宋"}},et={style:{"font-family":"'courier new'"}},nt={style:{"font-family":"'courier new'"}},ot={key:0},rt={key:1},it=["innerHTML"],lt={key:2},st=["innerHTML"],at={key:3},ut=["innerHTML"],pt={key:5},dt=["src"],mt={key:6},ct=["src"],Mt={__name:"preexport-1",setup(_t){const S=P(),M=j(),a=_({q:!0,a:!1,p:!1}),b=_(0),g=_(0),$=3,x=3,C=_(""),f=_({});z.post("/api/group/get",{id:S.params.id}).then(n=>{n.entry.split(",").forEach(t=>{f.value[t]=D}),_(!1),C.value=n.title,Promise.all(n.entry.split(",").map(t=>new Promise((e,y)=>{z.get("/api/qapi/get/"+t).then(h=>{f.value[t]=h})}))).then(()=>{})});const v=n=>JSON.parse(n),E=n=>Object.entries(n).map(t=>t[1]),w=_(n=>{}),I=n=>{f.value[n]._extb_height=(f.value[n]._extb_height||0)+50,console.log(f.value[n]._extb_height)},q=_(1),A=()=>{localStorage.setItem("___thost___html_export",document.getElementById("corehtml").outerHTML),M.push("/grouping/preexport-2/"+S.params.id)},T=_("Cambria , 宋体"),B=()=>{T.value="Times New Roman , 宋体!important"},F=()=>{document.querySelectorAll("table[name=optionsTable]").forEach(t=>{if(t.querySelectorAll("td").length==4){console.log("oo",t);let e=[],y=1;t.querySelectorAll("td").forEach(h=>{e.push(h.outerHTML)}),t.addEventListener("click",()=>{console.log("click");const{ctn:h,next_lns:U}=n(e,y);t.innerHTML=h,y=U})}});function n(t,e){if(e==1)return{ctn:"<tbody><tr>"+t.join("")+"</tr></tbody>",next_lns:2};if(e==2)return{ctn:`<tbody><tr>${t[0]}${t[1]}</tr><tr>${t[2]}${t[3]}</tr></tbody>`,next_lns:4};if(e==4)return{ctn:"<tbody><tr>"+t.join("</tr><tr>")+"</tr></tbody>",next_lns:1}}};return(n,t)=>(o(),r(L,null,[p(l(c),{class:"noprint",onClick:t[0]||(t[0]=e=>a.value.q=!a.value.q)},{default:d(()=>[i("Q")]),_:1}),p(l(c),{class:"noprint",onClick:t[1]||(t[1]=e=>a.value.a=!a.value.a)},{default:d(()=>[i("A")]),_:1}),p(l(c),{class:"noprint",onClick:t[2]||(t[2]=e=>a.value.p=!a.value.p)},{default:d(()=>[i("P")]),_:1}),p(l(c),{class:"noprint",onClick:t[3]||(t[3]=e=>w.value=I)},{default:d(()=>[i("单击题面时增加空格")]),_:1}),p(l(c),{class:"noprint",onClick:B},{default:d(()=>[i("字体转为Times")]),_:1}),p(l(c),{class:"noprint",onClick:t[4]||(t[4]=e=>q.value==2?q.value=1:q.value=2)},{default:d(()=>[i("改变列数 ")]),_:1}),p(l(c),{class:"noprint",onClick:t[5]||(t[5]=e=>{w.value=()=>{},F()})},{default:d(()=>[i("修正opttable")]),_:1}),p(l(c),{class:"noprint",onClick:t[6]||(t[6]=e=>n.Noptions_ret2=!0)},{default:d(()=>[i("Retheme 2")]),_:1}),p(l(c),{class:"noprint",onClick:t[7]||(t[7]=e=>b.value++)},{default:d(()=>[i("Title format")]),_:1}),p(l(c),{class:"noprint",onClick:t[8]||(t[8]=e=>g.value++)},{default:d(()=>[i("Info format")]),_:1}),p(l(c),{class:"noprint",onClick:t[9]||(t[9]=e=>A())},{default:d(()=>[i("进入不包含fixed content的修正页面")]),_:1}),u("div",O,[u("div",R,[u("div",V,[(o(),r(L,null,H([1,2,3,4,5,6,7],e=>u("div",{class:"labi-block",key:e,style:{height:"1045px"}},"Page # "+m(e),1)),64))])]),u("div",{id:"corehtml",style:k({width:"18.76cm",columns:q.value,"line-height":"normal"})},[b.value%$==0?(o(),r("p",G," Generated by thost | Group UUID: "+m(n.$route.params.id)+" | Title: "+m(C.value),1)):s("",!0),b.value%$==1?(o(),r("div",J,[u("p",Q,m(C.value),1),u("p",Z,[i("Generated by thost | UUID: "),u("span",K,m(n.$route.params.id),1)])])):s("",!0),b.value%$==2?(o(),r("div",W,[u("p",X,m(C.value),1)])):s("",!0),(o(!0),r(L,null,H(E(f.value),(e,y)=>(o(),r("div",{key:e.id,onClick:h=>w.value(e.id),data_type:v(e.extra).info[0],class:"___core_block"},[g.value%x==0?(o(),r("p",tt,[i(" UUID:"),u("span",et,m(e.id),1),i(" | qid:"),u("span",nt,m(e.qid),1),i(),a.value.q?(o(),r("span",ot,"| "+m(v(e.extra).info[0])+" | "+m(v(e.extra).info[1])+" | Origin: "+m(v(e.extra).from),1)):s("",!0)])):s("",!0),g.value%x==0?(o(),r("div",rt,[a.value.q?(o(),r("div",{key:0,innerHTML:l(N)(e.q,{ret2:n.Noptions_ret2}),style:k({fontSize:"9.5pt",fontFamily:T.value})},null,12,it)):s("",!0)])):s("",!0),g.value%x==1?(o(),r("div",lt,[a.value.q?(o(),r("div",{key:0,innerHTML:"<strong>"+(y+1)+".</strong> ("+v(e.extra).info[0]+","+v(e.extra).info[1]+") "+l(N)(e.q,{ret2:n.Noptions_ret2}),style:k({fontSize:"9.5pt",fontFamily:T.value})},null,12,st)):s("",!0)])):s("",!0),g.value%x==2?(o(),r("div",at,[a.value.q?(o(),r("div",{key:0,innerHTML:"<strong>"+(y+1)+".</strong> "+l(N)(e.q,{ret2:n.Noptions_ret2}),style:k({fontSize:"9.5pt",fontFamily:T.value})},null,12,ut)):s("",!0)])):s("",!0),a.value.q?(o(),r("div",{key:4,style:k({display:"block",height:(e._extb_height||0)+"px"})},null,4)):s("",!0),a.value.a?(o(),r("div",pt,[u("img",{src:"/oss-storage/"+e.a.replace("<answerparser>","").replace("</answerparser>","").split("|")[0]+".png"},null,8,dt)])):s("",!0),a.value.p?(o(),r("div",mt,[u("img",{src:"/oss-storage/"+e.a.replace("<answerparser>","").replace("</answerparser>","").split("|")[1]+".png"},null,8,ct)])):s("",!0)],8,Y))),128))],4)])],64))}};export{Mt as default};
