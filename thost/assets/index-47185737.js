import{useRoute as de,useRouter as fe}from"./vue-router-3740985a.js";import{n as pe}from"./toScreenDisplay-d37bc74f.js";import{q as ve}from"./define_basic_qtypes-ddf25d69.js";import{A as O}from"./APIHelper-e0fd8d04.js";import{s as me}from"./sweetalert.min-9dab74b7.js";import{_ as he}from"./_plugin-vue_export-helper-c27b6911.js";import{N as ge}from"./Checkbox-9546fcc9.js";import{u as be}from"./use-memo-b9add725.js";import{u as ke,a as xe}from"./use-collection-26725bb7.js";import{g as ye}from"./attribute-2ee9e579.js";import{d as S,l as q,u as oe,n as _e,a as Ce,o as Te,p as Q,e as L,f as V,b as we,g as ne,h as Re}from"./light-185f79ed.js";import{v as W,aZ as h,i as z,a2 as re,_ as ie,J as N,O as Be,b3 as le,az as ae,aa as Ae,X as Se,a8 as T,l as A,t as k,aE as x,s as _,b7 as c,m as $,F as U,ae as Y,j as K,bd as I,k as j,bc as $e,ab as Ne,a9 as Ee}from"./runtime-core.esm-bundler-c066f4bf.js";import{k as se,N as Pe,a as Z}from"./Scrollbar-431c7fad.js";import{b as Oe}from"./next-frame-once-7035a838.js";import{t as He}from"./throttle-22333170.js";import{o as ze}from"./Popover-fc210933.js";import{N as ee}from"./Image-cddb783e.js";import{N as je}from"./ImageGroup-5c74b19a.js";import{a as H}from"./Button-0891d5bc.js";import{N as te}from"./Spin-50ab12f9.js";import{N as Ie}from"./text-1cb1d253.js";import"./format-length-c9d165c6.js";import"./Icon-13ca7aa7.js";import"./Warning-9f568e6f.js";import"./Close-869cd549.js";import"./runtime-dom.esm-bundler-caa8590e.js";import"./_commonjsHelpers-725317a4.js";import"./use-merged-state-89f8109f.js";import"./FadeInExpandTransition-ff940b4d.js";import"./fade-in-scale-up.cssr-3d9943f6.js";import"./flatten-a133123b.js";import"./use-false-until-truthy-a506b738.js";import"./get-af977d88.js";import"./utils-d7fa52af.js";import"./use-compitable-42538ef7.js";import"./Tooltip-1dec7089.js";import"./use-locale-c50998bd.js";import"./index-975a2d8f.js";import"./light-3faebb88.js";function ce(t){return typeof t=="string"?document.querySelector(t):typeof t=="function"?t():t}function qe(t){return t instanceof HTMLElement?t.scrollTop:window.scrollY}function Le(t){return t instanceof HTMLElement?t.getBoundingClientRect():{top:0,bottom:window.innerHeight}}const Fe=S("affix",[q("affixed",{position:"fixed"},[q("absolute-positioned",{position:"absolute"})])]),J={listenTo:[String,Object,Function],top:Number,bottom:Number,triggerTop:Number,triggerBottom:Number,position:{type:String,default:"fix"},offsetTop:{type:Number,validator:()=>!0,default:void 0},offsetBottom:{type:Number,validator:()=>!0,default:void 0},target:{type:Function,validator:()=>!0,default:void 0}},Me=se(J),De=W({name:"Affix",props:J,setup(t){const{mergedClsPrefixRef:a}=oe(t);_e("-affix",Fe,a);let l=null;const n=h(!1),s=h(!1),p=h(null),g=h(null),u=z(()=>s.value||n.value),b=z(()=>{var o,e;return(e=(o=t.triggerTop)!==null&&o!==void 0?o:t.offsetTop)!==null&&e!==void 0?e:t.top}),y=z(()=>{var o,e;return(e=(o=t.top)!==null&&o!==void 0?o:t.triggerTop)!==null&&e!==void 0?e:t.offsetTop}),E=z(()=>{var o,e;return(e=(o=t.bottom)!==null&&o!==void 0?o:t.triggerBottom)!==null&&e!==void 0?e:t.offsetBottom}),w=z(()=>{var o,e;return(e=(o=t.triggerBottom)!==null&&o!==void 0?o:t.offsetBottom)!==null&&e!==void 0?e:t.bottom}),B=h(null),P=()=>{const{target:o,listenTo:e}=t;o?l=o():e?l=ce(e):l=document,l&&(l.addEventListener("scroll",d),d())};function d(){Oe(v)}function v(){const{value:o}=B;if(!l||!o)return;const e=qe(l);if(u.value){e<g.value&&(n.value=!1,g.value=null),e>p.value&&(s.value=!1,p.value=null);return}const r=Le(l),i=o.getBoundingClientRect(),C=i.top-r.top,R=r.bottom-i.bottom,m=b.value,f=w.value;m!==void 0&&C<=m?(n.value=!0,g.value=e-(m-C)):(n.value=!1,g.value=null),f!==void 0&&R<=f?(s.value=!0,p.value=e+f-R):(s.value=!1,p.value=null)}return re(()=>{P()}),ie(()=>{l&&l.removeEventListener("scroll",d)}),{selfRef:B,affixed:u,mergedClsPrefix:a,mergedstyle:z(()=>{const o={};return n.value&&b.value!==void 0&&y.value!==void 0&&(o.top=`${y.value}px`),s.value&&w.value!==void 0&&E.value!==void 0&&(o.bottom=`${E.value}px`),o})}},render(){const{mergedClsPrefix:t}=this;return N("div",{ref:"selfRef",class:[`${t}-affix`,{[`${t}-affix--affixed`]:this.affixed,[`${t}-affix--absolute-positioned`]:this.position==="absolute"}],style:this.mergedstyle},this.$slots)}}),We={linkFontSize:"13px",linkPadding:"0 0 0 16px",railWidth:"4px"},Ge=t=>{const{borderRadius:a,railColor:l,primaryColor:n,primaryColorHover:s,primaryColorPressed:p,textColor2:g}=t;return Object.assign(Object.assign({},We),{borderRadius:a,railColor:l,railColorActive:n,linkColor:Te(n,{alpha:.15}),linkTextColor:g,linkTextColorHover:s,linkTextColorPressed:p,linkTextColorActive:n})},Ve={name:"Anchor",common:Ce,self:Ge},Ue=Ve,Ke=S("anchor",`
 position: relative;
`,[Q("block",`
 padding-left: var(--n-rail-width);
 `,[S("anchor-link",[L("+, >",[S("anchor-link",`
 margin-top: .5em;
 `)])]),S("anchor-link-background",`
 max-width: 0;
 border-top-right-radius: 10.5px;
 border-bottom-right-radius: 10.5px;
 `),Q("show-rail",[L(">",[S("anchor-link","padding-left: 0;")])])]),q("block",[S("anchor-link",`
 margin-bottom: 4px;
 padding: 2px 8px;
 transition: background-color .3s var(--n-bezier);
 background-color: transparent;
 border-radius: var(--n-link-border-radius);
 `,[q("active",`
 background-color: var(--n-link-color);
 `)])]),S("anchor-link-background",`
 position: absolute;
 left: calc(var(--n-rail-width) / 2);
 width: 100%;
 background-color: var(--n-link-color);
 transition:
 top .15s var(--n-bezier),
 max-width .15s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `),S("anchor-rail",`
 position: absolute;
 left: 0;
 top: 0;
 bottom: 0;
 width: var(--n-rail-width);
 border-radius: calc(var(--n-rail-width) / 2);
 overflow: hidden;
 transition: background-color .3s var(--n-bezier);
 background-color: var(--n-rail-color);
 `,[V("bar",`
 position: absolute;
 left: 0;
 width: var(--n-rail-width);
 height: 21px;
 background-color: #0000;
 transition: 
 top .15s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `,[q("active",{backgroundColor:"var(--n-rail-color-active)"})])]),S("anchor-link",`
 padding: var(--n-link-padding);
 position: relative;
 line-height: 1.5;
 font-size: var(--n-link-font-size);
 min-height: 1.5em;
 display: flex;
 flex-direction: column;
 `,[q("active",[L(">",[V("title",`
 color: var(--n-link-text-color-active);
 `)])]),V("title",`
 outline: none;
 max-width: 100%;
 text-decoration: none;
 white-space: nowrap;
 text-overflow: ellipsis;
 overflow: hidden;
 cursor: pointer;
 display: inline-block;
 padding-right: 16px;
 transition: color .3s var(--n-bezier);
 color: var(--n-link-text-color);
 `,[L("&:hover, &:focus",`
 color: var(--n-link-text-color-hover);
 `),L("&:active",`
 color: var(--n-link-text-color-pressed);
 `)])])]),D=we("n-anchor"),Je={title:String,href:String},Xe=W({name:"AnchorLink",props:Je,setup(t,{slots:a}){const l=h(null),n=Be(D),s=le(t,"href"),p=be(()=>s.value&&s.value===n.activeHref.value);ke(D,"collectedLinkHrefs",s),xe(D,"titleEls",()=>l.value),ae(p,u=>{u&&l.value&&n.updateBarPosition(l.value)});function g(){t.href!==void 0&&n.setActiveHref(t.href)}return()=>{var u;const{value:b}=n.mergedClsPrefix;return N("div",{class:[`${b}-anchor-link`,p.value&&`${b}-anchor-link--active`]},N("a",{ref:l,class:[`${b}-anchor-link__title`],href:t.href,title:ye(t.title),onClick:g},t.title),(u=a.default)===null||u===void 0?void 0:u.call(a))}}});function Qe(t,a){const{top:l,height:n}=t.getBoundingClientRect(),s=a instanceof HTMLElement?a.getBoundingClientRect().top:0;return{top:l-s,height:n}}const X={type:{type:String,default:"rail"},showRail:{type:Boolean,default:!0},showBackground:{type:Boolean,default:!0},bound:{type:Number,default:12},internalScrollable:Boolean,ignoreGap:Boolean,offsetTarget:[String,Object,Function]},Ye=se(X),Ze=W({name:"BaseAnchor",props:Object.assign(Object.assign({},X),{mergedClsPrefix:{type:String,required:!0}}),setup(t){const a=[],l=[],n=h(null),s=h(null),p=h(null),g=h(null),u=z(()=>t.type==="block"),b=z(()=>!u.value&&t.showRail);function y(){const{value:d}=p,{value:v}=s;d&&(d.style.transition="none"),v&&(v.style.transition="none"),l&&l.forEach(o=>{o.style.transition="none"}),Se(()=>{const{value:o}=p,{value:e}=s;o&&(o.offsetWidth,o.style.transition=""),e&&(e.offsetWidth,e.style.transition=""),l&&l.forEach(r=>{r.offsetWidth,r.style.transition=""})})}function E(d,v=!0){const{value:o}=p,{value:e}=s,{value:r}=g;if(!r||!o)return;v||(o.style.transition="none",e&&(e.style.transition="none"));const{offsetHeight:i,offsetWidth:C}=d,{top:R,left:m}=d.getBoundingClientRect(),{top:f,left:F}=r.getBoundingClientRect(),M=R-f,G=m-F;o.style.top=`${M}px`,o.style.height=`${i}px`,e&&(e.style.top=`${M}px`,e.style.height=`${i}px`,e.style.maxWidth=`${C+G}px`),o.offsetHeight,e&&e.offsetHeight,v||(o.style.transition="",e&&(e.style.transition=""))}function w(d,v=!0){const o=/^#([^#]+)$/.exec(d);if(!o)return;const e=document.getElementById(o[1]);e&&(n.value=d,e.scrollIntoView(),v||y(),B())}const B=He(()=>{P(!0)},128);function P(d=!0){var v;const o=[],e=ce((v=t.offsetTarget)!==null&&v!==void 0?v:document);a.forEach(m=>{const f=/#([^#]+)$/.exec(m);if(!f)return;const F=document.getElementById(f[1]);if(F&&e){const{top:M,height:G}=Qe(F,e);o.push({top:M,height:G,href:m})}}),o.sort((m,f)=>m.top>f.top?1:(m.top===f.top&&m.height<f.height,-1));const r=n.value,{bound:i,ignoreGap:C}=t,R=o.reduce((m,f)=>f.top+f.height<0?C?f:m:f.top<=i?m===null?f:f.top===m.top?f.href===r?f:m:f.top>m.top?f:m:m,null);d||y(),R?n.value=R.href:n.value=null}return Ae(D,{activeHref:n,mergedClsPrefix:le(t,"mergedClsPrefix"),updateBarPosition:E,setActiveHref:w,collectedLinkHrefs:a,titleEls:l}),re(()=>{document.addEventListener("scroll",B,!0),w(window.location.hash),P(!1)}),ze(()=>{w(window.location.hash),P(!1)}),ie(()=>{document.removeEventListener("scroll",B,!0)}),ae(n,d=>{if(d===null){const{value:v}=s;v&&!u.value&&(v.style.maxWidth="0")}}),{selfRef:g,barRef:p,slotRef:s,setActiveHref:w,activeHref:n,isBlockType:u,mergedShowRail:b}},render(){var t;const{mergedClsPrefix:a,mergedShowRail:l,isBlockType:n,$slots:s}=this,p=N("div",{class:[`${a}-anchor`,n&&`${a}-anchor--block`,l&&`${a}-anchor--show-rail`],ref:"selfRef"},l&&this.showBackground?N("div",{ref:"slotRef",class:`${a}-anchor-link-background`}):null,l?N("div",{class:`${a}-anchor-rail`},N("div",{ref:"barRef",class:[`${a}-anchor-rail__bar`,this.activeHref!==null&&`${a}-anchor-rail__bar--active`]})):null,(t=s.default)===null||t===void 0?void 0:t.call(s));return this.internalScrollable?N(Pe,null,{default:()=>p}):p}}),et=Object.assign(Object.assign(Object.assign(Object.assign({},ne.props),{affix:Boolean}),J),X),tt=W({name:"Anchor",props:et,setup(t,{slots:a}){const{mergedClsPrefixRef:l,inlineThemeDisabled:n}=oe(t),s=ne("Anchor","-anchor",Ke,Ue,t,l),p=h(null),g=z(()=>{const{self:{railColor:b,linkColor:y,railColorActive:E,linkTextColor:w,linkTextColorHover:B,linkTextColorPressed:P,linkTextColorActive:d,linkFontSize:v,railWidth:o,linkPadding:e,borderRadius:r},common:{cubicBezierEaseInOut:i}}=s.value;return{"--n-link-border-radius":r,"--n-link-color":y,"--n-link-font-size":v,"--n-link-text-color":w,"--n-link-text-color-hover":B,"--n-link-text-color-active":d,"--n-link-text-color-pressed":P,"--n-link-padding":e,"--n-bezier":i,"--n-rail-color":b,"--n-rail-color-active":E,"--n-rail-width":o}}),u=n?Re("anchor",void 0,g,t):void 0;return{scrollTo(b){var y;(y=p.value)===null||y===void 0||y.setActiveHref(b)},renderAnchor:()=>(u?.onRender(),N(Ze,Object.assign({ref:p,style:n?void 0:g.value,class:u?.themeClass.value},Z(t,Ye),{mergedClsPrefix:l.value}),a))}},render(){return this.affix?N(De,Object.assign({},Z(this,Me)),{default:this.renderAnchor}):this.renderAnchor()}});const ue=t=>(Ne("data-v-56e97e0e"),t=t(),Ee(),t),ot={style:{width:"18.76cm","line-height":"normal"},id:"oonom"},nt=ue(()=>$("div",{class:"noprint"},null,-1)),rt={id:"corehtml",style:{width:"18.76cm",columns:1,"line-height":"normal"}},it={style:{"font-size":"9.5pt","font-family":"Cambria , fangsong",margin:"0px"}},lt=["id"],at={style:{"font-size":"9.5pt",margin:"0px","font-family":"Cambria , 仿宋"}},st={style:{"font-family":"'courier new'"}},ct={style:{"font-family":"'courier new'"}},ut={key:0},dt=["innerHTML"],ft={key:2},pt=["src"],vt={key:3},mt=["src"],ht={key:4},gt=ue(()=>$("div",null,null,-1)),bt={__name:"index",setup(t){const a=de(),l=fe(),n=h({q:!0,a:!1,p:!1}),s=h({}),p=h(!1),g=h(""),u=h({});O.post("/api/group/get",{id:a.params.id}).then(e=>{e.entry.split(",").forEach(r=>{u.value[r]=ve}),e.entry.split(","),g.value=e.title,Promise.all(e.entry.split(",").map(r=>new Promise((i,C)=>{O.get("/api/qapi/get/"+r).then(R=>{u.value[r]=R}),P(r)}))).then(()=>{})});const b=e=>JSON.parse(e),y=h({}),E=e=>Object.entries(e).map(r=>r[1]),w=async e=>{console.log(e),await O.post("/api/qapi/doneinfo/mark",{quuid:e.id,timestamp:new Date().getTime(),displayednote:"",note:"",rate:50,bankid:e.bankid})},B=async()=>{Promise.all(Object.entries(u.value).map(e=>w(e[1]))).then(e=>{me("ok.")})},P=async e=>{y.value[e]=await O.get("/api/qapi/doneinfo/getbyquuid/"+e)},d=h(!1),v=h({}),o=e=>{console.log(e),d.value=e,d.value&&Object.entries(u.value).forEach(r=>{console.log(r),O.get("/api/xkw-helper/get_more_detail/600/"+r[1].bankid+"/"+r[1].qid).then(i=>{v.value[r[1].id]={a:O.host+"/api/xkw-helper/route-pic?purl="+btoa(i.data.answerImg.replace("@2","@3").replace("c2","c1")),p:O.host+"/api/xkw-helper/route-pic?purl="+btoa(i.data.parseImg.replace("@2","@3").replace("c2","c1"))}})})};return(e,r)=>(T(),A(U,null,[k(c(H),{class:"noprint",onClick:r[0]||(r[0]=i=>n.value.q=!n.value.q)},{default:x(()=>[_("Q")]),_:1}),k(c(H),{class:"noprint",onClick:r[1]||(r[1]=i=>n.value.a=!n.value.a)},{default:x(()=>[_("A")]),_:1}),k(c(H),{class:"noprint",onClick:r[2]||(r[2]=i=>n.value.p=!n.value.p)},{default:x(()=>[_("P")]),_:1}),k(c(H),{onClick:r[3]||(r[3]=i=>c(l).push("/grouping/preexport-1/"+c(a).params.id))},{default:x(()=>[_("开始准备打印")]),_:1}),k(c(H),{onClick:r[4]||(r[4]=i=>c(l).push("/grouping/preexport-1/"+c(a).params.id+"/word_tailored_version"))},{default:x(()=>[_("开始准备优化并嵌入Word")]),_:1}),k(c(H),{onClick:r[5]||(r[5]=i=>c(l).push("/export/"+c(a).params.id+"/a"))},{default:x(()=>[_("打印答案")]),_:1}),k(c(H),{onClick:B},{default:x(()=>[_("将本group内所有试题标记为done")]),_:1}),k(c(ge),{checked:d.value,"onUpdate:checked":[r[6]||(r[6]=i=>d.value=i),o]},{default:x(()=>[_(" 直接从组卷网获取答案解析数据而非从oss缓存 ")]),_:1},8,["checked"]),$("div",ot,[nt,k(c(tt),{"show-rail":!0,"show-background":!0},{default:x(()=>[(T(!0),A(U,null,Y(E(u.value),(i,C)=>(T(),K(c(Xe),{title:"第"+(C+1)+"题",href:"#"+(C+1)},null,8,["title","href"]))),256))]),_:1}),k(c(je),null,{default:x(()=>[$("div",rt,[$("p",it,"Generated by thost | Group UUID: "+I(e.$route.params.id)+" | Title: "+I(g.value),1),(T(!0),A(U,null,Y(E(u.value),(i,C)=>(T(),A("div",{key:i.id,id:C+1},[$("p",at,[_("UUID:"),$("span",st,I(i.id),1),_(" | qid:"),$("span",ct,I(i.qid),1),_(),n.value.q?(T(),A("span",ut,"| Info: "+I(b(i.extra).info)+" | Origin: "+I(b(i.extra).from),1)):j("",!0)]),n.value.q?(T(),A("div",{key:0,innerHTML:c(pe)(i.q,{ret2:p.value,tindex:C+1}),style:{fontSize:"12pt",fontFamily:"Cambria"}},null,8,dt)):j("",!0),n.value.q?(T(),A("div",{key:1,style:$e({display:"block",height:(i._extb_height||0)+"px"})},null,4)):j("",!0),n.value.a&&!d.value?(T(),A("div",ft,[$("img",{src:c(O).host+"/oss-storage/"+i.a.replace("<answerparser>","").replace("</answerparser>","").split("|")[0]+".png"},null,8,pt)])):j("",!0),n.value.p&&!d.value?(T(),A("div",vt,[$("img",{src:c(O).host+"/oss-storage/"+i.a.replace("<answerparser>","").replace("</answerparser>","").split("|")[1]+".png"},null,8,mt)])):j("",!0),d.value?(T(),A("div",ht,[n.value.a||s.value[i.id]?(T(),K(c(ee),{key:0,lazy:"",src:(v.value[i.id]||{a:""}).a,width:700},{placeholder:x(()=>[k(c(te))]),_:2},1032,["src"])):j("",!0),n.value.a||s.value[i.id]?(T(),K(c(ee),{key:1,lazy:"",src:(v.value[i.id]||{p:""}).p,width:700},{placeholder:x(()=>[k(c(te))]),_:2},1032,["src"])):j("",!0),gt])):j("",!0),k(c(H),{text:"",onClick:R=>w(i)},{default:x(()=>[_("标记为已完成")]),_:2},1032,["onClick"]),k(c(Ie),null,{default:x(()=>[_("完成状态："+I(y.value[i.id]),1)]),_:2},1024),k(c(H),{onClick:R=>s.value[i.id]=!0},{default:x(()=>[_("显示本题答案")]),_:2},1032,["onClick"])],8,lt))),128))])]),_:1})])],64))}},ro=he(bt,[["__scopeId","data-v-56e97e0e"]]);export{ro as default};
