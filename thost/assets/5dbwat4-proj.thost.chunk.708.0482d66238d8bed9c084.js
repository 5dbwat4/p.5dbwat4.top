"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[708],{9708:(e,t,a)=>{a.r(t),a.d(t,{default:()=>_});var l=a(7875),n=a(641),u=a(2240),i=a(8),s=a(4849),v=a(5093),o=a(3959),c=a(3923),d=a(5473),h=a(7972);const r={key:0},p=[(0,l._)("span",null,"正在查询Syncbatch状态",-1)],f={key:1},y=(0,l._)("span",null,"尚未开始Syncbatch",-1),k=(0,l.Uk)("现在开始"),w={key:2},S=(0,l._)("span",null,"已经开始Syncbatch",-1),m={key:0},U=(0,l.Uk)("修改Title"),g=(0,l.Uk)("保存为Group"),j=(0,l.Uk)("终止"),b=(0,l.Uk)("View"),Z=(0,l._)("div",null,null,-1),_={setup(e){c.Z.registerLanguage("json",d.Z);const t=(0,n.iH)(0),a=(0,n.iH)({started:!1,currentids:[],title:""}),_=(0,n.iH)("");fetch("/api/syncbatch/sync-session").then((e=>e.json())).then((e=>{a.value=e.data,t.value=1,a.value.started&&(_.value=a.value.title,W())}));const C=()=>{t.value=2,fetch("/api/syncbatch/start-session",{method:"POST",body:JSON.stringify({title:_.value,time:(new Date).getTime()}),headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{a.value=e.data,t.value=1,W()}))};let T=!0;(0,h.onBeforeRouteLeave)((()=>{T=!1}));const W=()=>{t.value=2,fetch("/api/syncbatch/sync-session").then((e=>e.json())).then((e=>{a.value=e.data,t.value=1,T&&setTimeout(W,1500)}))},D=()=>{t.value=2,fetch("/api/syncbatch/edit-title",{method:"POST",body:JSON.stringify({title:_.value}),headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{a.value=e.data,t.value=1}))},H=()=>{t.value=2,fetch("/api/syncbatch/kill-session").then((e=>e.json())).then((e=>{t.value=1}))},O=(0,n.iH)(!1),q=(0,n.iH)(!1),J=(0,n.iH)(""),N=()=>{O.value=!0,fetch("/api/group/new",{method:"POST",body:JSON.stringify({entry:a.value.currentids.join(","),timestamp:(new Date).getTime(),title:a.value.title,desc:""}),headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{O.value=!1,q.value=!0,J.value=e.id}))};return(e,d)=>((0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)((0,n.SU)(u.Z),{hljs:(0,n.SU)(c.Z)},{default:(0,l.w5)((()=>[0==t.value?((0,l.wg)(),(0,l.iD)("div",r,p)):(0,l.kq)("v-if",!0),1!=t.value||a.value.started?(0,l.kq)("v-if",!0):((0,l.wg)(),(0,l.iD)("div",f,[y,(0,l.Wm)((0,n.SU)(i.Z),{value:_.value,"onUpdate:value":d[0]||(d[0]=e=>_.value=e)},null,8,["value"]),(0,l.Wm)((0,n.SU)(s.Z),{onClick:C},{default:(0,l.w5)((()=>[k])),_:1})])),a.value.started?((0,l.wg)(),(0,l.iD)("div",w,[S,2==t.value?((0,l.wg)(),(0,l.iD)("span",m,"正在发送API请求")):(0,l.kq)("v-if",!0),(0,l.Wm)((0,n.SU)(v.Z),{show:2==t.value},{default:(0,l.w5)((()=>{return[(0,l.Wm)((0,n.SU)(o.Z),{code:(e=a.value,JSON.stringify(e,void 0,4))},null,8,["code"])];var e})),_:1},8,["show"]),(0,l.Wm)((0,n.SU)(i.Z),{value:_.value,"onUpdate:value":d[1]||(d[1]=e=>_.value=e)},null,8,["value"]),(0,l.Wm)((0,n.SU)(s.Z),{onClick:D},{default:(0,l.w5)((()=>[U])),_:1}),(0,l.Wm)((0,n.SU)(s.Z),{onClick:N},{default:(0,l.w5)((()=>[g])),_:1}),(0,l.Wm)((0,n.SU)(s.Z),{onClick:H},{default:(0,l.w5)((()=>[j])),_:1}),q.value?((0,l.wg)(),(0,l.j4)((0,n.SU)(s.Z),{key:1,onClick:d[2]||(d[2]=t=>e.$router.push("/group/"+J.value))},{default:(0,l.w5)((()=>[b])),_:1})):(0,l.kq)("v-if",!0)])):(0,l.kq)("v-if",!0)])),_:1},8,["hljs"]),Z],64))}}}}]);