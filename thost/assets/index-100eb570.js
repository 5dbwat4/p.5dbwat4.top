import{useRoute as $,useRouter as G}from"./vue-router-66374999.js";import{n as U}from"./nomorlize_q-4ee1d2af.js";import{q as j}from"./define_basic_qtypes-ddf25d69.js";import{A as y}from"./APIHelper-697d5a21.js";import{s as B}from"./sweetalert.min-9dab74b7.js";import{N as E}from"./Checkbox-af2f1a0a.js";import{N as x,a as F}from"./Image-70b0c8b6.js";import{aZ as d,a8 as p,l as m,t as i,aE as s,s as o,b7 as r,m as l,bd as c,F as N,ae as V,k as f,bc as L}from"./runtime-core.esm-bundler-42be6625.js";import{b as _}from"./Button-cc4d8cf9.js";import{N as C}from"./Spin-38bf3ba1.js";import{N as H}from"./p-b2e24c58.js";import"./light-061b806c.js";import"./format-length-c9d165c6.js";import"./Icon-9bae1ecc.js";import"./Warning-342b5d14.js";import"./Close-7ee9b945.js";import"./Scrollbar-56892bdd.js";import"./runtime-dom.esm-bundler-4c01a608.js";import"./keysOf-5d5107c5.js";import"./_commonjsHelpers-725317a4.js";import"./use-merged-state-cb002afc.js";import"./call-7e0089d6.js";import"./use-memo-8d560c6d.js";import"./fade-in-scale-up.cssr-e8e5290f.js";import"./flatten-7ea74e97.js";import"./Tooltip-455ae320.js";import"./Popover-4b12eb1a.js";import"./get-bc00c446.js";import"./utils-13313164.js";import"./FadeInExpandTransition-8360c680.js";import"./resolve-slot-612957d7.js";import"./use-compitable-85535777.js";import"./use-locale-a958ab8c.js";import"./index-975a2d8f.js";import"./light-1325cd86.js";const J={style:{width:"18.76cm","line-height":"normal"},id:"oonom"},M=l("div",{class:"noprint"},null,-1),R={id:"corehtml",style:{width:"18.76cm",columns:1,"line-height":"normal"}},K={style:{"font-size":"9.5pt","font-family":"Cambria , fangsong",margin:"0px"}},Q={style:{"font-size":"9.5pt",margin:"0px","font-family":"Cambria , 仿宋"}},W={style:{"font-family":"'courier new'"}},X={style:{"font-family":"'courier new'"}},Z={key:0},Y=["innerHTML"],ee={key:2},te=["src"],ae={key:3},re=["src"],ie={key:4},oe=l("div",null,null,-1),Ve={__name:"index",setup(ne){const g=$(),D=G(),n=d({q:!0,a:!1,p:!1}),I=d(!1),k=d(""),v=d({});y.post("/api/group/get",{id:g.params.id}).then(e=>{e.entry.split(",").forEach(t=>{v.value[t]=j}),e.entry.split(","),k.value=e.title,Promise.all(e.entry.split(",").map(t=>new Promise((a,S)=>{y.get("/api/qapi/get/"+t).then(T=>{v.value[t]=T}),O(t)}))).then(()=>{})});const b=e=>JSON.parse(e),w=d({}),A=e=>Object.entries(e).map(t=>t[1]),q=async e=>{console.log(e),await y.post("/api/qapi/doneinfo/mark",{quuid:e.id,timestamp:new Date().getTime(),displayednote:"",note:"",rate:50,bankid:e.bankid})},z=async()=>{Promise.all(Object.entries(v.value).map(e=>q(e[1]))).then(e=>{B("ok.")})},O=async e=>{w.value[e]=await y.get("/api/qapi/doneinfo/getbyquuid/"+e)},u=d(!1),h=d({}),P=e=>{console.log(e),u.value=e,u.value&&Object.entries(v.value).forEach(t=>{console.log(t),y.get("/api/xkw-helper/get_more_detail/600/"+t[1].bankid+"/"+t[1].qid).then(a=>{h.value[t[1].id]={a:"/api/xkw-helper/route-pic?purl="+btoa(a.data.answerImg.replace("@2","@3")),p:"/api/xkw-helper/route-pic?purl="+btoa(a.data.parseImg.replace("@2","@3"))}})})};return(e,t)=>(p(),m(N,null,[i(r(_),{class:"noprint",onClick:t[0]||(t[0]=a=>n.value.q=!n.value.q)},{default:s(()=>[o("Q")]),_:1}),i(r(_),{class:"noprint",onClick:t[1]||(t[1]=a=>n.value.a=!n.value.a)},{default:s(()=>[o("A")]),_:1}),i(r(_),{class:"noprint",onClick:t[2]||(t[2]=a=>n.value.p=!n.value.p)},{default:s(()=>[o("P")]),_:1}),i(r(_),{onClick:t[3]||(t[3]=a=>r(D).push("/grouping/preexport-1/"+r(g).params.id))},{default:s(()=>[o("开始准备打印")]),_:1}),i(r(_),{onClick:z},{default:s(()=>[o("将本group内所有试题标记为done")]),_:1}),i(r(E),{checked:u.value,"onUpdate:checked":[t[4]||(t[4]=a=>u.value=a),P]},{default:s(()=>[o(" 直接从组卷网获取答案解析数据而非从oss缓存 ")]),_:1},8,["checked"]),l("div",J,[M,o(),i(r(F),null,{default:s(()=>[l("div",R,[l("p",K,"Generated by thost | Group UUID: "+c(e.$route.params.id)+" | Title: "+c(k.value),1),(p(!0),m(N,null,V(A(v.value),a=>(p(),m("div",{key:a.id},[l("p",Q,[o("UUID:"),l("span",W,c(a.id),1),o(" | qid:"),l("span",X,c(a.qid),1),o(),n.value.q?(p(),m("span",Z,"| Info: "+c(b(a.extra).info)+" | Origin: "+c(b(a.extra).from),1)):f("",!0)]),n.value.q?(p(),m("div",{key:0,innerHTML:r(U)(a.q,{ret2:I.value}),style:{fontSize:"12pt",fontFamily:"Cambria"}},null,8,Y)):f("",!0),n.value.q?(p(),m("div",{key:1,style:L({display:"block",height:(a._extb_height||0)+"px"})},null,4)):f("",!0),n.value.a&&!u.value?(p(),m("div",ee,[l("img",{src:"/oss-storage/"+a.a.replace("<answerparser>","").replace("</answerparser>","").split("|")[0]+".png"},null,8,te)])):f("",!0),n.value.p&&!u.value?(p(),m("div",ae,[l("img",{src:"/oss-storage/"+a.a.replace("<answerparser>","").replace("</answerparser>","").split("|")[1]+".png"},null,8,re)])):f("",!0),u.value?(p(),m("div",ie,[i(r(x),{lazy:"",src:(h.value[a.id]||{a:""}).a},{placeholder:s(()=>[i(r(C))]),_:2},1032,["src"]),i(r(x),{lazy:"",src:(h.value[a.id]||{p:""}).p},{placeholder:s(()=>[i(r(C))]),_:2},1032,["src"]),oe])):f("",!0),i(r(_),{text:"",onClick:S=>q(a)},{default:s(()=>[o("标记为已完成")]),_:2},1032,["onClick"]),i(r(H),null,{default:s(()=>[o("完成状态："+c(w.value[a.id]),1)]),_:2},1024)]))),128))])]),_:1})])],64))}};export{Ve as default};
