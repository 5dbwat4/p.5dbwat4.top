{"version":3,"file":"use-collection-26725bb7.js","sources":["../../node_modules/naive-ui/es/_utils/composable/use-collection.js"],"sourcesContent":["import { watch, onMounted, inject, getCurrentInstance, onBeforeUnmount } from 'vue';\n// injection.collection {\n//   key1: [insta, instb]\n//   key2: [instc]\n// }\nexport function useInjectionInstanceCollection(injectionName, collectionKey, registerKeyRef) {\n    var _a;\n    const injection = inject(injectionName, null);\n    if (injection === null)\n        return;\n    const vm = (_a = getCurrentInstance()) === null || _a === void 0 ? void 0 : _a.proxy;\n    watch(registerKeyRef, registerInstance);\n    registerInstance(registerKeyRef.value);\n    onBeforeUnmount(() => {\n        registerInstance(undefined, registerKeyRef.value);\n    });\n    function registerInstance(key, oldKey) {\n        const collection = injection[collectionKey];\n        if (oldKey !== undefined)\n            removeInstance(collection, oldKey);\n        if (key !== undefined)\n            addInstance(collection, key);\n    }\n    function removeInstance(collection, key) {\n        if (!collection[key])\n            collection[key] = [];\n        collection[key].splice(collection[key].findIndex((instance) => instance === vm), 1);\n    }\n    function addInstance(collection, key) {\n        if (!collection[key])\n            collection[key] = [];\n        if (!~collection[key].findIndex((instance) => instance === vm)) {\n            collection[key].push(vm);\n        }\n    }\n}\n// injection.collection {\n//   key1: [insta.value, instb.value]\n//   key2: [instc.value]\n// }\nexport function useInjectionCollection(injectionName, collectionKey, valueRef) {\n    const injection = inject(injectionName, null);\n    if (injection === null)\n        return;\n    if (!(collectionKey in injection)) {\n        injection[collectionKey] = [];\n    }\n    injection[collectionKey].push(valueRef.value);\n    watch(valueRef, (value, prevValue) => {\n        const collectionArray = injection[collectionKey];\n        const index = collectionArray.findIndex((collectionValue) => collectionValue === prevValue);\n        if (~index)\n            collectionArray.splice(index, 1);\n        collectionArray.push(value);\n    });\n    onBeforeUnmount(() => {\n        const collectionArray = injection[collectionKey];\n        const index = collectionArray.findIndex((collectionValue) => collectionValue === valueRef.value);\n        if (~index)\n            collectionArray.splice(index, 1);\n    });\n}\n// injection.collection {\n//   key1: [insta.$el, instb.$el]\n//   key2: [instc.$el]\n// }\nexport function useInjectionElementCollection(injectionName, collectionKey, getElement) {\n    const injection = inject(injectionName, null);\n    if (injection === null)\n        return;\n    if (!(collectionKey in injection)) {\n        injection[collectionKey] = [];\n    }\n    onMounted(() => {\n        const el = getElement();\n        if (!el)\n            return;\n        injection[collectionKey].push(el);\n    });\n    onBeforeUnmount(() => {\n        const collectionArray = injection[collectionKey];\n        const element = getElement();\n        const index = collectionArray.findIndex((collectionElement) => collectionElement === element);\n        if (~index)\n            collectionArray.splice(index, 1);\n    });\n}\n"],"names":["useInjectionInstanceCollection","injectionName","collectionKey","registerKeyRef","_a","injection","inject","vm","getCurrentInstance","watch","registerInstance","onBeforeUnmount","key","oldKey","collection","removeInstance","addInstance","instance","useInjectionCollection","valueRef","value","prevValue","collectionArray","index","collectionValue","useInjectionElementCollection","getElement","onMounted","el","element","collectionElement"],"mappings":"yFAKO,SAASA,EAA+BC,EAAeC,EAAeC,EAAgB,CACzF,IAAIC,EACJ,MAAMC,EAAYC,EAAOL,EAAe,IAAI,EAC5C,GAAII,IAAc,KACd,OACJ,MAAME,GAAMH,EAAKI,EAAoB,KAAM,MAAQJ,IAAO,OAAS,OAASA,EAAG,MAC/EK,EAAMN,EAAgBO,CAAgB,EACtCA,EAAiBP,EAAe,KAAK,EACrCQ,EAAgB,IAAM,CAClBD,EAAiB,OAAWP,EAAe,KAAK,CACxD,CAAK,EACD,SAASO,EAAiBE,EAAKC,EAAQ,CACnC,MAAMC,EAAaT,EAAUH,CAAa,EACtCW,IAAW,QACXE,EAAeD,EAAYD,CAAM,EACjCD,IAAQ,QACRI,EAAYF,EAAYF,CAAG,CAClC,CACD,SAASG,EAAeD,EAAYF,EAAK,CAChCE,EAAWF,CAAG,IACfE,EAAWF,CAAG,EAAI,IACtBE,EAAWF,CAAG,EAAE,OAAOE,EAAWF,CAAG,EAAE,UAAWK,GAAaA,IAAaV,CAAE,EAAG,CAAC,CACrF,CACD,SAASS,EAAYF,EAAYF,EAAK,CAC7BE,EAAWF,CAAG,IACfE,EAAWF,CAAG,EAAI,IACjB,CAACE,EAAWF,CAAG,EAAE,UAAWK,GAAaA,IAAaV,CAAE,GACzDO,EAAWF,CAAG,EAAE,KAAKL,CAAE,CAE9B,CACL,CAKO,SAASW,EAAuBjB,EAAeC,EAAeiB,EAAU,CAC3E,MAAMd,EAAYC,EAAOL,EAAe,IAAI,EACxCI,IAAc,OAEZH,KAAiBG,IACnBA,EAAUH,CAAa,EAAI,IAE/BG,EAAUH,CAAa,EAAE,KAAKiB,EAAS,KAAK,EAC5CV,EAAMU,EAAU,CAACC,EAAOC,IAAc,CAClC,MAAMC,EAAkBjB,EAAUH,CAAa,EACzCqB,EAAQD,EAAgB,UAAWE,GAAoBA,IAAoBH,CAAS,EACtF,CAACE,GACDD,EAAgB,OAAOC,EAAO,CAAC,EACnCD,EAAgB,KAAKF,CAAK,CAClC,CAAK,EACDT,EAAgB,IAAM,CAClB,MAAMW,EAAkBjB,EAAUH,CAAa,EACzCqB,EAAQD,EAAgB,UAAWE,GAAoBA,IAAoBL,EAAS,KAAK,EAC3F,CAACI,GACDD,EAAgB,OAAOC,EAAO,CAAC,CAC3C,CAAK,EACL,CAKO,SAASE,EAA8BxB,EAAeC,EAAewB,EAAY,CACpF,MAAMrB,EAAYC,EAAOL,EAAe,IAAI,EACxCI,IAAc,OAEZH,KAAiBG,IACnBA,EAAUH,CAAa,EAAI,IAE/ByB,EAAU,IAAM,CACZ,MAAMC,EAAKF,IACNE,GAELvB,EAAUH,CAAa,EAAE,KAAK0B,CAAE,CACxC,CAAK,EACDjB,EAAgB,IAAM,CAClB,MAAMW,EAAkBjB,EAAUH,CAAa,EACzC2B,EAAUH,IACVH,EAAQD,EAAgB,UAAWQ,GAAsBA,IAAsBD,CAAO,EACxF,CAACN,GACDD,EAAgB,OAAOC,EAAO,CAAC,CAC3C,CAAK,EACL","x_google_ignoreList":[0]}