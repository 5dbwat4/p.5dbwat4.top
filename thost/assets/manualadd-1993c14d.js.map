{"version":3,"file":"manualadd-1993c14d.js","sources":["../../src/views/zujuanink-v3/views/ftc/manualadd.vue"],"sourcesContent":["<template>\r\n    <n-card title=\"手动添加错题\" v-if=\"step==1\">\r\n        <n-p>将使用来自试题篮的数据</n-p>\r\n        <n-cascader\r\n          v-model:value=\"bankid\"\r\n          :options=\"subjectsmap\"\r\n          check-strategy=\"child\"\r\n          :show-path=\"true\"\r\n        />\r\n        <n-button @click=\"confirmI\">CONFIRM</n-button>\r\n    </n-card>\r\n    \r\n    <n-card :title=\"'补充数据，添加错题('+(currentTIndex+1)+'/'+TLd.length+')'\" v-if=\"step==2\">\r\n        <n-button @click=\"step=0\">&gt; BACK</n-button>\r\n        <!-- <n-button\r\n            round\r\n            type=\"primary\"\r\n            @click=\"submitFTCadd\"\r\n          >\r\n            保存试题并创建quid\r\n          </n-button> -->\r\n        <NFormItem label=\"quid\">\r\n        <n-input disabled :value=\"FTCaddDisc.quid\"></n-input>\r\n      </NFormItem>\r\n      <NFormItem label=\"你的感想\">\r\n        <n-input type=\"textarea\" v-model:value=\"FTCaddDisc.insights\" placeholder=\"对这道题目的想法，收获的知识点，等等\"></n-input>\r\n\r\n      </NFormItem>\r\n      <NFormItem label=\"注释\">\r\n\r\n        <n-input type=\"textarea\" v-model:value=\"FTCaddDisc.note\" placeholder=\"显示在题目前的信息 e.g. 错题的小题号\"></n-input>\r\n\r\n      </NFormItem>\r\n      <NFormItem label=\"评级\">\r\n          <n-rate allow-half :count=\"10\" :on-update:value=\"(v)=>{FTCaddDisc.rate=v*10}\"/><n-p>{{ FTCaddDisc.rate }}</n-p>\r\n\r\n      </NFormItem>\r\n      <div style=\"display: flex; justify-content: flex-end\">\r\n          <n-button\r\n            round\r\n            type=\"primary\"\r\n            @click=\"SubmitToFTC\"\r\n          >\r\n            收录并前往下一个\r\n          </n-button>\r\n          <n-button\r\n            round\r\n            @click=\"initNext\"\r\n          >\r\n            下一个\r\n          </n-button>\r\n        </div>\r\n        <n-card hoverable>\r\n    <question-block :qcontent=\"TLd[currentTIndex]\"/>\r\n    </n-card>\r\n        <n-button @click=\"confirmII\">CONFIRM</n-button>\r\n    </n-card>\r\n    </template>\r\n    <script setup>\r\n    import { NCard,NCascader,NP,NButton,NFormItem,NRate,NInput } from 'naive-ui';\r\n    import subjectsmap from \"../../basicinfo/subjects.json\"\r\n    import { ZujuanAPI } from '../../utils/zujuan-api';\r\n    import {ref} from \"vue\"\r\n    import { API } from \"../../../../shared/APIHelper\";\r\n    import { router_push } from '../../utils/router-goto';\r\n    import questionBlock from \"../../questionBlock/zjw.vue\"\r\n    import { useRouter,useRoute } from \"vue-router\";\r\n    import { polishingupTlist } from '../preparing-room/polishinguptlist';\r\n    import swal from 'sweetalert';\r\n    import blankPic from \"../../utils/blankpic\"\r\n    const router=useRouter(),route=useRoute()\r\n    const bankid=ref(15)\r\n    const step=ref(1)\r\n    const TLd=ref([])\r\n    const currentTIndex=ref(0)\r\n    \r\n    if(route.query.bankid){\r\n        bankid.value=parseInt(route.query.bankid)\r\n    }\r\n    \r\n    const confirmI=async()=>{\r\n        ZujuanAPI(\"/app-server/v1/basket/\"+bankid.value).then(async(v)=>{\r\n            let TL=[]\r\n            v.data.structure.forEach(r=>{\r\n                TL.push(...r.list)\r\n            })\r\n    \r\n            TL=await polishingupTlist(bankid.value,TL)\r\n            step.value=2\r\n            TLd.value=TL\r\n            currentTIndex.value=-1\r\n            initNext()\r\n            \r\n    //         await API.post(\"/zujuan-ink-be-core/donerec/add\",{\r\n    // quid         :     TL[i].quid,\r\n    // date         :   (new Date()).toDateString()  ,\r\n    // timestamp    :    (new Date()).getTime() ,\r\n    // image        :   `data:image/svg+xml;charset=utf-8,<svg xmlns=\"http://www.w3.org/2000/svg\"><foreignObject width=\"300\" height=\"50\"><body xmlns=\"http://www.w3.org/1999/xhtml\"><p>以手动添加错题的方式被收录</p></body></foreignObject></svg>` ,\r\n    // parent       :  \"unsaved\"  ,\r\n    //     })\r\n    \r\n        })\r\n    }\r\n    \r\n    const confirmII=async()=>{\r\n        for (let i = 0; i < TLd.value.length; i++) {\r\n            await API.post(\"/zujuan-ink-be-core/donerec/add\",{\r\n    quid         :     TLd.value[i].quid,\r\n    date         :   (new Date()).toDateString()  ,\r\n    timestamp    :    (new Date()).getTime() ,\r\n    image        :    blankPic,\r\n    parent       :  \"unsaved\"  ,\r\n        })\r\n        }\r\n        swal({\r\n            icon:\"success\",\r\n            title:\"OK\"\r\n        })\r\n                \r\n    }\r\n\r\n  const  FTCaddDisc=ref({\r\n  quid:\"\",\r\n    insights :\"\",\r\n    note :\"\",\r\n    rate :0,\r\n    timestamp :0,\r\n    times:0,\r\n    lastfinishdate :0,\r\n    mastarate :0,\r\n    bankid:0\r\n})\r\n\r\nconst SubmitToFTC=(index)=>{\r\n    API.post(\"/zujuan-ink-be-core/ftc/push_to_collection\",FTCaddDisc.value).then(o=>{\r\n        initNext()\r\n  })\r\n\r\n}\r\n\r\nconst initNext=()=>{\r\n\r\ncurrentTIndex.value++\r\n\r\n    FTCaddDisc.value={\r\n  quid:TLd.value[currentTIndex.value].quid,\r\n    insights :\"\",\r\n    note :\"\",\r\n    rate :0,\r\n    timestamp :(new Date()).getTime(),\r\n    times:1,\r\n    lastfinishdate :(new Date()).getTime(),\r\n    mastarate :0,\r\n    bankid:bankid.value\r\n}\r\n}\r\n    \r\n    </script>\r\n    \r\n    <style scoped>\r\n    .centered{\r\n        width: 90%;\r\n        margin: auto auto;\r\n    }\r\n    </style>"],"names":["useRouter","route","useRoute","bankid","ref","step","TLd","currentTIndex","confirmI","ZujuanAPI","v","TL","r","polishingupTlist","initNext","confirmII","i","API","blankPic","swal","FTCaddDisc","SubmitToFTC","index","o"],"mappings":"qzEA2DAA,EAAA,EAAA,MAAAC,EAAAC,EAAA,EAYAC,EAAAC,EAAA,EAAA,EACAC,EAAAD,EAAA,CAAA,EACAE,EAAAF,EAAA,EAAA,EACAG,EAAAH,EAAA,CAAA,EAEAH,EAAA,MAAA,SACAE,EAAA,MAAA,SAAAF,EAAA,MAAA,MAAA,GAGA,MAAAO,EAAA,SAAA,CACAC,EAAA,yBAAAN,EAAA,KAAA,EAAA,KAAA,MAAAO,GAAA,CACA,IAAAC,EAAA,CAAA,EACAD,EAAA,KAAA,UAAA,QAAAE,GAAA,CACAD,EAAA,KAAA,GAAAC,EAAA,IAAA,CACA,CAAA,EAEAD,EAAA,MAAAE,EAAAV,EAAA,MAAAQ,CAAA,EACAN,EAAA,MAAA,EACAC,EAAA,MAAAK,EACAJ,EAAA,MAAA,GACAO,EAAA,CAUA,CAAA,CACA,EAEAC,EAAA,SAAA,CACA,QAAAC,EAAA,EAAAA,EAAAV,EAAA,MAAA,OAAAU,IACA,MAAAC,EAAA,KAAA,kCAAA,CACA,KAAAX,EAAA,MAAAU,CAAA,EAAA,KACA,KAAA,IAAA,KAAA,EAAA,aAAA,EACA,UAAA,IAAA,KAAA,EAAA,QAAA,EACA,MAAAE,EACA,OAAA,SACA,CAAA,EAEAC,EAAA,CACA,KAAA,UACA,MAAA,IACA,CAAA,CAEA,EAEAC,EAAAhB,EAAA,CACA,KAAA,GACA,SAAA,GACA,KAAA,GACA,KAAA,EACA,UAAA,EACA,MAAA,EACA,eAAA,EACA,UAAA,EACA,OAAA,CACA,CAAA,EAEAiB,EAAAC,GAAA,CACAL,EAAA,KAAA,6CAAAG,EAAA,KAAA,EAAA,KAAAG,GAAA,CACAT,EAAA,CACA,CAAA,CAEA,EAEAA,EAAA,IAAA,CAEAP,EAAA,QAEAa,EAAA,MAAA,CACA,KAAAd,EAAA,MAAAC,EAAA,KAAA,EAAA,KACA,SAAA,GACA,KAAA,GACA,KAAA,EACA,UAAA,IAAA,KAAA,EAAA,QAAA,EACA,MAAA,EACA,eAAA,IAAA,KAAA,EAAA,QAAA,EACA,UAAA,EACA,OAAAJ,EAAA,KACA,CACA"}