import{useRoute as N,useRouter as P}from"./vue-router-ee92e3b2.js";import{q as S}from"./define_basic_qtypes-5cc5565b.js";import{A as p}from"./APIHelper-c6c5541a.js";import"./sweetalert.min-b990379b.js";import{_ as j}from"./_plugin-vue_export-helper-c27b6911.js";import{aZ as o,a8 as h,l as y,t as n,aE as u,b7 as r,m as c,bc as I,bd as d,F as A,ae as F,k as b,X as T,s,ab as X,a9 as Z}from"./index-c2ed52a5.js";import{N as m}from"./Button-591cb8c7.js";import{N as $}from"./InputNumber-bd44b0b3.js";import"./light-3c431b54.js";import"./format-length-c9d165c6.js";import"./Icon-9d083982.js";import"./Warning-fc401418.js";import"./Close-4e65a8ab.js";import"./Scrollbar-5b7370f2.js";import"./runtime-dom.esm-bundler-51aad541.js";import"./keysOf-5d5107c5.js";import"./_commonjsHelpers-de833af9.js";import"./Loading-b36f50c8.js";import"./use-is-mounted-912be460.js";import"./use-memo-13475312.js";import"./FadeInExpandTransition-3bfdffc9.js";import"./use-locale-ca0d0990.js";import"./index-975a2d8f.js";import"./use-merged-state-5c1c3246.js";import"./Input-b50999c9.js";import"./light-951b0264.js";import"./Suffix-26bafbe6.js";import"./Add-068f2940.js";const H=w=>(X("data-v-d343045d"),w=w(),Z(),w),B={key:0,style:{width:"18.76cm","line-height":"normal"},id:"oonom"},J=H(()=>c("div",{class:"noprint"},null,-1)),K={id:"corehtml",style:{width:"18.76cm",columns:2,"line-height":"normal"}},L={style:{"font-size":"9.5pt","font-family":"Cambria, fangsong",margin:"0px"}},M={key:0},Q={style:{"font-size":"9.5pt",margin:"0px","font-family":"Cambria, \u4EFF\u5B8B"}},V={style:{"font-family":"'courier new'"}},W={style:{"font-family":"'courier new'"}},Y={style:{overflow:"hidden",display:"inline-block"}},ee=["src"],le={key:1,style:{margin:"0 0"}},ae={key:2,style:{display:"inline",margin:"5.5pt"}},ie=H(()=>c("div",null,null,-1)),te=3,oe=8,se={__name:"export.a",setup(w){const z=N();P();const C=o(0),R=o(!1);o({q:!0,a:!1,p:!1}),o(!1);const x=o(""),g=o({});p.get("/api/group/get/"+z.params.id).then(a=>{a.entry.split(",").forEach(l=>{g.value[l]=S}),a.entry.split(","),x.value=a.title,Promise.all(a.entry.split(",").map(l=>new Promise((e,i)=>{p.get("/api/data/get/"+l).then(t=>{g.value[l]=t,p.get("/api/xkw-helper/getCachedImg/"+t.bankid+"/"+t.qid+"/400").then(E=>{f.value[t.id]={a:p.host+"/api/xkw-helper/route-pic?purl="+btoa(E.answer.replace("@2","@3").replace("c2","c1")),p:p.host+"/api/xkw-helper/route-pic?purl="+btoa(E.parse.replace("@2","@3").replace("c2","c1"))},console.log(f,t),e()})})}))).then(()=>{R.value=!0})}),o({});const _=a=>Object.entries(a).map(l=>l[1]);o(!1);const f=o({}),k=o({}),v=o({}),O=(a,l)=>{p.post("/ocr-service",{url:f.value[a.id].a,psm:l,lang:"eng+chi_sim"}).then(e=>{k.value[a.id]=e.result})},q=a=>{for(let l=0;l<_(g.value).length;l++){let e=_(g.value)[l];console.log(e),p.post("/ocr-service",{url:f.value[e.id].a,psm:a,lang:"eng+chi_sim"}).then(i=>{k.value[e.id]=i.result})}},D=()=>{const a=[2901,290101,2908,2701,2704,3011,3012,3101,310101,310104,3103,261104],l=[2801,280101,280102,280103,2803,2804,280401,280402,280403,280404,2805,2820,2808,2809,280901,280902,280903,280904,2812,281201,281203,2813,281301,281302];for(let e=0;e<_(g.value).length;e++){let i=_(g.value)[e];console.log(i.type),l.includes(i.type)?p.post("/ocr-service",{url:f.value[i.id].a,psm:te,lang:"eng+chi_sim"}).then(t=>{k.value[i.id]=t.result,v.value[i.id]=!0}):a.includes(i.type)&&p.post("/ocr-service",{url:f.value[i.id].a,psm:oe,lang:"eng+chi_sim"}).then(t=>{k.value[i.id]=t.result,v.value[i.id]=!0})}},U=o(0),G=async()=>{document.querySelectorAll("#oonom .noprint").forEach(a=>{a.style.display="none"}),await T(),U.value=document.querySelector("#oonom").clientHeight};return(a,l)=>(h(),y(A,null,[n(r(m),{onClick:l[0]||(l[0]=e=>C.value+=20),class:"noprint"},{default:u(()=>[s("Height+")]),_:1}),n(r(m),{onClick:l[1]||(l[1]=e=>C.value-=10),class:"noprint"},{default:u(()=>[s("Height-")]),_:1}),n(r($),{class:"noprint",value:C.value,"onUpdate:value":l[2]||(l[2]=e=>C.value=e),style:{width:"90px"}},null,8,["value"]),n(r(m),{onClick:l[3]||(l[3]=e=>q(8)),class:"noprint"},{default:u(()=>[s("OCR all chars")]),_:1}),n(r(m),{onClick:l[4]||(l[4]=e=>q(3)),class:"noprint"},{default:u(()=>[s("OCR all blocks")]),_:1}),n(r(m),{onClick:l[5]||(l[5]=e=>D()),class:"noprint"},{default:u(()=>[s("OCR all selective")]),_:1}),n(r(m),{onClick:G,class:"noprint"},{default:u(()=>[s("\u663E\u793A\u9876\u7AEF\u9AD8\u5EA6: "+d(U.value)+" px",1)]),_:1}),R.value?(h(),y("div",B,[J,c("div",{style:I({display:"block",height:C.value+"px"})},null,4),c("div",K,[c("p",L," Generated by thost | Group UUID: "+d(a.$route.params.id)+" | Title: "+d(x.value),1),(h(!0),y(A,null,F(_(g.value),(e,i)=>(h(),y("div",{key:e.id,style:I({display:v.value[e.id]?"inline-block":"block"})},[v.value[e.id]?b("",!0):(h(),y("div",M,[c("p",Q,[s(" UUID:"),c("span",V,d(e.id),1),s(" | qid:"),c("span",W,d(e.qid),1)])])),c("div",Y,[v.value[e.id]?b("",!0):(h(),y("img",{key:0,src:(f.value[e.id]||{a:""}).a},null,8,ee)),n(r(m),{onClick:t=>O(e,8),class:"noprint"},{default:u(()=>[s("OCR chars")]),_:2},1032,["onClick"]),n(r(m),{onClick:t=>O(e,3),class:"noprint"},{default:u(()=>[s("OCR block")]),_:2},1032,["onClick"]),k.value[e.id]&&!v.value[e.id]?(h(),y("p",le,d(k.value[e.id]),1)):b("",!0),n(r(m),{onClick:t=>v.value[e.id]=!0,class:"noprint"},{default:u(()=>[s("Accept OCR Result")]),_:2},1032,["onClick"]),v.value[e.id]?(h(),y("p",ae,d(i+1)+". ("+d(e.qid)+") "+d(k.value[e.id]),1)):b("",!0),ie])],4))),128))])])):b("",!0)],64))}},ne=j(se,[["__scopeId","data-v-d343045d"]]);export{ne as default};
