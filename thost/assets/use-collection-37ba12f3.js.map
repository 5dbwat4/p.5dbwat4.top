{"version":3,"file":"use-collection-37ba12f3.js","sources":["../../node_modules/.pnpm/naive-ui@2.38.1_vue@3.4.25/node_modules/naive-ui/es/_utils/composable/use-collection.mjs"],"sourcesContent":["import { watch, onMounted, inject, getCurrentInstance, onBeforeUnmount } from 'vue';\n// injection.collection {\n//   key1: [insta, instb]\n//   key2: [instc]\n// }\nexport function useInjectionInstanceCollection(injectionName, collectionKey, registerKeyRef) {\n  var _a;\n  const injection = inject(injectionName, null);\n  if (injection === null) return;\n  const vm = (_a = getCurrentInstance()) === null || _a === void 0 ? void 0 : _a.proxy;\n  watch(registerKeyRef, registerInstance);\n  registerInstance(registerKeyRef.value);\n  onBeforeUnmount(() => {\n    registerInstance(undefined, registerKeyRef.value);\n  });\n  function registerInstance(key, oldKey) {\n    if (!injection) return;\n    const collection = injection[collectionKey];\n    if (oldKey !== undefined) removeInstance(collection, oldKey);\n    if (key !== undefined) addInstance(collection, key);\n  }\n  function removeInstance(collection, key) {\n    if (!collection[key]) collection[key] = [];\n    collection[key].splice(collection[key].findIndex(instance => instance === vm), 1);\n  }\n  function addInstance(collection, key) {\n    if (!collection[key]) collection[key] = [];\n    if (!~collection[key].findIndex(instance => instance === vm)) {\n      collection[key].push(vm);\n    }\n  }\n}\n// injection.collection {\n//   key1: [insta.value, instb.value]\n//   key2: [instc.value]\n// }\nexport function useInjectionCollection(injectionName, collectionKey, valueRef) {\n  const injection = inject(injectionName, null);\n  if (injection === null) return;\n  if (!(collectionKey in injection)) {\n    injection[collectionKey] = [];\n  }\n  injection[collectionKey].push(valueRef.value);\n  watch(valueRef, (value, prevValue) => {\n    const collectionArray = injection[collectionKey];\n    const index = collectionArray.findIndex(collectionValue => collectionValue === prevValue);\n    if (~index) collectionArray.splice(index, 1);\n    collectionArray.push(value);\n  });\n  onBeforeUnmount(() => {\n    const collectionArray = injection[collectionKey];\n    const index = collectionArray.findIndex(collectionValue => collectionValue === valueRef.value);\n    if (~index) collectionArray.splice(index, 1);\n  });\n}\n// injection.collection {\n//   key1: [insta.$el, instb.$el]\n//   key2: [instc.$el]\n// }\nexport function useInjectionElementCollection(injectionName, collectionKey, getElement) {\n  const injection = inject(injectionName, null);\n  if (injection === null) return;\n  if (!(collectionKey in injection)) {\n    injection[collectionKey] = [];\n  }\n  onMounted(() => {\n    const el = getElement();\n    if (!el) return;\n    injection[collectionKey].push(el);\n  });\n  onBeforeUnmount(() => {\n    const collectionArray = injection[collectionKey];\n    const element = getElement();\n    const index = collectionArray.findIndex(collectionElement => collectionElement === element);\n    if (~index) collectionArray.splice(index, 1);\n  });\n}"],"names":["useInjectionInstanceCollection","injectionName","collectionKey","registerKeyRef","_a","injection","inject","vm","getCurrentInstance","watch","registerInstance","onBeforeUnmount","key","oldKey","collection","removeInstance","addInstance","instance","useInjectionCollection","valueRef","value","prevValue","collectionArray","index","collectionValue","useInjectionElementCollection","getElement","onMounted","el","element","collectionElement"],"mappings":"uEAKO,SAASA,EAA+BC,EAAeC,EAAeC,EAAgB,CAC3F,IAAIC,EACJ,MAAMC,EAAYC,EAAOL,EAAe,IAAI,EAC5C,GAAII,IAAc,KAAM,OACxB,MAAME,GAAMH,EAAKI,EAAoB,KAAM,MAAQJ,IAAO,OAAS,OAASA,EAAG,MAC/EK,EAAMN,EAAgBO,CAAgB,EACtCA,EAAiBP,EAAe,KAAK,EACrCQ,EAAgB,IAAM,CACpBD,EAAiB,OAAWP,EAAe,KAAK,CACpD,CAAG,EACD,SAASO,EAAiBE,EAAKC,EAAQ,CACrC,GAAI,CAACR,EAAW,OAChB,MAAMS,EAAaT,EAAUH,CAAa,EACtCW,IAAW,QAAWE,EAAeD,EAAYD,CAAM,EACvDD,IAAQ,QAAWI,EAAYF,EAAYF,CAAG,CACnD,CACD,SAASG,EAAeD,EAAYF,EAAK,CAClCE,EAAWF,CAAG,IAAGE,EAAWF,CAAG,EAAI,IACxCE,EAAWF,CAAG,EAAE,OAAOE,EAAWF,CAAG,EAAE,UAAUK,GAAYA,IAAaV,CAAE,EAAG,CAAC,CACjF,CACD,SAASS,EAAYF,EAAYF,EAAK,CAC/BE,EAAWF,CAAG,IAAGE,EAAWF,CAAG,EAAI,IACnC,CAACE,EAAWF,CAAG,EAAE,UAAUK,GAAYA,IAAaV,CAAE,GACzDO,EAAWF,CAAG,EAAE,KAAKL,CAAE,CAE1B,CACH,CAKO,SAASW,EAAuBjB,EAAeC,EAAeiB,EAAU,CAC7E,MAAMd,EAAYC,EAAOL,EAAe,IAAI,EACxCI,IAAc,OACZH,KAAiBG,IACrBA,EAAUH,CAAa,EAAI,IAE7BG,EAAUH,CAAa,EAAE,KAAKiB,EAAS,KAAK,EAC5CV,EAAMU,EAAU,CAACC,EAAOC,IAAc,CACpC,MAAMC,EAAkBjB,EAAUH,CAAa,EACzCqB,EAAQD,EAAgB,UAAUE,GAAmBA,IAAoBH,CAAS,EACpF,CAACE,GAAOD,EAAgB,OAAOC,EAAO,CAAC,EAC3CD,EAAgB,KAAKF,CAAK,CAC9B,CAAG,EACDT,EAAgB,IAAM,CACpB,MAAMW,EAAkBjB,EAAUH,CAAa,EACzCqB,EAAQD,EAAgB,UAAUE,GAAmBA,IAAoBL,EAAS,KAAK,EACzF,CAACI,GAAOD,EAAgB,OAAOC,EAAO,CAAC,CAC/C,CAAG,EACH,CAKO,SAASE,EAA8BxB,EAAeC,EAAewB,EAAY,CACtF,MAAMrB,EAAYC,EAAOL,EAAe,IAAI,EACxCI,IAAc,OACZH,KAAiBG,IACrBA,EAAUH,CAAa,EAAI,IAE7ByB,EAAU,IAAM,CACd,MAAMC,EAAKF,IACNE,GACLvB,EAAUH,CAAa,EAAE,KAAK0B,CAAE,CACpC,CAAG,EACDjB,EAAgB,IAAM,CACpB,MAAMW,EAAkBjB,EAAUH,CAAa,EACzC2B,EAAUH,IACVH,EAAQD,EAAgB,UAAUQ,GAAqBA,IAAsBD,CAAO,EACtF,CAACN,GAAOD,EAAgB,OAAOC,EAAO,CAAC,CAC/C,CAAG,EACH","x_google_ignoreList":[0]}