import{useRoute as G,useRouter as P}from"./vue-router-3740985a.js";import{q as U}from"./define_basic_qtypes-ddf25d69.js";import{A as o}from"./APIHelper-4c0d0968.js";import"./sweetalert.min-37390c4f.js";import{_ as E}from"./_plugin-vue_export-helper-c27b6911.js";import{aZ as a,a8 as m,l as _,t as r,aE as n,s as l,b7 as p,m as c,bd as y,F as I,ae as V,k as R,ab as j,a9 as F}from"./runtime-core.esm-bundler-c066f4bf.js";import{N as T}from"./Checkbox-b5c247e6.js";import{a as v}from"./Button-418af94d.js";import{N as z}from"./ImageGroup-d2b836f6.js";import"./light-96080c0b.js";import"./format-length-c9d165c6.js";import"./Icon-e6ca0735.js";import"./Warning-ff31488d.js";import"./Close-d6ea1a86.js";import"./Scrollbar-25ba1ebe.js";import"./runtime-dom.esm-bundler-caa8590e.js";import"./_commonjsHelpers-042e6b4d.js";import"./use-merged-state-89f8109f.js";import"./FadeInExpandTransition-ff940b4d.js";import"./use-memo-b9add725.js";import"./fade-in-scale-up.cssr-18f1ebda.js";import"./flatten-a133123b.js";import"./use-false-until-truthy-a506b738.js";import"./Tooltip-bd1c8576.js";import"./Popover-c2999df7.js";import"./_baseIsEqual-9220f819.js";import"./get-9e715692.js";import"./cssr-ce5b581a.js";import"./utils-d7fa52af.js";import"./use-compitable-42538ef7.js";import"./next-frame-once-7035a838.js";import"./use-locale-55e0af58.js";import"./index-975a2d8f.js";const q=C=>(j("data-v-52235d54"),C=C(),F(),C),K={style:{width:"18.76cm","line-height":"normal"},id:"oonom"},L=q(()=>c("div",{class:"noprint"},null,-1)),M={id:"corehtml",style:{width:"18.76cm",columns:2,"line-height":"normal"}},W={style:{"font-size":"9.5pt","font-family":"Cambria, fangsong",margin:"0px"}},H={style:{"font-size":"9.5pt",margin:"0px","font-family":"Cambria, 仿宋"}},X={style:{"font-family":"'courier new'"}},Z={style:{"font-family":"'courier new'"}},J={key:0,style:{overflow:"hidden"}},Q=["src"],Y={key:1,style:{margin:"0 0"}},ee=q(()=>c("div",null,null,-1)),te=3,ie=8,oe={__name:"export.a",setup(C){const A=G();P(),a({q:!0,a:!1,p:!1}),a(!1);const x=a(""),s=a({});o.post("/api/group/get",{id:A.params.id}).then(i=>{i.entry.split(",").forEach(e=>{s.value[e]=U}),i.entry.split(","),x.value=i.title,Promise.all(i.entry.split(",").map(e=>new Promise((t,g)=>{o.get("/api/qapi/get/"+e).then(B=>{s.value[e]=B}),S(e)}))).then(()=>{})});const b={},N=a({}),h=i=>Object.entries(i).map(e=>e[1]),S=async i=>{N.value[i]=await o.get("/api/qapi/doneinfo/getbyquuid/"+i)},f=a(!1),u=a({}),$=i=>{console.log(i),f.value=i,f.value&&Object.entries(s.value).forEach(e=>{console.log(e),o.get("/api/xkw-helper/get_more_detail/400/"+e[1].bankid+"/"+e[1].qid).then(t=>{b[e[0]]=t.data.type,u.value[e[1].id]={a:o.host+"/api/xkw-helper/route-pic?purl="+btoa(t.data.answerImg.replace("@2","@3").replace("c2","c1")),p:o.host+"/api/xkw-helper/route-pic?purl="+btoa(t.data.parseImg.replace("@2","@3").replace("c2","c1"))}})})},d=a({}),k=a({}),w=(i,e)=>{o.post("/ocr-service",{url:u.value[i.id].a,psm:e,lang:"eng+chi_sim"}).then(t=>{d.value[i.id]=t.result})},O=i=>{for(let e=0;e<h(s.value).length;e++){let t=h(s.value)[e];console.log(t),o.post("/ocr-service",{url:u.value[t.id].a,psm:i,lang:"eng+chi_sim"}).then(g=>{d.value[t.id]=g.result})}},D=()=>{for(let i=0;i<h(s.value).length;i++){let e=h(s.value)[i];(""+b[e.id].id).startsWith("28")?o.post("/ocr-service",{url:u.value[e.id].a,psm:te,lang:"eng+chi_sim"}).then(t=>{d.value[e.id]=t.result,k.value[e.id]=!0}):b[e.id].choice&&o.post("/ocr-service",{url:u.value[e.id].a,psm:ie,lang:"eng+chi_sim"}).then(t=>{d.value[e.id]=t.result,k.value[e.id]=!0})}};return(i,e)=>(m(),_(I,null,[r(p(T),{class:"noprint",checked:f.value,"onUpdate:checked":[e[0]||(e[0]=t=>f.value=t),$]},{default:n(()=>[l(" 直接从组卷网获取答案解析数据而非从oss缓存 ")]),_:1},8,["checked"]),r(p(v),{onClick:e[1]||(e[1]=t=>O(8)),class:"noprint"},{default:n(()=>[l("OCR all chars")]),_:1}),r(p(v),{onClick:e[2]||(e[2]=t=>O(3)),class:"noprint"},{default:n(()=>[l("OCR all blocks")]),_:1}),r(p(v),{onClick:e[3]||(e[3]=t=>D()),class:"noprint"},{default:n(()=>[l("OCR all selective")]),_:1}),c("div",K,[L,r(p(z),null,{default:n(()=>[c("div",M,[c("p",W," Generated by thost | Group UUID: "+y(i.$route.params.id)+" | Title: "+y(x.value),1),(m(!0),_(I,null,V(h(s.value),t=>(m(),_("div",{key:t.id},[c("p",H,[l(" UUID:"),c("span",X,y(t.id),1),l(" | qid:"),c("span",Z,y(t.qid),1)]),f.value?(m(),_("div",J,[k.value[t.id]?R("",!0):(m(),_("img",{key:0,src:(u.value[t.id]||{a:""}).a},null,8,Q)),r(p(v),{onClick:g=>w(t,8),class:"noprint"},{default:n(()=>[l("OCR chars")]),_:2},1032,["onClick"]),r(p(v),{onClick:g=>w(t,3),class:"noprint"},{default:n(()=>[l("OCR block")]),_:2},1032,["onClick"]),d.value[t.id]?(m(),_("p",Y,y(d.value[t.id]),1)):R("",!0),r(p(v),{onClick:g=>k.value[t.id]=!0,class:"noprint"},{default:n(()=>[l("Accept OCR Result")]),_:2},1032,["onClick"]),ee])):R("",!0)]))),128))])]),_:1})])],64))}},Ue=E(oe,[["__scopeId","data-v-52235d54"]]);export{Ue as default};
